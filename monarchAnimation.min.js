var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};
$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var f=a[d];f in c||(c[f]={});c=c[f]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};$jscomp.polyfill("Object.is",function(a){return a?a:function(a,c){return a===c?0!==a||1/a===1/c:a!==a&&c!==c}},"es6","es3");
$jscomp.polyfill("Array.prototype.includes",function(a){return a?a:function(a,c){var b=this;b instanceof String&&(b=String(b));var f=b.length;c=c||0;for(0>c&&(c=Math.max(c+f,0));c<f;c++){var k=b[c];if(k===a||Object.is(k,a))return!0}return!1}},"es7","es3");
$jscomp.checkStringArgs=function(a,b,c){if(null==a)throw new TypeError("The 'this' value for String.prototype."+c+" must not be null or undefined");if(b instanceof RegExp)throw new TypeError("First argument to String.prototype."+c+" must not be a regular expression");return a+""};$jscomp.polyfill("String.prototype.includes",function(a){return a?a:function(a,c){return-1!==$jscomp.checkStringArgs(this,a,"includes").indexOf(a,c||0)}},"es6","es3");
$jscomp.findInternal=function(a,b,c){a instanceof String&&(a=String(a));for(var d=a.length,f=0;f<d;f++){var k=a[f];if(b.call(c,k,f,a))return{i:f,v:k}}return{i:-1,v:void 0}};$jscomp.polyfill("Array.prototype.findIndex",function(a){return a?a:function(a,c){return $jscomp.findInternal(this,a,c).i}},"es6","es3");function moveCamera(a,b){switch(a){case "x":xPosition=b;break;case "y":yPosition=b;break;case "z":zPosition=b}}
function changeCameraCenter(a,b){switch(a){case "x":xCCenter=b;settings.camera.centerPos[0]=b;break;case "y":yCCenter=b;settings.camera.centerPos[1]=b;break;case "z":zCCenter=b,settings.camera.centerPos[2]=b}}function changeCameraFocus(a,b){switch(a){case "x":xCLook=b;settings.camera.focusPos[0]=b;break;case "y":yCLook=b;settings.camera.focusPos[1]=b;break;case "z":zCLook=b,settings.camera.focusPos[2]=b}}
function changeCameraCircleRotation(){circleCameraRotation=document.getElementById("advCamera_circleToggle").checked}function changeCameraLock(){lockCamera=document.getElementById("advCamera_lockToggle").checked}function changeSensitivity(a){settings.camera.mouseSensitivity=a}function changeZoomSensitivity(a){0>a&&(a*=-1);settings.camera.zoomAmount=1+a/2}$(document).on("change",function(a){isNaN(yPosition)&&(yPosition=0);isNaN(xPosition)&&(xPosition=0);isNaN(zPosition)&&(zPosition=0)});
var mouseOnTimeline=!1;$(document).on("mousedown",function(a){mobile||(1==inAnimationWindow?(xStart=a.pageX,yStart=a.pageY,mouseDown=!0):a.pageY>=window.innerHeight-100&&a.pageY<=window.innerHeight-25&&(mouseOnTimeline=!0,timelineScrub(a.pageX)))});$(document).on("mouseup",function(a){300<=a.pageX&&50<=a.pageY&&a.pageY<window.innerHeight-70&&(mouseDown=!1);mouseOnTimeline=!1});
$(document).on("touchstart",function(a){inAnimationWindow=50<=a.touches[0].pageY&&a.touches[0].pageY<window.innerHeight-150?1:0;1==inAnimationWindow?(xStart=a.touches[0].pageX,yStart=a.touches[0].pageY):a.touches[0].pageY>=window.innerHeight-100&&a.touches[0].pageY<=window.innerHeight-25&&(mouseOnTimeline=!0,timelineScrub(a.touches[0].pageX))});$(document).on("touchend",function(a){50<=a.pageY&&a.pageY<window.innerHeight-70&&(mouseDown=!1);mouseOnTimeline=!1});
$(document).on("keydown",function(a){1!=inAnimationWindow||!getId("std_settings").classList.contains("settings_hide")||animationRunning&&lockCamera||("-"==a.key?zoomCameraM(settings.camera.zoomAmount):"="==a.key&&zoomCameraM(1/settings.camera.zoomAmount))});
$(document).on("wheel",function(a){mobile&&"init"!==activeMenu||1!=inAnimationWindow||!getId("std_settings").classList.contains("settings_hide")||animationRunning&&lockCamera||(0<a.originalEvent.deltaY?zoomCameraM(settings.camera.zoomAmount/1.16667):0>a.originalEvent.deltaY&&zoomCameraM(1/(settings.camera.zoomAmount/1.16667)))});$(document).on("mouseup",function(a){mouseOnTimeline=mouseDown=!1});var timelinePosition=0;
$(document).ready(function(){$(document).on("mousemove",function(a){inAnimationWindow=300<=a.pageX&&50<=a.pageY&&a.pageY<window.innerHeight-150?1:0;!mouseDown||1!=inAnimationWindow||!getId("std_settings").classList.contains("settings_hide")||animationRunning&&lockCamera||(rotateCamera(settings.camera.mouseSensitivity*(a.pageX-xStart)/100,settings.camera.mouseSensitivity*(a.pageY-yStart)/100),300<=a.pageX&&50<=a.pageY&&a.pageY<window.innerHeight-70&&(xStart=a.pageX,yStart=a.pageY));mouseOnTimeline&&
timelineScrub(a.pageX)})});
$(document).ready(function(){$(document).on("touchmove",function(a){inAnimationWindow=50<=a.touches[0].pageY&&a.touches[0].pageY<window.innerHeight-150?1:0;"init"!==activeMenu||1!=inAnimationWindow||!getId("std_settings").classList.contains("settings_hide")||animationRunning&&lockCamera||(rotateCamera(settings.camera.mouseSensitivity*(a.touches[0].pageX-xStart)/100,settings.camera.mouseSensitivity*(a.touches[0].pageY-yStart)/100),50<=a.touches[0].pageY&&a.touches[0].pageY<window.innerHeight-150&&
(xStart=a.touches[0].pageX,yStart=a.touches[0].pageY));mouseOnTimeline&&timelineScrub(a.touches[0].pageX)})});
function zoomCameraM(a){zoom=Math.pow(Math.pow(xPosition,2)+Math.pow(yPosition,2)+Math.pow(zPosition,2),.5);if(zoom*a>1*Math.pow(10,100)||zoom*a<1*Math.pow(10,-100))zPosition=yPosition=xPosition=10,showPopUp("popUp_error_body","You dun messed up","You have zoomed to infinity and entered easter egg mode, where css styling degrades into madness and everything is pain. Remember to save your changes before refreshing the page to end this madness.",-1),stylesheetLoader("memeMode");else{zoom*=a;zoomZ=Math.cos(Math.asin(yPosition/
zoom));var b,c;0!==xPosition?b=Math.atan(zPosition/xPosition):0<zPosition?b=Math.PI:0>zPosition&&(b=-Math.PI);0>xPosition&&(0>b?b+=Math.PI:0<b&&(b-=Math.PI));0!==xPosition||0!==zPosition?c=Math.atan(yPosition/Math.pow(Math.pow(xPosition,2)+Math.pow(zPosition,2),.5)):0<yPosition?c=Math.PI:0>yPosition&&(c=-Math.PI);yPosition=zoom*Math.sin(c);xPosition=zoom*Math.cos(Math.asin(yPosition/zoom))*Math.cos(b);zPosition=zoom*Math.cos(Math.asin(yPosition/zoom))*Math.sin(b);getId("camera_x").value=xPosition;
getId("camera_y").value=yPosition;getId("camera_z").value=zPosition;isNaN(yPosition)&&(yPosition=0);isNaN(xPosition)&&(xPosition=0);isNaN(zPosition)&&(zPosition=0)}}
function rotateCamera(a,b){zoomZ=Math.pow(Math.pow(xPosition,2)+Math.pow(zPosition,2),.5);zoom=Math.pow(Math.pow(zoomZ,2)+Math.pow(yPosition,2),.5);var c,d;0!==xPosition?c=Math.atan(zPosition/xPosition):0<zPosition?c=Math.PI:0>=zPosition&&(c=-Math.PI);0>xPosition&&0>c?c+=Math.PI:0>xPosition&&0<c&&(c-=Math.PI);0!==xPosition||0!==zPosition?d=Math.atan(yPosition/zoomZ):0<yPosition?d=Math.PI:0>yPosition&&(d=-Math.PI);c+=a;yPosition=zoom*Math.sin(d+b);xPosition=zoom*Math.cos(Math.asin(yPosition/zoom))*
Math.cos(c);zPosition=zoom*Math.cos(Math.asin(yPosition/zoom))*Math.sin(c);getId("camera_x").value=xPosition;getId("camera_y").value=yPosition;getId("camera_z").value=zPosition;getId("advCamera_centerX").value=xCCenter;getId("advCamera_centerY").value=yCCenter;getId("advCamera_centerZ").value=zCCenter;getId("advCamera_focusX").value=xCLook;getId("advCamera_focusY").value=yCLook;getId("advCamera_focusZ").value=zCLook;isNaN(yPosition)&&(yPosition=0);isNaN(xPosition)&&(xPosition=0);isNaN(zPosition)&&
(zPosition=0)};var animate=function(){if(init){camera.position.x!==xPosition+xCCenter+scene.position.x&&(camera.position.x=xPosition+xCCenter+scene.position.x);camera.position.y!==yPosition+yCCenter+scene.position.y&&(camera.position.y=yPosition+yCCenter+scene.position.y);camera.position.z!==zPosition+zCCenter+scene.position.z&&(camera.position.z=zPosition+zCCenter+scene.position.z);camera.lookAt(scene.position.x+xCLook,scene.position.y+yCLook,scene.position.z+zCLook);for(var a=0;a<shapes.length;a++)shapes[a].scale.x!==
scales[a][0]&&(shapes[a].scale.x=scales[a][0]),shapes[a].scale.y!==scales[a][1]&&(shapes[a].scale.y=scales[a][1]),shapes[a].scale.z!==scales[a][2]&&(shapes[a].scale.z=scales[a][2]);renderer.render(scene,camera);recording&&capturer.capture(renderer.domElement)}requestAnimationFrame(animate)};animate();function newLight(a,b,c,d,f,k,m){var n={ambient:"Ambient",point:"Point",directional:"Directional",spot:"Spot",hemisphere:"Hemisphere"};"hemisphere"!==a&&"spot"!==a?(b=new THREE[n[a]+"Light"](b,c/100),b.name=n[a]+" light",lights[lights.length]=b,scene.add(b),selectedLight=lights.length-1,defaultTargets[selectedLight]=null,lights[selectedLight].position.x=d,lights[selectedLight].position.y=f,lights[selectedLight].position.z=k,getId("newLights_select").value="newLight"):"hemisphere"===a?(f=new THREE[n[a]+
"Light"](b,m,c/100),f.name=n[a]+" light",lights[lights.length]=f,scene.add(f),selectedLight=lights.length-1,defaultTargets[selectedLight]=null,lights[selectedLight].position.x=d,lights[selectedLight].position.y=-1,lights[selectedLight].position.z=k):"spot"===a&&(b=new THREE[n[a]+"Light"](b,c/100),b.name=n[a]+" light",lights[lights.length]=b,scene.add(b),scene.add(b.target),selectedLight=lights.length-1,defaultTargets[selectedLight]=lights[selectedLight].target,lights[selectedLight].position.x=d,lights[selectedLight].position.y=
f,lights[selectedLight].position.z=k,getId("newLights_select").value="newLight");setSelectedLight(selectedLight);for(a=0;a<keyFrames.length;a++)keyFrames[a].lights.push([0,0,0,0,0,0,0,0,0,0,!1])}function moveTarget(a,b){lights[selectedLight].target.position[a]=Number(b)}
function setTargetList(){var a=document.getElementById("target_select");a.innerHTML="<option value='defaultTarget'>Default Target</option>";for(var b={cube:1,cone:1,cylinder:1,dodecahedron:1,icosahedron:1,octahedron:1,pyramid:1,sphere:1,ring:1,text:1},c=0;c<shapes.length;c++){var d=shapes[c].uuid,f=shapes[c].geometry.name,k=b[f];b[f]++;a.innerHTML=shapes[c].uuid===lights[selectedLight].target.uuid?a.innerHTML+("<option value = "+d+" selected>"+shapes[c].geometry.name+" "+k+"</option>"):a.innerHTML+
("<option value = "+d+">"+shapes[c].geometry.name+" "+k+"</option>")}}function setTarget(a){var b;if("defaultTarget"===a)lights[selectedLight].target=defaultTargets[selectedLight],console.log(lights[selectedLight].target.position),getId("default_target_position").style.display="inherit";else{getId("default_target_position").style.display="none";for(var c=0;c<shapes.length;c++)shapes[c].uuid===a&&(b=shapes[c]);null!==b?lights[selectedLight].target=b:console.log("No shape with that id exists")}}
function toggleCastShadow(){showingLight?lights[selectedLight].castShadow=document.getElementById("light_castShadow").checked:shapes[selectedShape].castShadow=document.getElementById("shape_castShadow").checked}function toggleReceiveShadow(){shapes[selectedShape].receiveShadow=document.getElementById("shape_receiveShadow").checked}
function removeLight(){if(0<=selectedLight){scene.remove(lights[selectedLight]);lights.splice(selectedLight,1);selectedLight=-1;setSelectedLight(selectedLight);for(var a=0;a<keyFrames.length;a++)keyFrames[a].lights.splice(selectedLight,1);saveEngine.save(!0,!1)}}function moveLight(a,b){lights[selectedLight].position[a]=Number(b)}function changeLightColor(a){lights[selectedLight].color.set(a)}
function changeGroundLightColor(a){"HemisphereLight"===lights[selectedLight].type?lights[selectedLight].groundColor.set(a):changeLightColor(a)}function changeIntensity(){var a=document.getElementById("intensity_slider");document.getElementById("intensity_value").innerHTML=a.value;lights[selectedLight].intensity=a.value/100};function addCustom2(){var a=document.createElement("INPUT");a.setAttribute("type","file");document.getElementById("newShape_OBJUploader").appendChild(a)}function getRandomColor(){for(var a="#",b=0;6>b;b++)a+="0123456789ABCDEF"[Math.floor(16*Math.random())];return a}function readSingleFile(a){if(a=a.target.files[0]){var b=new FileReader;b.onload=function(a){strin=a.target.result.replace(/\r\n/g,"\n");strin=strin.split("\n");parseFile1(strin)};b.readAsText(a)}else alert("Failed to load file")}
function parseFile1(a){for(var b=[],c=[],d=!1,f=!1,k,m=1;m<a.length-1;m++)"o"==a[m-1][0]&&(k=a[m-1],f=!0),"v"==a[m][0]&&" "==a[m][1]&&(a[m]=" "==a[m][2]?a[m].slice(3):a[m].slice(2),b.push(a[m].split(" ").map(parseFloat))),"g"==a[m][0]&&(d=!0),"f"==a[m][0]&&(a[m]=" "==a[m][2]?a[m].slice(3):a[m].slice(2),c.push(a[m].split(/[\/\s]/).map(parseFloat))),1<c.length&&(!a[m+1]||"v"==a[m+1][0])&&(d&&(newCustom2(1,1,1,0,0,0,getRandomColor(),"#000000",b,c,m,k),c=[],d=!1),f&&(newCustom2(1,1,1,0,0,0,getRandomColor(),
"#000000",b,c,m,k),c=[],f=!1))}document.getElementById("newShape_OBJUploader").addEventListener("change",readSingleFile,!1);function newCustom2(a,b,c,d,f,k,m,n,l,e,h,p){var q=new THREE.Geometry;m=new THREE.MeshLambertMaterial({color:m});m.lights=!0;console.log(e);for(var g=0;g<l.length;g++)q.vertices.push(new THREE.Vector3(l[g][0],l[g][1],l[g][2])),3<l[g].length&&alert(g+" "+l[g]+" Is a vertex4");for(g=0;g<e.length;g++){for(var r=0;r<e[g].length;r++);isNaN(e[g][e[g].length-1])&&e[g].pop();3==e[g].length&&(0>e[g][0]?(e[g][0]=l.length+e[g][0],e[g][1]=l.length+e[g][1],e[g][2]=l.length+e[g][2]):0<e[g][0]&&(--e[g][0],--e[g][1],
--e[g][2]),q.faces.push(new THREE.Face3(e[g][1],e[g][2],e[g][0])));4==e[g].length&&(0>e[g][0]?(e[g][0]=l.length+e[g][0],e[g][1]=l.length+e[g][1],e[g][2]=l.length+e[g][2]):0<e[g][0]&&(--e[g][0],--e[g][1],--e[g][2],--e[g][3]),q.faces.push(new THREE.Face3(e[g][0],e[g][1],e[g][2])),q.faces.push(new THREE.Face3(e[g][0],e[g][2],e[g][3])));6==e[g].length&&(0>e[g][0]?(e[g][0]=l.length+e[g][0],e[g][2]=l.length+e[g][2],e[g][4]=l.length+e[g][4]):0<e[g][0]&&(--e[g][0],--e[g][2],--e[g][4]),q.faces.push(new THREE.Face3(e[g][0],
e[g][2],e[g][4])));8==e[g].length&&(0>e[g][0]?(e[g][0]=l.length+e[g][0],e[g][2]=l.length+e[g][2],e[g][4]=l.length+e[g][4],e[g][6]=l.length+e[g][6]):0<e[g][0]&&(--e[g][0],--e[g][2],--e[g][4],--e[g][6]),q.faces.push(new THREE.Face3(e[g][0],e[g][2],e[g][4])),q.faces.push(new THREE.Face3(e[g][0],e[g][4],e[g][6])));9==e[g].length&&(0>e[g][0]?(e[g][0]=l.length+e[g][0],e[g][3]=l.length+e[g][3],e[g][6]=l.length+e[g][6]):0<e[g][0]&&(--e[g][0],--e[g][3],--e[g][6]),q.faces.push(new THREE.Face3(e[g][0],e[g][3],
e[g][6])));12==e[g].length&&(0>e[g][0]?(e[g][0]=l.length+e[g][0],e[g][3]=l.length+e[g][3],e[g][6]=l.length+e[g][6],e[g][9]=l.length+e[g][9]):0<e[g][0]&&(--e[g][0],--e[g][3],--e[g][6],--e[g][9]),q.faces.push(new THREE.Face3(e[g][0],e[g][3],e[g][6])),q.faces.push(new THREE.Face3(e[g][0],e[g][6],e[g][9])));18==e[g].length&&(0>e[g][0]?(e[g][0]=l.length+e[g][0],e[g][3]=l.length+e[g][3],e[g][6]=l.length+e[g][6],e[g][9]=l.length+e[g][9],e[g][12]=l.length+e[g][12],e[g][15]=l.length+e[g][15]):0<e[g][0]&&(--e[g][0],
--e[g][3],--e[g][6],--e[g][9],--e[g][12],--e[g][15]),q.faces.push(new THREE.Face3(e[g][0],e[g][3],e[g][6])),q.faces.push(new THREE.Face3(e[g][0],e[g][6],e[g][9])),q.faces.push(new THREE.Face3(e[g][9],e[g][12],e[g][15])))}console.log(l.length+" Vertices");console.log(e.length+" Faces");console.log("Shape Ends at "+h);l=(new THREE.BufferGeometry).fromGeometry(q);shapes[shapes.length]=new THREE.Mesh(l,m);n=new THREE.LineSegments(l,new THREE.LineBasicMaterial({color:n}));q.name=null!=p?p:"Uploaded_Shape";
scene.add(shapes[shapes.length-1]);selectedShape=shapes.length-1;l.computeVertexNormals();n.scale.x=a;n.scale.y=b;n.scale.z=c;borders.push(n);scene.add(n);borders[borders.length-1].visible=!1;p=scales.length;scales[p]=[];scales[p][0]=a;scales[p][1]=b;scales[p][2]=c;setSelectedShape(selectedShape);moveElement("x",d);moveElement("y",f);moveElement("z",k);document.getElementById("diemsions_x").value=a;document.getElementById("diemsions_y").value=b;document.getElementById("diemsions_z").value=c;document.getElementById("position_x").value=
d;document.getElementById("position_y").value=f;document.getElementById("position_z").value=k;saveEngine._localStorageEnable=!1;saveEngine._cloudStorageEnable=!1;showPopUp("popUp_error_body","Warning","Uploading OBJs disables the save engine due to their large amount of polygons",-1)};var createVertices=[],createFaces=[];
function newCustom(a,b,c,d,f,k,m,n,l,e){var h=new THREE.Geometry(1,1,1);if(0!==l.length)for(var p=0;p<l.length;p++)createVertices.push(l[p]);if(0!==e.length)for(p=0;p<l.length;p++)createFaces.push(e[p]);for(l=0;l<createVertices.length;l++)h.vertices.push(createVertices[l]);for(l=0;l<createFaces.length;l++)h.faces.push(createFaces[l]);l=(new THREE.BufferGeometry).fromGeometry(h);n=new THREE.LineSegments(l,new THREE.LineBasicMaterial({color:n}));n.scale.x=a;n.scale.y=b;n.scale.z=c;borders.push(n);scene.add(n);
m=new THREE.MeshLambertMaterial({color:m});h.computeFaceNormals();m.lights=!0;shapes[shapes.length]=new THREE.Mesh(h,m);m=scales.length;h.name="custom";scales[m]=[];scales[m][0]=a;scales[m][1]=b;scales[m][2]=c;scene.add(shapes[shapes.length-1]);selectedShape=shapes.length-1;setSelectedShape(selectedShape);moveElement("x",d);moveElement("y",f);moveElement("z",k);document.getElementById("dimensionX").value=a;document.getElementById("dimensionY").value=b;document.getElementById("dimensionZ").value=c;
document.getElementById("positionBoxX").value=d;document.getElementById("positionBoxY").value=f;document.getElementById("positionBoxZ").value=k;createVertices.length=0;createFaces.length=0;loadCreateFaceList();loadCreateVectorList()}function createVertex(){createVertices.push(new THREE.Vector3(0,0,0));console.log("vector added");console.log(createVertices);loadCreateVectorList()}function cancelVector(a){createVertices.splice(a,1);loadCreateVectorList()}
function loadCreateVectorList(){document.getElementById("createVectorList").innerHTML="";for(var a=0;a<createVertices.length;a++)document.getElementById("createVectorList").innerHTML+='<input id="xCreateCoord" type="number" value="'+createVertices[a].x+'" onkeyup="createVertices['+a+'].setX(this.value)" onchange="createVertices['+a+'].setX(this.value)">X\n        <input id="yCreateCoord" type="number" value="'+createVertices[a].y+'" onkeyup="createVertices['+a+'].setY(this.value)" onchange="createVertices['+
a+'].setY(this.value)">Y\n        <input id="zCreateCoord" type="number" value="'+createVertices[a].z+'" onkeyup="createVertices['+a+'].setZ(this.value)" onchange="createVertices['+a+"].setZ(this.value)\">Z\n        <button class='material-icons' onclick='cancelVector("+a+")'>close</button>\n        \n        <br>";console.log("vector list loaded")}
function cancelCustom(){createVertices.length=0;createFaces.length=0;document.getElementById("createVectorList").innerHTML="";document.getElementById("createFaceList").innerHTML="";shapeMenu()}function createFace(){createFaces.push(new THREE.Face3(0,1,2));console.log("face added");console.log(createFaces);loadCreateFaceList()}function cancelFace(a){createFaces.splice(a,1);loadCreateFaceList()}
function loadCreateFaceList(){document.getElementById("createFaceList").innerHTML="";for(var a=0;a<createFaces.length;a++)document.getElementById("createFaceList").innerHTML+='<input id="xCreatePoint" type="number" value="'+createFaces[a].a+'" onkeyup="createFaces['+a+"].copy(new THREE.Face3(this.value, createFaces["+a+"].b, createFaces["+a+'].c))" onchange="createFaces['+a+"].copy(new THREE.Face3(this.value, createFaces["+a+"].b, createFaces["+a+'].c))">A\n        <input id="yCreatePoint" type="number" value="'+
createFaces[a].b+'" onkeyup="createFaces['+a+"].copy(new THREE.Face3(createFaces["+a+"].a, this.value, createFaces["+a+'].c))" onchange="createFaces['+a+"].copy(new THREE.Face3(createFaces["+a+"].a, this.value, createFaces["+a+'].c))">B\n        <input id="zCreatePoint" type="number" value="'+createFaces[a].c+'" onkeyup="createFaces['+a+"].copy(new THREE.Face3(createFaces["+a+"].a, createFaces["+a+'].b, this.value))" onchange="createFaces['+a+"].copy(new THREE.Face3(createFaces["+a+"].a, createFaces["+
a+"].b, this.value))\">C\n        <button class='material-icons' onclick='cancelFace("+a+")'>close</button>\n        \n        <br>";console.log("face list loaded")};function moveElement(a,b){showingLight?lights[selectedLight].position[a]=Number(b):(shapes[selectedShape].position[a]=Number(b),borders[selectedShape].position[a]=Number(b))}function postitionShape(a,b){shapes[selectedShape].position[a]=Number(b);borders[selectedShape].position[a]=Number(b)}function rotateShape(a,b){shapes[selectedShape].rotation[a]=Number(b)*Math.PI/180;borders[selectedShape].rotation[a]=Number(b)*Math.PI/180}var hasMovedZ=!1;
function resizeShape(a,b){switch(a){case "x":scales[selectedShape][0]=Number(b);borders[selectedShape].scale.x=Number(b);break;case "y":scales[selectedShape][1]=Number(b);borders[selectedShape].scale.y=Number(b);break;case "z":scales[selectedShape][2]=Number(b),borders[selectedShape].scale.z=Number(b)}}function removeElement(){showingLight?removeLight():removeShape()}
function removeShape(){if(0<=selectedShape){scene.remove(shapes[selectedShape]);scene.remove(borders[selectedShape]);shapes.splice(selectedShape,1);scales.splice(selectedShape,1);borders.splice(selectedShape,1);selectedShape=-1;setSelectedShape(selectedShape);for(var a=0;a<keyFrames.length;a++)keyFrames[a].shapes.splice(selectedShape,1),keyFrames[a].scales.splice(selectedShape,1);saveEngine.save(!0,!1)}}
function toggleVisibility(){var a=getId("element_visibility").children[0],b;showingLight?(b=lights[selectedLight].visible)?(lights[selectedLight].visible=!1,a.innerHTML="Show Element"):(lights[selectedLight].visible=!0,a.innerHTML="Hide Element"):(b=shapes[selectedShape].visible)?(shapes[selectedShape].visible=!1,a.innerHTML="Show Element"):(shapes[selectedShape].visible=!0,a.innerHTML="Hide Element")}
function borderChange(a){showingLight?changeGroundLightColor(a):borders[selectedShape].material.color.set(a)}function toggleColorBorder(a){a?document.getElementById("createColorBorder").style.display="inherit":document.getElementById("createColorBorder").style.display="none"}
function duplicateCurrentShape(){var a=shapes[selectedShape];switch(a.geometry.name){case "cube":console.log("Start duplication");newCube(scales[selectedShape][0],scales[selectedShape][1],scales[selectedShape][2],a.position.x,a.position.y,a.position.z,"#"+a.material.color.getHexString(),"#"+borders[selectedShape].material.color.getHexString());break;case "cylinder":newCylinder(scales[selectedShape][0],scales[selectedShape][1],scales[selectedShape][2],a.position.x,a.position.y,a.position.z,"#"+a.material.color.getHexString(),
"#"+borders[selectedShape].material.color.getHexString());break;case "cone":newCone(scales[selectedShape][0],scales[selectedShape][1],scales[selectedShape][2],a.position.x,a.position.y,a.position.z,"#"+a.material.color.getHexString(),"#"+borders[selectedShape].material.color.getHexString());break;case "dodecahedron":newDodecahedron(scales[selectedShape][0],scales[selectedShape][1],scales[selectedShape][2],a.position.x,a.position.y,a.position.z,"#"+a.material.color.getHexString(),"#"+borders[selectedShape].material.color.getHexString());
break;case "icosahedron":newIcosahedron(scales[selectedShape][0],scales[selectedShape][1],scales[selectedShape][2],a.position.x,a.position.y,a.position.z,"#"+a.material.color.getHexString(),"#"+borders[selectedShape].material.color.getHexString());break;case "octahedron":newOctahedron(scales[selectedShape][0],scales[selectedShape][1],scales[selectedShape][2],a.position.x,a.position.y,a.position.z,"#"+a.material.color.getHexString(),"#"+borders[selectedShape].material.color.getHexString());break;case "pyramid":newPyramid(scales[selectedShape][0],
scales[selectedShape][1],scales[selectedShape][2],a.position.x,a.position.y,a.position.z,"#"+a.material.color.getHexString(),"#"+borders[selectedShape].material.color.getHexString());break;case "ring":newRing(scales[selectedShape][0],scales[selectedShape][1],scales[selectedShape][2],a.position.x,a.position.y,a.position.z,"#"+a.material.color.getHexString(),"#"+borders[selectedShape].material.color.getHexString());break;case "sphere":newSphere(scales[selectedShape][0],scales[selectedShape][1],scales[selectedShape][2],
a.position.x,a.position.y,a.position.z,"#"+a.material.color.getHexString(),"#"+borders[selectedShape].material.color.getHexString());break;case "custom":newCustom(scales[selectedShape][0],scales[selectedShape][1],scales[selectedShape][2],a.position.x,a.position.y,a.position.z,"#"+a.material.color.getHexString(),"#"+borders[selectedShape].material.color.getHexString(),a.geometry.vertices,a.geometry.faces);break;case "text":document.getElementById("createText").value=a.geometry.parameters.text,newText(scales[selectedShape][0],
scales[selectedShape][1],scales[selectedShape][2],a.position.x,a.position.y,a.position.z,"#"+a.material.color.getHexString(),"#"+borders[selectedShape].material.color.getHexString()),saveEngine.save(!0,!1)}saveEngine.save(!0,!1)}
function newShape(a,b,c,d,f,k,m,n,l,e){if("custom"!==a&&"text"!==a&&"textIn"!==a){switch(a){case "cube":var h=new THREE.BoxGeometry(1,1,1);var p=new THREE.BoxBufferGeometry(1,1,1);break;case "cone":h=new THREE.ConeGeometry(.5,1,100);p=new THREE.ConeBufferGeometry(.5,1,100);break;case "cylinder":h=new THREE.CylinderGeometry(.5,.5,1,100);p=new THREE.CylinderBufferGeometry(.5,.5,1,100);break;case "dodecahedron":h=new THREE.DodecahedronGeometry(.5,0);p=new THREE.DodecahedronBufferGeometry(.5,0);break;
case "icosahedron":h=new THREE.IcosahedronGeometry(.5,0);p=new THREE.IcosahedronBufferGeometry(.5,0);break;case "octahedron":h=new THREE.OctahedronGeometry(.5,0);p=new THREE.OctahedronBufferGeometry(.5,0);break;case "pyramid":h=new THREE.TetrahedronGeometry(.5,0);p=new THREE.TetrahedronBufferGeometry(.5,0);break;case "ring":h=new THREE.TorusGeometry(.5,.25,200,200);p=new THREE.TorusBufferGeometry(.5,.25,200,200);break;case "sphere":h=new THREE.SphereGeometry(.5,100,100);p=new THREE.SphereBufferGeometry(.5,
100,100);break;default:showPopUp("popUp_error_body","Error","Invalid Shape",-1)}a=a.charAt(0).toUpperCase()+a.substring(1,a.length);var q=new THREE.MeshLambertMaterial({color:n});q.lights=!0;shapes[shapes.length]=new THREE.Mesh(h,q);q=scales.length;h.name=a;scales[q]=[];scales[q][0]=b;scales[q][1]=c;scales[q][2]=d;scene.add(shapes[shapes.length-1]);selectedShape=shapes.length-1;a=new THREE.EdgesGeometry(p);a=new THREE.LineSegments(a,new THREE.LineBasicMaterial({color:l}));a.scale.x=b;a.scale.y=c;
a.scale.z=d;borders.push(a);scene.add(a);setSelectedShape(selectedShape);moveElement("x",f);moveElement("y",k);moveElement("z",m);document.getElementById("diemsions_x").value=b;document.getElementById("diemsions_y").value=c;document.getElementById("diemsions_z").value=d;document.getElementById("position_x").value=f;document.getElementById("position_y").value=k;document.getElementById("position_z").value=m;getId("newShapes_select").selectedIndex=0}else"TextIn"===a?showPopUp("popUp_input_body","New Text",
"Enter Text",1):"Text"===a&&(new THREE.FontLoader).load("https://threejs.org/examples/fonts/helvetiker_regular.typeface.json",function(a){var r=new THREE.TextGeometry(e,{font:a,size:1,height:.05,curveSegments:6,bevelEnabled:!0,bevelThickness:.5,bevelSize:.05,bevelSegments:2.5}),h=new THREE.MeshLambertMaterial({color:n});h.lights=!0;shapes[shapes.length]=new THREE.Mesh(r,h);h=scales.length;r.name=e;scales[h]=[];scales[h][0]=b;scales[h][1]=c;scales[h][2]=d;scene.add(shapes[shapes.length-1]);selectedShape=
shapes.length-1;a=new THREE.TextBufferGeometry(e,{font:a,size:1,height:.05,curveSegments:6,bevelEnabled:!0,bevelThickness:.5,bevelSize:.05,bevelSegments:2.5});a=new THREE.EdgesGeometry(a);a=new THREE.LineSegments(a,new THREE.LineBasicMaterial({color:l}));a.scale.x=b;a.scale.y=c;a.scale.z=d;borders.push(a);scene.add(a);setSelectedShape(selectedShape);moveElement("x",f);moveElement("y",k);moveElement("z",m);document.getElementById("diemsions_x").value=b;document.getElementById("diemsions_y").value=
c;document.getElementById("diemsions_z").value=d;document.getElementById("position_x").value=f;document.getElementById("position_y").value=k;document.getElementById("position_z").value=m;getId("newShapes_select").selectedIndex=0});for(a=0;a<keyFrames.length;a++)keyFrames[a].shapes.push([0,0,0,0,0,0,!1]),keyFrames[a].scales.push([0,0,0]),keyFrames[a].color.push([0,0,0]),keyFrames[a].borderColor.push([0,0,0])}function getId(a){return document.getElementById(a)};function addFrame(){addfortutorial("add_frame");scene.background||(scene.background=new THREE.Color("#000000"));keyFrames.push({duration:2E3,shapes:getShapes(shapes),scales:JSON.parse(JSON.stringify(scales)),xPosition:xPosition,yPosition:yPosition,zPosition:zPosition,xCCenter:xCCenter,yCCenter:yCCenter,zCCenter:zCCenter,xCLook:xCLook,yCLook:yCLook,zCLook:zCLook,circleCameraRotation:circleCameraRotation,color:getColors(shapes),name:"Frame "+keyFrames.length.toString(),borderColor:getColors(borders),
borderVisible:getBorderVisbility(borders),scene:[scene.background.r,scene.background.g,scene.background.b,scene.scale.x,scene.scale.y,scene.scale.z,scene.rotation.x,scene.rotation.y,scene.rotation.z,scene.position.x,scene.position.y,scene.position.z],lights:getLights(lights)});console.log("frame added");console.log(keyFrames);updateTimeline();saveEngine.save(!0,!0)}function loadKeyList(){console.log("Load Key List Called ")}
function playAnimation(a){addfortutorial("play");var b=!1;0===keyFrames.length&&(b=!0);if(!b)if(animationRunning)clearInterval(animationTimer),timelineButtonToggle("timeline_play"),console.log("stopped"),animationRunning=!1,recording&&(timelineButtonToggle("timeline_record"),recording=!1,capturer.stop(),capturer.save());else if(timelineButtonToggle("timeline_play"),console.log("starting"),animationRunning=!0,0<=a&&a<getTotalAnimationTime()){b=0;for(var c,d,f=0,k=0;k<keyFrames.length-1;k++)if(a>=b&&
a<b+keyFrames[k].duration){c=k;break}else b+=keyFrames[k].duration,f+=keyFrames[k].duration;null!=c&&(d=a-b,animationTimer=setInterval(function(){document.getElementById("timeline_playHead").style.left=11+(d+f)/timelineScale+"px";d<keyFrames[c].duration?(d+=10,updateAnimation(d,c)):c<keyFrames.length-2?(f+=keyFrames[c].duration,c++,d=0):loopAnimation?(d=f=c=0,document.getElementById("timeline_playHead").style.left="1px"):(clearInterval(animationTimer),timelineButtonToggle("timeline_play"),console.log("done"),
animationRunning=!1,recording&&(timelineButtonToggle("timeline_record"),recording=!1,capturer.stop(),capturer.save()),lastTickAnimated=0)},10))}}function getShapes(a){for(var b=[],c=0;c<a.length;c++)b.push([a[c].position.x,a[c].position.y,a[c].position.z,a[c].rotation.x,a[c].rotation.y,a[c].rotation.z,a[c].visible]);return b}
function getLights(a){for(var b=[],c=0;c<a.length;c++)b.push([a[c].intensity,a[c].position.x,a[c].position.y,a[c].position.z,a[c].color.r,a[c].color.g,a[c].color.b,a[c].rotation.x,a[c].rotation.y,a[c].rotation.z,a[c].visible]),"HemisphereLight"===a[c].type&&b[c].push(a[c].groundColor.r,a[c].groundColor.g,a[c].groundColor.b);return b}function getBorderVisbility(a){for(var b=[],c=0;c<a.length;c++)b.push(a[c].visible);return b}
function getColors(a){for(var b=[],c=0;c<a.length;c++)b.push([a[c].material.color.r,a[c].material.color.g,a[c].material.color.b]);return b}
function updateAnimation(a,b){if(lockCamera)if(xCLook=keyFrames[b].xCLook+(keyFrames[b+1].xCLook-keyFrames[b].xCLook)/keyFrames[b].duration*a,yCLook=keyFrames[b].yCLook+(keyFrames[b+1].yCLook-keyFrames[b].yCLook)/keyFrames[b].duration*a,zCLook=keyFrames[b].zCLook+(keyFrames[b+1].zCLook-keyFrames[b].zCLook)/keyFrames[b].duration*a,xCCenter=keyFrames[b].xCCenter+(keyFrames[b+1].xCCenter-keyFrames[b].xCCenter)/keyFrames[b].duration*a,yCCenter=keyFrames[b].yCCenter+(keyFrames[b+1].yCCenter-keyFrames[b].yCCenter)/
keyFrames[b].duration*a,zCCenter=keyFrames[b].zCCenter+(keyFrames[b+1].zCCenter-keyFrames[b].zCCenter)/keyFrames[b].duration*a,isNaN(keyFrames[0].xCLook)&&(keyFrames[0].xCLook=0),isNaN(keyFrames[0].yCLook)&&(keyFrames[0].yCLook=0),isNaN(keyFrames[0].zCLook)&&(keyFrames[0].zCLook=0),isNaN(keyFrames[1].xCLook)&&(keyFrames[1].xCLook=0),isNaN(keyFrames[1].yCLook)&&(keyFrames[1].yCLook=0),isNaN(keyFrames[1].zCLook)&&(keyFrames[1].zCLook=0),zoom1Zv=Math.pow(Math.pow(keyFrames[b].xCLook-xPosition,2)+Math.pow(keyFrames[b].zCLook-
zPosition,2),.5),zoom1v=Math.pow(Math.pow(zoom1Zv,2)+Math.pow(keyFrames[b].yCLook-yPosition,2),.5),cameraDebug&&(console.log("f1zoomZ "+zoom1Zv),console.log("f1zoom "+zoom1v)),Ry1v=Rz1v=0,0!==keyFrames[b].xCLook-xPosition?Rz1v=Math.atan((keyFrames[b].zCLook-zPosition)/(keyFrames[b].xCLook-xPosition)):0<keyFrames[b].zCLook-zPosition?Rz1v=Math.PI:0>keyFrames[b].zCLook-zPosition&&(Rz1v=-Math.PI),0>xPosition&&(0>Rz1v?Rz1v+=Math.PI:0<Rz1v&&(Rz1v-=Math.PI)),0!==keyFrames[b].xCLook-xPosition||0!==zPosition-
keyFrames[b].zCLook?Ry1v=Math.atan((keyFrames[b].yCLook-yPosition)/zoom1Zv):0<keyFrames[b].yCLook-yPosition?Ry1v=Math.PI:0>keyFrames[b].yCLook-yPosition&&(Ry1v=-Math.PI),zoom2Zv=Math.pow(Math.pow(keyFrames[b+1].xCLook-xPosition,2)+Math.pow(keyFrames[b+1].zCLook-zPosition,2),.5),zoom2v=Math.pow(Math.pow(zoom2Zv,2)+Math.pow(yPosition-keyFrames[b+1].yCLook,2),.5),cameraDebug&&(console.log("f2zoomZ "+zoom2Zv),console.log("f2zoom "+zoom2v)),Ry2v=Rz2v=0,0!==keyFrames[b+1].xCLook-xPosition?Rz2v=Math.atan((keyFrames[b+
1].zCLook-zPosition)/(keyFrames[b+1].xCLook-xPosition)):0<keyFrames[b+1].zCLook-zPosition?Rz2v=Math.PI:0>keyFrames[b+1].zCLook-zPosition&&(Rz2v=-Math.PI),0>keyFrames[b+1].xPosition&&0>Rz2v?Rz2v+=Math.PI:0>keyFrames[b+1].xPosition&&0<Rz2v&&(Rz2v-=Math.PI),0!==keyFrames[b+1].xCLook-xPosition||0!==keyFrames[b+1].zCLook-zPosition?Ry2v=Math.atan((keyFrames[b+1].yCLook-yPosition)/zoom2Zv):0<keyFrames[b+1].yCLook-yPosition?Ry2v=Math.PI:0>keyFrames[b+1].yCLook-yPosition&&(Ry2v=-Math.PI),cameraDebug&&(console.log("f1RY "+
Ry1v/Math.PI*180+"\u00b0"),console.log("f2RY "+Ry2v/Math.PI*180+"\u00b0"),console.log("f1RZ "+Rz1v/Math.PI*180+"\u00b0"),console.log("f2RZ "+Rz2v/Math.PI*180+"\u00b0")),MvXv=Rz2v-Rz1v,MvYv=Ry2v-Ry1v,zoomChangev=zoom2v-zoom1v,zoomZChangev=zoom2Zv-zoom1Zv,cameraDebug&&(console.log("moving zoom "+zoomChangev),console.log("moving zoomZ "+zoomZChangev),console.log("moving X "+MvXv/Math.PI*180+"\u00b0"),console.log("moving Y "+MvYv/Math.PI*180+"\u00b0")),cameraDebug&&(console.log(xCLook),console.log(yCLook),
console.log(zCLook)),circleCameraRotation=keyFrames[b+1].circleCameraRotation){if(10>=a||!animationRunning)zoom1Z=Math.pow(Math.pow(keyFrames[b].xPosition,2)+Math.pow(keyFrames[b].zPosition,2),.5),zoom1=Math.pow(Math.pow(zoom1Z,2)+Math.pow(keyFrames[b].yPosition,2),.5),cameraDebug&&(console.log("f1zoomZ "+zoom1Z),console.log("f1zoom "+zoom1)),Ry1=Rz1=0,0!==keyFrames[b].xPosition?Rz1=Math.atan(keyFrames[b].zPosition/keyFrames[b].xPosition):0<keyFrames[b].zPosition?Rz1=Math.PI:0>keyFrames[b].zPosition&&
(Rz1=-Math.PI),0>keyFrames[b].xPosition&&(0>Rz1?Rz1+=Math.PI:0<Rz1&&(Rz1-=Math.PI)),0!==keyFrames[b].xPosition||0!==keyFrames[b].zPosition?Ry1=Math.atan(keyFrames[b].yPosition/zoom1Z):0<keyFrames[b].yPosition?Ry1=Math.PI:0>keyFrames[b].yPosition&&(Ry1=-Math.PI),zoom2Z=Math.pow(Math.pow(keyFrames[b+1].xPosition,2)+Math.pow(keyFrames[b+1].zPosition,2),.5),zoom2=Math.pow(Math.pow(zoom2Z,2)+Math.pow(keyFrames[b+1].yPosition,2),.5),cameraDebug&&(console.log("f2zoomZ "+zoom2Z),console.log("f2zoom "+zoom2)),
Ry2=Rz2=0,0!==keyFrames[b+1].xPosition?Rz2=Math.atan(keyFrames[b+1].zPosition/keyFrames[b+1].xPosition):0<keyFrames[b+1].zPosition?Rz2=Math.PI:0>keyFrames[b+1].zPosition&&(Rz2=-Math.PI),0>keyFrames[b+1].xPosition&&(0>Rz2?Rz2+=Math.PI:0<Rz2&&(Rz2-=Math.PI)),0!==keyFrames[b+1].xPosition||0!==keyFrames[b+1].zPosition?Ry2=Math.atan(keyFrames[b+1].yPosition/zoom2Z):0<keyFrames[b+1].yPosition?Ry2=Math.PI:0>keyFrames[b+1].yPosition&&(Ry2=-Math.PI),cameraDebug&&(console.log("f1RY "+Ry1/Math.PI*180+"\u00b0"),
console.log("f2RY "+Ry2/Math.PI*180+"\u00b0"),console.log("f1RZ "+Rz1/Math.PI*180+"\u00b0"),console.log("f2RZ "+Rz2/Math.PI*180+"\u00b0")),MvX=Rz2-Rz1,MvY=Ry2-Ry1,zoomChange=zoom2-zoom1,zoomZChange=zoom2Z-zoom1Z,cameraDebug&&(console.log("moving zoom "+zoomChange),console.log("moving zoomZ "+zoomZChange),console.log("moving X "+MvX/Math.PI*180+"\u00b0"),console.log("moving Y "+MvY/Math.PI*180+"\u00b0"));yPosition=(zoom1+zoomChange/keyFrames[b].duration*a)*Math.sin(Ry1+MvY/keyFrames[b].duration*a);
xPosition=(zoom1Z+zoomZChange/keyFrames[b].duration*a)*Math.cos(Rz1+MvX/keyFrames[b].duration*a);zPosition=(zoom1Z+zoomZChange/keyFrames[b].duration*a)*Math.sin(Rz1+MvX/keyFrames[b].duration*a);cameraDebug&&(console.log(xPosition),console.log(yPosition),console.log(zPosition));isNaN(yPosition)&&(yPosition=0);isNaN(xPosition)&&(xPosition=0);isNaN(zPosition)&&(zPosition=0)}else xPosition=keyFrames[b].xPosition+(keyFrames[b+1].xPosition-keyFrames[b].xPosition)/keyFrames[b].duration*a,yPosition=keyFrames[b].yPosition+
(keyFrames[b+1].yPosition-keyFrames[b].yPosition)/keyFrames[b].duration*a,zPosition=keyFrames[b].zPosition+(keyFrames[b+1].zPosition-keyFrames[b].zPosition)/keyFrames[b].duration*a;scene.background.fromArray(updateElement([scene.background.r,scene.background.g,scene.background.b],[0,1,2],b,a,"scene",0));scene.scale.fromArray(updateElement([scene.scale.x,scene.scale.y,scene.scale.z],[3,4,5],b,a,"scene",0));scene.rotation.fromArray(updateElement([scene.rotation.x,scene.rotation.y,scene.rotation.z],
[6,7,8],b,a,"scene",0));scene.position.fromArray(updateElement([scene.position.x,scene.position.y,scene.position.z],[9,10,11],b,a,"scene",0));for(var c=0;c<keyFrames[b].scales.length;c++)shapes[c].visible=keyFrames[b+1].shapes[c][6],borders[c].visible=keyFrames[b+1].shapes[c][6]&&keyFrames[b+1].borderVisible[c],scales[c]=updateElement([scales[c][0],scales[c][1],scales[c][2]],[0,1,2],b,a,"scales",c),borders[c].scale.fromArray(updateElement([borders[c].scale.x,borders[c].scale.y,borders[c].scale.z],
[0,1,2],b,a,"scales",c)),shapes[c].position.fromArray(updateElement([shapes[c].position.x,shapes[c].position.y,shapes[c].position.z],[0,1,2],b,a,"shapes",c)),shapes[c].rotation.fromArray(updateElement([shapes[c].rotation.x,shapes[c].rotation.y,shapes[c].rotation.z],[3,4,5],b,a,"shapes",c)),borders[c].position.fromArray(updateElement([borders[c].position.x,borders[c].position.y,borders[c].position.z],[0,1,2],b,a,"shapes",c)),borders[c].rotation.fromArray(updateElement([borders[c].rotation.x,borders[c].rotation.y,
borders[c].rotation.z],[3,4,5],b,a,"shapes",c)),shapes[c].material.color.fromArray(updateElement([shapes[c].material.color.r,shapes[c].material.color.g,shapes[c].material.color.b],[0,1,2],b,a,"shape color",c)),borders[c].material.color.fromArray(updateElement([borders[c].material.color.r,borders[c].material.color.g,borders[c].material.color.b],[0,1,2],b,a,"border color",c));for(c=0;c<lights.length;c++)null!=keyFrames[b].lights[c]&&null!=keyFrames[b+1].lights[c]&&(lights[c].visible=keyFrames[b].lights.visible,
lights[c].position.fromArray(updateElement([lights[c].position.x,lights[c].position.y,lights[c].position.z],[1,2,3],b,a,"lights",c)),lights[c].rotation.fromArray(updateElement([lights[c].rotation.x,lights[c].rotation.y,lights[c].rotation.z],[7,8,9],b,a,"lights",c)),lights[c].color.fromArray(updateElement([lights[c].color.r,lights[c].color.g,lights[c].color.b],[4,5,6],b,a,"lights",c)),"HemisphereLight"===lights[c].type&&lights[c].groundColor.fromArray(updateElement([lights[c].groundColor.r,lights[c].groundColor.g,
lights[c].groundColor.b],[10,11,12],b,a,"lights",c)),lights[c].intensity=updateElement([lights[c].intensity],[0],b,a,"lights",c)[0]);for(c=lastTickAnimated=0;c<b;c++)lastTickAnimated+=keyFrames[c].duration;lastTickAnimated+=a}
function updateElement(a,b,c,d,f,k){switch(f){case "shapes":for(f=0;f<a.length;f++)a[f]=keyFrames[c].shapes[k][b[f]]+(keyFrames[c+1].shapes[k][b[f]]-keyFrames[c].shapes[k][b[f]])/keyFrames[c].duration*d;break;case "shape color":for(f=0;f<a.length;f++)a[f]=keyFrames[c].color[k][b[f]]+(keyFrames[c+1].color[k][b[f]]-keyFrames[c].color[k][b[f]])/keyFrames[c].duration*d;break;case "border color":for(f=0;f<a.length;f++)a[f]=keyFrames[c].borderColor[k][b[f]]+(keyFrames[c+1].borderColor[k][b[f]]-keyFrames[c].borderColor[k][b[f]])/
keyFrames[c].duration*d;break;case "scales":for(f=0;f<a.length;f++)a[f]=keyFrames[c].scales[k][b[f]]+(keyFrames[c+1].scales[k][b[f]]-keyFrames[c].scales[k][b[f]])/keyFrames[c].duration*d;break;case "lights":for(f=0;f<a.length;f++)a[f]=keyFrames[c].lights[k][b[f]]+(keyFrames[c+1].lights[k][b[f]]-keyFrames[c].lights[k][b[f]])/keyFrames[c].duration*d;break;case "scene":for(k=0;k<a.length;k++)a[k]=keyFrames[c].scene[b[k]]+(keyFrames[c+1].scene[b[k]]-keyFrames[c].scene[b[k]])/keyFrames[c].duration*d}return a}
var recording=!1;function record(){recording=!0;capturer=new CCapture({format:"webm",frameRate:60,name:saveEngine.localFileName});timelineButtonToggle("timeline_record");capturer.start();playAnimation(0)};var timelineScale=0;
function updateTimeline(){timelineScale=getTotalAnimationTime()/(window.innerWidth-50);var a=getId("std_timeline").children.item(1);a.innerHTML='<span id="timeline_playHead" ></span>';getId("timeLine_animationFinish").innerHTML=(getTotalAnimationTime()/1E3).toString()+" s";for(var b=5,c=0;c<keyFrames.length;c++)a.innerHTML+="<div class='timeline_keyframe' style='left: "+b+"px'></div>",a.children[c+1].setAttribute("onclick","showKeyframePopup("+c+'); tutorialMovement(10000,10000,"This is the keyframes menu. You can edit stuff for this keyframe like the duration. Duration is in miliseconds. Click comit changes at the bottom to continue.", 0);'),b+=
keyFrames[c].duration/timelineScale;console.log("Updated Time Line")}function getAnimationTimeUpToIndex(a){for(var b=0,c=0;c<a;c++)b+=parseInt(keyFrames[c].duration);return b}function getTotalAnimationTime(){for(var a=0,b=0;b<keyFrames.length-1;b++)a+=parseInt(keyFrames[b].duration);return a}function loop(){animationRunning?(loopAnimation=!1,timelineButtonToggle("timeline_repeat")):(timelineButtonToggle("timeline_repeat"),loopAnimation=!0,playAnimation(0))}
function keyName(a,b){keyFrames[b].name=a}function removeFrame(a){addfortutorial("remove_frame");animationRunning&&playAnimation(0);keyFrames.splice(a,1);updateTimeline()}function moveUp(a){var b=keyFrames[a];keyFrames.splice(a,1);keyFrames.splice(a-1,0,b);updateTimeline()}function moveDown(a){var b=keyFrames[a];keyFrames.splice(a,1);keyFrames.splice(a+1,0,b);updateTimeline()}function setSpeed(a,b){console.log(b);keyFrames[a].duration=b}
function timelineScrub(a){timelinePosition=a=(a-10)*timelineScale;if(0<=a){for(var b=0,c,d=0;d<keyFrames.length-1;d++)if(a>=b&&a<b+keyFrames[d].duration){c=d;break}else b+=keyFrames[d].duration;null!=c&&(document.getElementById("timeline_playHead").style.left=1+a/timelineScale+"px",updateAnimation(a-b,c),animationRunning&&playAnimation())}}
function changeTimelineDuration(a){for(;a>-keyFrames[keyFrames.length-2].duration;)keyFrames.splice(keyFrames.length-1,1),a+=keyFrames[keyFrames.length-1].duration;keyFrames[keyFrames.length-2]+=a}function moveKeyframeto(a,b){for(var c=0,d=0;d<a;d++)c+=keyFrames[d].duration;console.log("duration to frame: "+c);var f=0;for(d=0;d<keyFrames.length;d++)f+=keyFrames[d];0>b||b>f?console.log("point out of bounds"):moveKeyframe(a,b-c)}
function moveKeyframe(a,b){if(0>a||a>=keyFrames.length)console.log("Frame out of bounds");else if(0===a)keyFrames[a].duration-=b;else if(console.log("moving: "+b),b<-keyFrames[a-1].duration){console.log("shifting down");for(var c=0;b<-keyFrames[a-1+c].duration;)b+=keyFrames[a-1+c].duration,c--;b=-b;console.log(c+" frames");console.log(b+" remainder");changeKeyframePosition(a,a+c);keyFrames[a].duration+=keyFrames[a+c].duration;keyFrames[a+c-1].duration-=b;keyFrames[a+c].duration=b}else if(b>keyFrames[a].duration){console.log("shifting up:");
c=0;for(console.log("keyFrames");b>keyFrames[a+c].duration;)b-=keyFrames[a+c].duration,c++;console.log(c+" frames");console.log(b+" remainder");changeKeyframePosition(a,a+c);keyFrames[a-1].duration+=keyFrames[a+c].duration;keyFrames[a+c-1].duration-=b;keyFrames[a+c].duration=b}else console.log("within bounds"),keyFrames[a-1].duration+=b,keyFrames[a].duration-=b}
function changeKeyframePosition(a,b){console.log("moving "+a+" to "+b);var c=keyFrames[b];keyFrames[b]=keyFrames[a];if(b<a){for(;a>b+1;a--)keyFrames[a]=keyFrames[a-1];keyFrames[b+1]=c}else{for(;a<b-1;a++)keyFrames[a]=keyFrames[a+1];keyFrames[b-1]=c}}var activeKeyframeIndex=0,keyframePopup=document.getElementById("std_timeline_popUp");
function showKeyframePopup(a){keyframePopup||(keyframePopup=document.getElementById("std_timeline_popUp"));activeKeyframeIndex=a;setKeyframePopupData();keyframePopup.style.display="block";keyframePopup.classList.add("timeline_popUp_show")}
function setKeyframePopupData(){keyframePopup.children[0].innerHTML="Editing Keyframe "+(activeKeyframeIndex+1).toString();keyframePopup.children[1].children[0].value=(activeKeyframeIndex+1).toString();keyframePopup.children[2].children[0].value=getAnimationTimeUpToIndex(activeKeyframeIndex).toString();keyframePopup.children[3].children[0].value=keyFrames[activeKeyframeIndex].duration;keyframePopup.children[4].children[0].value=getTotalAnimationTime().toString()}
function applyChanges(){keyFrames[activeKeyframeIndex].duration=parseInt(keyframePopup.children[3].children[0].value);1<=keyFrames.length||(changeKeyframePosition(activeKeyframeIndex,parseInt(keyframePopup.children[1].children[0].value)-1),moveKeyframeto(activeKeyframeIndex,parseInt(keyframePopup.children[2].children[0].value)),changeTimelineDuration(parseInt(keyframePopup.children[4].children[0].value)));updateTimeline()}
function hideKeyframePopup(){keyframePopup.style.display="none";keyframePopup.classList.remove("timeline_popUp_show");keyframePopup.children[0].innerHTML="";keyframePopup.children[1].children[0].value="";keyframePopup.children[2].children[0].value=getAnimationTimeUpToIndex(activeKeyframeIndex).toString();keyframePopup.children[3].children[0].value=keyFrames[activeKeyframeIndex].duration;keyframePopup.children[4].children[0].value=getTotalAnimationTime().toString()};function changeColor(a){showingLight?lights[selectedLight].color.set(a):(shapes[selectedShape].material.color.set(a),shapes[selectedShape].material.needsUpdate=!0)}function rgbToHex(a){a=Number(a).toString(16);2>a.length&&(a="0"+a);return a}
function addShape(){document.getElementById("createTextMenu").style.display="none";var a=document.getElementById("shapeSelector").value;saveEngine.save(!0,!1);switch(a){case "cube":newCube(0,0,0,0,0,0,"#ff0000","#000000");break;case "cylinder":newCylinder(0,0,0,0,0,0,"#ff0000","#000000");break;case "cone":newCone(0,0,0,0,0,0,"#ff0000","#000000");break;case "custom":hideAll();document.getElementById("createCustomMenu").style.display="inherit";break;case "custom2":hideAll();document.getElementById("FileUpload").style.display=
"inherit";break;case "dodecahedron":newDodecahedron(0,0,0,0,0,0,"#ff0000","#000000");break;case "icosahedron":newIcosahedron(0,0,0,0,0,0,"#ff0000","#000000");break;case "octahedron":newOctahedron(0,0,0,0,0,0,"#ff0000","#000000");break;case "pyramid":newPyramid(0,0,0,0,0,0,"#ff0000","#000000");break;case "ring":newRing(0,0,0,0,0,0,"#ff0000","#000000");break;case "sphere":newSphere(0,0,0,0,0,0,"#ff0000","#000000");break;case "text":hideAll(),document.getElementById("createTextMenu").style.display="inherit"}}
;var UIDiemsions={std_navBar:{defaultPadding:2,defaultUnit:"px",nav_height:0,element_height:0,menuContainer_height:0,button_width:0,status_width:0,nav_width:0,menuContainer_width:0,leftSpacer_width:0,rightSpacer_width:0,button_placement:[],spacer_placement:[],status_placement:0,menuContainer_placement:0},std_body:{window_height:window.innerHeight,window_width:window.innerWidth,body_height:0,body_width:0,renderer_height:0,renderer_width:0,renderer_left:0,renderer_top:0},std_timeline:{timeline_height:150,
timeline_width:0}};var shownPopUp="init";function showPopUp(a,b,c,d){getId("std_popUp").classList.add("popUp_show");getId(a).classList.add("popUp_show");getId(a).children.item(0).textContent=b;getId(a).children.item(1).classList.contains("std_input_text")?getId(a).children.item(1).children.item(3).innerHTML=c:getId(a).children.item(1).innerHTML=c;getId(a).children.item(2).setAttribute("onclick","popUpAction("+d+"); hidePopUp();");shownPopUp=a}
function popUpAction(a){if(0===a)saveEngine.createNewLocalSave(getPopUpInput());else if(1===a)newShape("text",1,1,1,0,0,0,"#FF0000","#000000",getPopUpInput());else if(2===a)saveEngine.createNewLocalSave(getPopUpInput()),launchTutorial();else if(3===a)firebase.auth().createUserWithEmailAndPassword(saveEngine.cloudStorage.userName,Base64.decode(saveEngine.cloudStorage.userUID)).catch(function(a){});else if(4===a)firebase.auth().signOut();else if(100===a)location.reload();else return;3!==a&&4!==a&&100!==
a&&getId(getId(shownPopUp).children.item(1).children.item(0).value="")}function getPopUpInput(){return"init"!==shownPopUp&&shownPopUp.includes("input")?getId(shownPopUp).children.item(1).children.item(0).value:""}function hidePopUp(){getId(shownPopUp).classList.remove("popUp_show");getId("std_popUp").classList.remove("popUp_show")};/*
 For open source use: GPLv3
          For commercial use: JSColor Commercial License
 @author  Jan Odvarko
 @version 2.0.5

 See usage examples at http://jscolor.com/examples/
*/
window.jscolor||(window.jscolor=function(){var a={register:function(){a.attachDOMReadyEvent(a.init);a.attachEvent(document,"mousedown",a.onDocumentMouseDown);a.attachEvent(document,"touchstart",a.onDocumentTouchStart);a.attachEvent(window,"resize",a.onWindowResize)},init:function(){a.jscolor.lookupClass&&a.jscolor.installByClassName(a.jscolor.lookupClass)},tryInstallOnElements:function(b,c){c=new RegExp("(^|\\s)("+c+")(\\s*(\\{[^}]*\\})|\\s|$)","i");for(var d=0;d<b.length;d+=1)if(void 0===b[d].type||
"color"!=b[d].type.toLowerCase()||!a.isColorAttrSupported){var f;if(!b[d].jscolor&&b[d].className&&(f=b[d].className.match(c))){var k=b[d],m=null,n=a.getDataAttr(k,"jscolor");null!==n?m=n:f[4]&&(m=f[4]);n={};if(m)try{n=(new Function("return ("+m+")"))()}catch(l){a.warn("Error parsing jscolor options: "+l+":\n"+m)}k.jscolor=new a.jscolor(k,n)}}},isColorAttrSupported:function(){var a=document.createElement("input");return a.setAttribute&&(a.setAttribute("type","color"),"color"==a.type.toLowerCase())?
!0:!1}(),isCanvasSupported:function(){var a=document.createElement("canvas");return!(!a.getContext||!a.getContext("2d"))}(),fetchElement:function(a){return"string"===typeof a?document.getElementById(a):a},isElementType:function(a,c){return a.nodeName.toLowerCase()===c.toLowerCase()},getDataAttr:function(a,c){a=a.getAttribute("data-"+c);return null!==a?a:null},attachEvent:function(a,c,d){a.addEventListener?a.addEventListener(c,d,!1):a.attachEvent&&a.attachEvent("on"+c,d)},detachEvent:function(a,c,
d){a.removeEventListener?a.removeEventListener(c,d,!1):a.detachEvent&&a.detachEvent("on"+c,d)},_attachedGroupEvents:{},attachGroupEvent:function(b,c,d,f){a._attachedGroupEvents.hasOwnProperty(b)||(a._attachedGroupEvents[b]=[]);a._attachedGroupEvents[b].push([c,d,f]);a.attachEvent(c,d,f)},detachGroupEvents:function(b){if(a._attachedGroupEvents.hasOwnProperty(b)){for(var c=0;c<a._attachedGroupEvents[b].length;c+=1){var d=a._attachedGroupEvents[b][c];a.detachEvent(d[0],d[1],d[2])}delete a._attachedGroupEvents[b]}},
attachDOMReadyEvent:function(a){var b=!1,d=function(){b||(b=!0,a())};if("complete"===document.readyState)setTimeout(d,1);else if(document.addEventListener)document.addEventListener("DOMContentLoaded",d,!1),window.addEventListener("load",d,!1);else if(document.attachEvent&&(document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&(document.detachEvent("onreadystatechange",arguments),d())}),window.attachEvent("onload",d),document.documentElement.doScroll&&window==window.top)){var f=
function(){if(document.body)try{document.documentElement.doScroll("left"),d()}catch(k){setTimeout(f,1)}};f()}},warn:function(a){window.console&&window.console.warn&&window.console.warn(a)},preventDefault:function(a){a.preventDefault&&a.preventDefault();a.returnValue=!1},captureTarget:function(b){b.setCapture&&(a._capturedTarget=b,a._capturedTarget.setCapture())},releaseTarget:function(){a._capturedTarget&&(a._capturedTarget.releaseCapture(),a._capturedTarget=null)},fireEvent:function(a,c){if(a)if(document.createEvent){var b=
document.createEvent("HTMLEvents");b.initEvent(c,!0,!0);a.dispatchEvent(b)}else if(document.createEventObject)b=document.createEventObject(),a.fireEvent("on"+c,b);else if(a["on"+c])a["on"+c]()},classNameToList:function(a){return a.replace(/^\s+|\s+$/g,"").split(/\s+/)},hasClass:function(a,c){return c?-1!=(" "+a.className.replace(/\s+/g," ")+" ").indexOf(" "+c+" "):!1},setClass:function(b,c){c=a.classNameToList(c);for(var d=0;d<c.length;d+=1)a.hasClass(b,c[d])||(b.className+=(b.className?" ":"")+c[d])},
unsetClass:function(b,c){c=a.classNameToList(c);for(var d=0;d<c.length;d+=1)b.className=b.className.replace(new RegExp("^\\s*"+c[d]+"\\s*|\\s*"+c[d]+"\\s*$|\\s+"+c[d]+"(\\s+)","g"),"$1")},getStyle:function(a){return window.getComputedStyle?window.getComputedStyle(a):a.currentStyle},setStyle:function(){var a=document.createElement("div"),c=function(b){for(var c=0;c<b.length;c+=1)if(b[c]in a.style)return b[c]},d={borderRadius:c(["borderRadius","MozBorderRadius","webkitBorderRadius"]),boxShadow:c(["boxShadow",
"MozBoxShadow","webkitBoxShadow"])};return function(a,b,c){switch(b.toLowerCase()){case "opacity":b=Math.round(100*parseFloat(c));a.style.opacity=c;a.style.filter="alpha(opacity="+b+")";break;default:a.style[d[b]]=c}}}(),setBorderRadius:function(b,c){a.setStyle(b,"borderRadius",c||"0")},setBoxShadow:function(b,c){a.setStyle(b,"boxShadow",c||"none")},getElementPos:function(b,c){var d=b.getBoundingClientRect();b=d.left;d=d.top;c||(c=a.getViewPos(),b+=c[0],d+=c[1]);return[b,d]},getElementSize:function(a){return[a.offsetWidth,
a.offsetHeight]},getAbsPointerPos:function(a){a||(a=window.event);var b=0,d=0;"undefined"!==typeof a.changedTouches&&a.changedTouches.length?(b=a.changedTouches[0].clientX,d=a.changedTouches[0].clientY):"number"===typeof a.clientX&&(b=a.clientX,d=a.clientY);return{x:b,y:d}},getRelPointerPos:function(a){a||(a=window.event);var b=(a.target||a.srcElement).getBoundingClientRect(),d=0,f=0;"undefined"!==typeof a.changedTouches&&a.changedTouches.length?(d=a.changedTouches[0].clientX,f=a.changedTouches[0].clientY):
"number"===typeof a.clientX&&(d=a.clientX,f=a.clientY);return{x:d-b.left,y:f-b.top}},getViewPos:function(){var a=document.documentElement;return[(window.pageXOffset||a.scrollLeft)-(a.clientLeft||0),(window.pageYOffset||a.scrollTop)-(a.clientTop||0)]},getViewSize:function(){var a=document.documentElement;return[window.innerWidth||a.clientWidth,window.innerHeight||a.clientHeight]},redrawPosition:function(){if(a.picker&&a.picker.owner){var b=a.picker.owner;if(b.fixed){var c=a.getElementPos(b.targetElement,
!0);var d=[0,0]}else c=a.getElementPos(b.targetElement),d=a.getViewPos();var f=a.getElementSize(b.targetElement),k=a.getViewSize(),m=a.getPickerOuterDims(b);switch(b.position.toLowerCase()){case "left":var n=1;var l=0;var e=-1;break;case "right":n=1;l=0;e=1;break;case "top":n=0;l=1;e=-1;break;default:n=0,e=l=1}var h=(f[l]+m[l])/2;d=b.smartPosition?[-d[n]+c[n]+m[n]>k[n]?-d[n]+c[n]+f[n]/2>k[n]/2&&0<=c[n]+f[n]-m[n]?c[n]+f[n]-m[n]:c[n]:c[n],-d[l]+c[l]+f[l]+m[l]-h+h*e>k[l]?-d[l]+c[l]+f[l]/2>k[l]/2&&0<=
c[l]+f[l]-h-h*e?c[l]+f[l]-h-h*e:c[l]+f[l]-h+h*e:0<=c[l]+f[l]-h+h*e?c[l]+f[l]-h+h*e:c[l]+f[l]-h-h*e]:[c[n],c[l]+f[l]-h+h*e];a._drawPosition(b,d[n],d[l],b.fixed?"fixed":"absolute",(d[0]+m[0]>c[0]||d[0]<c[0]+f[0])&&d[1]+m[1]<c[1]+f[1])}},_drawPosition:function(b,c,d,f,k){k=k?0:b.shadowBlur;a.picker.wrap.style.position=f;a.picker.wrap.style.left=c+"px";a.picker.wrap.style.top=d+"px";a.setBoxShadow(a.picker.boxS,b.shadow?new a.BoxShadow(0,k,b.shadowBlur,0,b.shadowColor):null)},getPickerDims:function(b){var c=
!!a.getSliderComponent(b);return[2*b.insetWidth+2*b.padding+b.width+(c?2*b.insetWidth+a.getPadToSliderPadding(b)+b.sliderSize:0),2*b.insetWidth+2*b.padding+b.height+(b.closable?2*b.insetWidth+b.padding+b.buttonHeight:0)]},getPickerOuterDims:function(b){var c=a.getPickerDims(b);return[c[0]+2*b.borderWidth,c[1]+2*b.borderWidth]},getPadToSliderPadding:function(a){return Math.max(a.padding,1.5*(2*a.pointerBorderWidth+a.pointerThickness))},getPadYComponent:function(a){switch(a.mode.charAt(1).toLowerCase()){case "v":return"v"}return"s"},
getSliderComponent:function(a){if(2<a.mode.length)switch(a.mode.charAt(2).toLowerCase()){case "s":return"s";case "v":return"v"}return null},onDocumentMouseDown:function(b){b||(b=window.event);var c=b.target||b.srcElement;if(c._jscLinkedInstance)c._jscLinkedInstance.showOnClick&&c._jscLinkedInstance.show();else if(c._jscControlName)a.onControlPointerStart(b,c,c._jscControlName,"mouse");else a.picker&&a.picker.owner&&a.picker.owner.hide()},onDocumentTouchStart:function(b){b||(b=window.event);var c=
b.target||b.srcElement;if(c._jscLinkedInstance)c._jscLinkedInstance.showOnClick&&c._jscLinkedInstance.show();else if(c._jscControlName)a.onControlPointerStart(b,c,c._jscControlName,"touch");else a.picker&&a.picker.owner&&a.picker.owner.hide()},onWindowResize:function(b){a.redrawPosition()},onParentScroll:function(b){a.picker&&a.picker.owner&&a.picker.owner.hide()},_pointerMoveEvent:{mouse:"mousemove",touch:"touchmove"},_pointerEndEvent:{mouse:"mouseup",touch:"touchend"},_pointerOrigin:null,_capturedTarget:null,
onControlPointerStart:function(b,c,d,f){var k=c._jscInstance;a.preventDefault(b);a.captureTarget(c);var m=function(k,e){a.attachGroupEvent("drag",k,a._pointerMoveEvent[f],a.onDocumentPointerMove(b,c,d,f,e));a.attachGroupEvent("drag",k,a._pointerEndEvent[f],a.onDocumentPointerEnd(b,c,d,f))};m(document,[0,0]);if(window.parent&&window.frameElement){var n=window.frameElement.getBoundingClientRect();m(window.parent.window.document,[-n.left,-n.top])}m=a.getAbsPointerPos(b);n=a.getRelPointerPos(b);a._pointerOrigin=
{x:m.x-n.x,y:m.y-n.y};switch(d){case "pad":switch(a.getSliderComponent(k)){case "s":0===k.hsv[1]&&k.fromHSV(null,100,null);break;case "v":0===k.hsv[2]&&k.fromHSV(null,null,100)}a.setPad(k,b,0,0);break;case "sld":a.setSld(k,b,0)}a.dispatchFineChange(k)},onDocumentPointerMove:function(b,c,d,f,k){return function(b){var f=c._jscInstance;switch(d){case "pad":b||(b=window.event);a.setPad(f,b,k[0],k[1]);a.dispatchFineChange(f);break;case "sld":b||(b=window.event),a.setSld(f,b,k[1]),a.dispatchFineChange(f)}}},
onDocumentPointerEnd:function(b,c,d,f){return function(b){b=c._jscInstance;a.detachGroupEvents("drag");a.releaseTarget();a.dispatchChange(b)}},dispatchChange:function(b){b.valueElement&&a.isElementType(b.valueElement,"input")&&a.fireEvent(b.valueElement,"change")},dispatchFineChange:function(a){a.onFineChange&&("string"===typeof a.onFineChange?new Function(a.onFineChange):a.onFineChange).call(a)},setPad:function(b,c,d,f){c=a.getAbsPointerPos(c);d=360/(b.width-1)*(d+c.x-a._pointerOrigin.x-b.padding-
b.insetWidth);f=100-100/(b.height-1)*(f+c.y-a._pointerOrigin.y-b.padding-b.insetWidth);switch(a.getPadYComponent(b)){case "s":b.fromHSV(d,f,null,a.leaveSld);break;case "v":b.fromHSV(d,null,f,a.leaveSld)}},setSld:function(b,c,d){c=a.getAbsPointerPos(c);d=100-100/(b.height-1)*(d+c.y-a._pointerOrigin.y-b.padding-b.insetWidth);switch(a.getSliderComponent(b)){case "s":b.fromHSV(null,d,null,a.leavePad);break;case "v":b.fromHSV(null,null,d,a.leavePad)}},_vmlNS:"jsc_vml_",_vmlCSS:"jsc_vml_css_",_vmlReady:!1,
initVML:function(){if(!a._vmlReady){var b=document;b.namespaces[a._vmlNS]||b.namespaces.add(a._vmlNS,"urn:schemas-microsoft-com:vml");if(!b.styleSheets[a._vmlCSS]){var c="shape shapetype group background path formulas handles fill stroke shadow textbox textpath imagedata line polyline curve rect roundrect oval arc image".split(" ");b=b.createStyleSheet();b.owningElement.id=a._vmlCSS;for(var d=0;d<c.length;d+=1)b.addRule(a._vmlNS+"\\:"+c[d],"behavior:url(#default#VML);")}a._vmlReady=!0}},createPalette:function(){var b=
{elm:null,draw:null};if(a.isCanvasSupported){var c=document.createElement("canvas"),d=c.getContext("2d"),f=function(a,b,e){c.width=a;c.height=b;d.clearRect(0,0,c.width,c.height);a=d.createLinearGradient(0,0,c.width,0);a.addColorStop(0,"#F00");a.addColorStop(1/6,"#FF0");a.addColorStop(2/6,"#0F0");a.addColorStop(.5,"#0FF");a.addColorStop(4/6,"#00F");a.addColorStop(5/6,"#F0F");a.addColorStop(1,"#F00");d.fillStyle=a;d.fillRect(0,0,c.width,c.height);a=d.createLinearGradient(0,0,0,c.height);switch(e.toLowerCase()){case "s":a.addColorStop(0,
"rgba(255,255,255,0)");a.addColorStop(1,"rgba(255,255,255,1)");break;case "v":a.addColorStop(0,"rgba(0,0,0,0)"),a.addColorStop(1,"rgba(0,0,0,1)")}d.fillStyle=a;d.fillRect(0,0,c.width,c.height)};b.elm=c}else{a.initVML();var k=document.createElement("div");k.style.position="relative";k.style.overflow="hidden";var m=document.createElement(a._vmlNS+":fill");m.type="gradient";m.method="linear";m.angle="90";m.colors="16.67% #F0F, 33.33% #00F, 50% #0FF, 66.67% #0F0, 83.33% #FF0";var n=document.createElement(a._vmlNS+
":rect");n.style.position="absolute";n.style.left="-1px";n.style.top="-1px";n.stroked=!1;n.appendChild(m);k.appendChild(n);var l=document.createElement(a._vmlNS+":fill");l.type="gradient";l.method="linear";l.angle="180";l.opacity="0";var e=document.createElement(a._vmlNS+":rect");e.style.position="absolute";e.style.left="-1px";e.style.top="-1px";e.stroked=!1;e.appendChild(l);k.appendChild(e);f=function(a,b,c){k.style.width=a+"px";k.style.height=b+"px";n.style.width=e.style.width=a+1+"px";n.style.height=
e.style.height=b+1+"px";m.color="#F00";m.color2="#F00";switch(c.toLowerCase()){case "s":l.color=l.color2="#FFF";break;case "v":l.color=l.color2="#000"}};b.elm=k}b.draw=f;return b},createSliderGradient:function(){var b={elm:null,draw:null};if(a.isCanvasSupported){var c=document.createElement("canvas"),d=c.getContext("2d"),f=function(a,b,f,k){c.width=a;c.height=b;d.clearRect(0,0,c.width,c.height);a=d.createLinearGradient(0,0,0,c.height);a.addColorStop(0,f);a.addColorStop(1,k);d.fillStyle=a;d.fillRect(0,
0,c.width,c.height)};b.elm=c}else{a.initVML();var k=document.createElement("div");k.style.position="relative";k.style.overflow="hidden";var m=document.createElement(a._vmlNS+":fill");m.type="gradient";m.method="linear";m.angle="180";var n=document.createElement(a._vmlNS+":rect");n.style.position="absolute";n.style.left="-1px";n.style.top="-1px";n.stroked=!1;n.appendChild(m);k.appendChild(n);f=function(a,b,c,d){k.style.width=a+"px";k.style.height=b+"px";n.style.width=a+1+"px";n.style.height=b+1+"px";
m.color=c;m.color2=d};b.elm=k}b.draw=f;return b},leaveValue:1,leaveStyle:2,leavePad:4,leaveSld:8,BoxShadow:function(){var a=function(a,b,f,k,m,n){this.hShadow=a;this.vShadow=b;this.blur=f;this.spread=k;this.color=m;this.inset=!!n};a.prototype.toString=function(){var a=[Math.round(this.hShadow)+"px",Math.round(this.vShadow)+"px",Math.round(this.blur)+"px",Math.round(this.spread)+"px",this.color];this.inset&&a.push("inset");return a.join(" ")};return a}(),jscolor:function(b,c){function d(a,b,c){c=c/
100*255;if(null===a)return[c,c,c];a/=60;b/=100;var d=Math.floor(a),r=c*(1-b);a=c*(1-b*(d%2?a-d:1-(a-d)));switch(d){case 6:case 0:return[c,a,r];case 1:return[a,c,r];case 2:return[r,c,a];case 3:return[r,a,c];case 4:return[a,r,c];case 5:return[c,r,a]}}function f(){h._processParentElementsInDOM();a.picker||(a.picker={owner:null,wrap:document.createElement("div"),box:document.createElement("div"),boxS:document.createElement("div"),boxB:document.createElement("div"),pad:document.createElement("div"),padB:document.createElement("div"),
padM:document.createElement("div"),padPal:a.createPalette(),cross:document.createElement("div"),crossBY:document.createElement("div"),crossBX:document.createElement("div"),crossLY:document.createElement("div"),crossLX:document.createElement("div"),sld:document.createElement("div"),sldB:document.createElement("div"),sldM:document.createElement("div"),sldGrad:a.createSliderGradient(),sldPtrS:document.createElement("div"),sldPtrIB:document.createElement("div"),sldPtrMB:document.createElement("div"),
sldPtrOB:document.createElement("div"),btn:document.createElement("div"),btnT:document.createElement("span")},a.picker.pad.appendChild(a.picker.padPal.elm),a.picker.padB.appendChild(a.picker.pad),a.picker.cross.appendChild(a.picker.crossBY),a.picker.cross.appendChild(a.picker.crossBX),a.picker.cross.appendChild(a.picker.crossLY),a.picker.cross.appendChild(a.picker.crossLX),a.picker.padB.appendChild(a.picker.cross),a.picker.box.appendChild(a.picker.padB),a.picker.box.appendChild(a.picker.padM),a.picker.sld.appendChild(a.picker.sldGrad.elm),
a.picker.sldB.appendChild(a.picker.sld),a.picker.sldB.appendChild(a.picker.sldPtrOB),a.picker.sldPtrOB.appendChild(a.picker.sldPtrMB),a.picker.sldPtrMB.appendChild(a.picker.sldPtrIB),a.picker.sldPtrIB.appendChild(a.picker.sldPtrS),a.picker.box.appendChild(a.picker.sldB),a.picker.box.appendChild(a.picker.sldM),a.picker.btn.appendChild(a.picker.btnT),a.picker.box.appendChild(a.picker.btn),a.picker.boxB.appendChild(a.picker.box),a.picker.wrap.appendChild(a.picker.boxS),a.picker.wrap.appendChild(a.picker.boxB));
var b=a.picker,c=!!a.getSliderComponent(h),d=a.getPickerDims(h),e=2*h.pointerBorderWidth+h.pointerThickness+2*h.crossSize,f=a.getPadToSliderPadding(h),g=Math.min(h.borderRadius,Math.round(h.padding*Math.PI));b.wrap.style.clear="both";b.wrap.style.width=d[0]+2*h.borderWidth+"px";b.wrap.style.height=d[1]+2*h.borderWidth+"px";b.wrap.style.zIndex=h.zIndex;b.box.style.width=d[0]+"px";b.box.style.height=d[1]+"px";b.boxS.style.position="absolute";b.boxS.style.left="0";b.boxS.style.top="0";b.boxS.style.width=
"100%";b.boxS.style.height="100%";a.setBorderRadius(b.boxS,g+"px");b.boxB.style.position="relative";b.boxB.style.border=h.borderWidth+"px solid";b.boxB.style.borderColor=h.borderColor;b.boxB.style.background=h.backgroundColor;a.setBorderRadius(b.boxB,g+"px");b.padM.style.background=b.sldM.style.background="#FFF";a.setStyle(b.padM,"opacity","0");a.setStyle(b.sldM,"opacity","0");b.pad.style.position="relative";b.pad.style.width=h.width+"px";b.pad.style.height=h.height+"px";b.padPal.draw(h.width,h.height,
a.getPadYComponent(h));b.padB.style.position="absolute";b.padB.style.left=h.padding+"px";b.padB.style.top=h.padding+"px";b.padB.style.border=h.insetWidth+"px solid";b.padB.style.borderColor=h.insetColor;b.padM._jscInstance=h;b.padM._jscControlName="pad";b.padM.style.position="absolute";b.padM.style.left="0";b.padM.style.top="0";b.padM.style.width=h.padding+2*h.insetWidth+h.width+f/2+"px";b.padM.style.height=d[1]+"px";b.padM.style.cursor="crosshair";b.cross.style.position="absolute";b.cross.style.left=
b.cross.style.top="0";b.cross.style.width=b.cross.style.height=e+"px";b.crossBY.style.position=b.crossBX.style.position="absolute";b.crossBY.style.background=b.crossBX.style.background=h.pointerBorderColor;b.crossBY.style.width=b.crossBX.style.height=2*h.pointerBorderWidth+h.pointerThickness+"px";b.crossBY.style.height=b.crossBX.style.width=e+"px";b.crossBY.style.left=b.crossBX.style.top=Math.floor(e/2)-Math.floor(h.pointerThickness/2)-h.pointerBorderWidth+"px";b.crossBY.style.top=b.crossBX.style.left=
"0";b.crossLY.style.position=b.crossLX.style.position="absolute";b.crossLY.style.background=b.crossLX.style.background=h.pointerColor;b.crossLY.style.height=b.crossLX.style.width=e-2*h.pointerBorderWidth+"px";b.crossLY.style.width=b.crossLX.style.height=h.pointerThickness+"px";b.crossLY.style.left=b.crossLX.style.top=Math.floor(e/2)-Math.floor(h.pointerThickness/2)+"px";b.crossLY.style.top=b.crossLX.style.left=h.pointerBorderWidth+"px";b.sld.style.overflow="hidden";b.sld.style.width=h.sliderSize+
"px";b.sld.style.height=h.height+"px";b.sldGrad.draw(h.sliderSize,h.height,"#000","#000");b.sldB.style.display=c?"block":"none";b.sldB.style.position="absolute";b.sldB.style.right=h.padding+"px";b.sldB.style.top=h.padding+"px";b.sldB.style.border=h.insetWidth+"px solid";b.sldB.style.borderColor=h.insetColor;b.sldM._jscInstance=h;b.sldM._jscControlName="sld";b.sldM.style.display=c?"block":"none";b.sldM.style.position="absolute";b.sldM.style.right="0";b.sldM.style.top="0";b.sldM.style.width=h.sliderSize+
f/2+h.padding+2*h.insetWidth+"px";b.sldM.style.height=d[1]+"px";b.sldM.style.cursor="default";b.sldPtrIB.style.border=b.sldPtrOB.style.border=h.pointerBorderWidth+"px solid "+h.pointerBorderColor;b.sldPtrOB.style.position="absolute";b.sldPtrOB.style.left=-(2*h.pointerBorderWidth+h.pointerThickness)+"px";b.sldPtrOB.style.top="0";b.sldPtrMB.style.border=h.pointerThickness+"px solid "+h.pointerColor;b.sldPtrS.style.width=h.sliderSize+"px";b.sldPtrS.style.height=q+"px";b.btn.style.display=h.closable?
"block":"none";b.btn.style.position="absolute";b.btn.style.left=h.padding+"px";b.btn.style.bottom=h.padding+"px";b.btn.style.padding="0 15px";b.btn.style.height=h.buttonHeight+"px";b.btn.style.border=h.insetWidth+"px solid";(function(){var a=h.insetColor.split(/\s+/);b.btn.style.borderColor=2>a.length?a[0]:a[1]+" "+a[0]+" "+a[0]+" "+a[1]})();b.btn.style.color=h.buttonColor;b.btn.style.font="12px sans-serif";b.btn.style.textAlign="center";try{b.btn.style.cursor="pointer"}catch(y){b.btn.style.cursor=
"hand"}b.btn.onmousedown=function(){h.hide()};b.btnT.style.lineHeight=h.buttonHeight+"px";b.btnT.innerHTML="";b.btnT.appendChild(document.createTextNode(h.closeText));k();m();a.picker.owner&&a.picker.owner!==h&&a.unsetClass(a.picker.owner.targetElement,h.activeClass);a.picker.owner=h;a.isElementType(p,"body")?a.redrawPosition():a._drawPosition(h,0,0,"relative",!1);b.wrap.parentNode!=p&&p.appendChild(b.wrap);a.setClass(h.targetElement,h.activeClass)}function k(){switch(a.getPadYComponent(h)){case "s":var b=
1;break;case "v":b=2}b=Math.round((1-h.hsv[b]/100)*(h.height-1));var c=-Math.floor((2*h.pointerBorderWidth+h.pointerThickness+2*h.crossSize)/2);a.picker.cross.style.left=Math.round(h.hsv[0]/360*(h.width-1))+c+"px";a.picker.cross.style.top=b+c+"px";switch(a.getSliderComponent(h)){case "s":c=d(h.hsv[0],100,h.hsv[2]);b=d(h.hsv[0],0,h.hsv[2]);c="rgb("+Math.round(c[0])+","+Math.round(c[1])+","+Math.round(c[2])+")";a.picker.sldGrad.draw(h.sliderSize,h.height,c,"rgb("+Math.round(b[0])+","+Math.round(b[1])+
","+Math.round(b[2])+")");break;case "v":b=d(h.hsv[0],h.hsv[1],100),c="rgb("+Math.round(b[0])+","+Math.round(b[1])+","+Math.round(b[2])+")",a.picker.sldGrad.draw(h.sliderSize,h.height,c,"#000")}}function m(){var b=a.getSliderComponent(h);if(b){switch(b){case "s":var c=1;break;case "v":c=2}a.picker.sldPtrOB.style.top=Math.round((1-h.hsv[c]/100)*(h.height-1))-(2*h.pointerBorderWidth+h.pointerThickness)-Math.floor(q/2)+"px"}}function n(){return a.picker&&a.picker.owner===h}function l(){h.importColor()}
this.value=null;this.styleElement=this.valueElement=b;this.refine=this.required=!0;this.hash=!1;this.uppercase=!0;this.onFineChange=null;this.activeClass="jscolor-active";this.overwriteImportant=!1;this.minS=0;this.maxS=100;this.minV=0;this.maxV=100;this.hsv=[0,0,100];this.rgb=[255,255,255];this.width=181;this.height=101;this.showOnClick=!0;this.mode="HSV";this.position="bottom";this.smartPosition=!0;this.sliderSize=16;this.crossSize=8;this.closable=!1;this.closeText="Close";this.buttonColor="#000000";
this.buttonHeight=18;this.padding=12;this.backgroundColor="#FFFFFF";this.borderWidth=1;this.borderColor="#BBBBBB";this.borderRadius=8;this.insetWidth=1;this.insetColor="#BBBBBB";this.shadow=!0;this.shadowBlur=15;this.shadowColor="rgba(0,0,0,0.2)";this.pointerColor="#4C4C4C";this.pointerBorderColor="#FFFFFF";this.pointerBorderWidth=1;this.pointerThickness=2;this.zIndex=1E3;this.container=null;for(var e in c)c.hasOwnProperty(e)&&(this[e]=c[e]);this.hide=function(){n()&&(a.unsetClass(h.targetElement,
h.activeClass),a.picker.wrap.parentNode.removeChild(a.picker.wrap),delete a.picker.owner)};this.show=function(){f()};this.redraw=function(){n()&&f()};this.importColor=function(){this.valueElement?a.isElementType(this.valueElement,"input")?this.refine?!this.required&&/^\s*$/.test(this.valueElement.value)?(this.valueElement.value="",this.styleElement&&(this.styleElement.style.backgroundImage=this.styleElement._jscOrigStyle.backgroundImage,this.styleElement.style.backgroundColor=this.styleElement._jscOrigStyle.backgroundColor,
this.styleElement.style.color=this.styleElement._jscOrigStyle.color),this.exportColor(a.leaveValue|a.leaveStyle)):this.fromString(this.valueElement.value)||this.exportColor():this.fromString(this.valueElement.value,a.leaveValue)||(this.styleElement&&(this.styleElement.style.backgroundImage=this.styleElement._jscOrigStyle.backgroundImage,this.styleElement.style.backgroundColor=this.styleElement._jscOrigStyle.backgroundColor,this.styleElement.style.color=this.styleElement._jscOrigStyle.color),this.exportColor(a.leaveValue|
a.leaveStyle)):this.exportColor():this.exportColor()};this.exportColor=function(b){if(!(b&a.leaveValue)&&this.valueElement){var c=this.toString();this.uppercase&&(c=c.toUpperCase());this.hash&&(c="#"+c);a.isElementType(this.valueElement,"input")?this.valueElement.value=c:this.valueElement.innerHTML=c}if(!(b&a.leaveStyle)&&this.styleElement){c="#"+this.toString();var d=this.isLight()?"#000":"#FFF";this.styleElement.style.backgroundImage="none";this.styleElement.style.backgroundColor=c;this.styleElement.style.color=
d;this.overwriteImportant&&this.styleElement.setAttribute("style","background: "+c+" !important; color: "+d+" !important;")}b&a.leavePad||!n()||k();b&a.leaveSld||!n()||m()};this.fromHSV=function(a,b,c,e){if(null!==a){if(isNaN(a))return!1;a=Math.max(0,Math.min(360,a))}if(null!==b){if(isNaN(b))return!1;b=Math.max(0,Math.min(100,this.maxS,b),this.minS)}if(null!==c){if(isNaN(c))return!1;c=Math.max(0,Math.min(100,this.maxV,c),this.minV)}this.rgb=d(null===a?this.hsv[0]:this.hsv[0]=a,null===b?this.hsv[1]:
this.hsv[1]=b,null===c?this.hsv[2]:this.hsv[2]=c);this.exportColor(e)};this.fromRGB=function(a,b,c,e){if(null!==a){if(isNaN(a))return!1;a=Math.max(0,Math.min(255,a))}if(null!==b){if(isNaN(b))return!1;b=Math.max(0,Math.min(255,b))}if(null!==c){if(isNaN(c))return!1;c=Math.max(0,Math.min(255,c))}a=null===a?this.rgb[0]:a;b=null===b?this.rgb[1]:b;var f=null===c?this.rgb[2]:c;a/=255;b/=255;f/=255;var g=Math.min(Math.min(a,b),f);c=Math.max(Math.max(a,b),f);var h=c-g;0===h?a=[null,0,100*c]:(a=a===g?3+(f-
b)/h:b===g?5+(a-f)/h:1+(b-a)/h,a=[60*(6===a?0:a),h/c*100,100*c]);null!==a[0]&&(this.hsv[0]=Math.max(0,Math.min(360,a[0])));0!==a[2]&&(this.hsv[1]=null===a[1]?null:Math.max(0,this.minS,Math.min(100,this.maxS,a[1])));this.hsv[2]=null===a[2]?null:Math.max(0,this.minV,Math.min(100,this.maxV,a[2]));a=d(this.hsv[0],this.hsv[1],this.hsv[2]);this.rgb[0]=a[0];this.rgb[1]=a[1];this.rgb[2]=a[2];this.exportColor(e)};this.fromString=function(a,b){var c;if(c=a.match(/^\W*([0-9A-F]{3}([0-9A-F]{3})?)\W*$/i))return 6===
c[1].length?this.fromRGB(parseInt(c[1].substr(0,2),16),parseInt(c[1].substr(2,2),16),parseInt(c[1].substr(4,2),16),b):this.fromRGB(parseInt(c[1].charAt(0)+c[1].charAt(0),16),parseInt(c[1].charAt(1)+c[1].charAt(1),16),parseInt(c[1].charAt(2)+c[1].charAt(2),16),b),!0;if(c=a.match(/^\W*rgba?\(([^)]*)\)\W*$/i)){a=c[1].split(",");c=/^\s*(\d*)(\.\d+)?\s*$/;var d,e,f;if(3<=a.length&&(d=a[0].match(c))&&(e=a[1].match(c))&&(f=a[2].match(c)))return d=parseFloat((d[1]||"0")+(d[2]||"")),e=parseFloat((e[1]||"0")+
(e[2]||"")),f=parseFloat((f[1]||"0")+(f[2]||"")),this.fromRGB(d,e,f,b),!0}return!1};this.toString=function(){return(256|Math.round(this.rgb[0])).toString(16).substr(1)+(256|Math.round(this.rgb[1])).toString(16).substr(1)+(256|Math.round(this.rgb[2])).toString(16).substr(1)};this.toHEXString=function(){return"#"+this.toString().toUpperCase()};this.toRGBString=function(){return"rgb("+Math.round(this.rgb[0])+","+Math.round(this.rgb[1])+","+Math.round(this.rgb[2])+")"};this.isLight=function(){return 127.5<
.213*this.rgb[0]+.715*this.rgb[1]+.072*this.rgb[2]};this._processParentElementsInDOM=function(){if(!this._linkedElementsProcessed){this._linkedElementsProcessed=!0;var b=this.targetElement;do{var c=a.getStyle(b);c&&"fixed"===c.position.toLowerCase()&&(this.fixed=!0);b===this.targetElement||b._jscEventsAttached||(a.attachEvent(b,"scroll",a.onParentScroll),b._jscEventsAttached=!0)}while((b=b.parentNode)&&!a.isElementType(b,"body"))}};"string"===typeof b?(c=document.getElementById(b))?this.targetElement=
c:a.warn("Could not find target element with ID '"+b+"'"):b?this.targetElement=b:a.warn("Invalid target element: '"+b+"'");if(this.targetElement._jscLinkedInstance)a.warn("Cannot link jscolor twice to the same element. Skipping.");else{this.targetElement._jscLinkedInstance=this;this.valueElement=a.fetchElement(this.valueElement);this.styleElement=a.fetchElement(this.styleElement);var h=this,p=this.container?a.fetchElement(this.container):document.getElementsByTagName("body")[0],q=3;if(a.isElementType(this.targetElement,
"button"))if(this.targetElement.onclick){var g=this.targetElement.onclick;this.targetElement.onclick=function(a){g.call(this,a);return!1}}else this.targetElement.onclick=function(){return!1};this.valueElement&&a.isElementType(this.valueElement,"input")&&(b=function(){h.fromString(h.valueElement.value,a.leaveValue);a.dispatchFineChange(h)},a.attachEvent(this.valueElement,"keyup",b),a.attachEvent(this.valueElement,"input",b),a.attachEvent(this.valueElement,"blur",l),this.valueElement.setAttribute("autocomplete",
"off"));this.styleElement&&(this.styleElement._jscOrigStyle={backgroundImage:this.styleElement.style.backgroundImage,backgroundColor:this.styleElement.style.backgroundColor,color:this.styleElement.style.color});this.value?this.fromString(this.value)||this.exportColor():this.importColor()}}};a.jscolor.lookupClass="jscolor";a.jscolor.installByClassName=function(b){var c=document.getElementsByTagName("input"),d=document.getElementsByTagName("button");a.tryInstallOnElements(c,b);a.tryInstallOnElements(d,
b)};a.register();return a.jscolor}());onkeyup=function(a){};onkeydown=function(a){a=a||event;var b=[];b[a.keyCode]="keydown"==a.type;b[32]&&(mouseOnTimeline=!1,playAnimation(timelinePosition))};onchange=function(){saveEngine.save(!0,!1)};var init=!1,saveEngine,mobile,smallScreen,animationRunning=!1,loopAnimation=!1,animationTimer,selectedShape=-1,selectedLight=-1,settingsOpen=!1,prepTutorial=!1,capturer,scene=new THREE.Scene,camera,renderer,shapes=[],lights=[],scales=[],defaultTargets=[],keyFrames=[],borders=[];
window.onload=function(){if(mobile){var a=document.createElement("link");a.setAttribute("rel","stylesheet");a.setAttribute("type","text/css");a.setAttribute("href","style/mobile_Style.css");document.getElementsByTagName("head")[0].removeChild(document.getElementById("defaultStyle"));document.getElementsByTagName("head")[0].appendChild(a);document.getElementById("std_nav_bar").removeChild(document.getElementById("std_statusBox"));document.getElementById("std_nav_bar").removeChild(document.getElementById("nav_spacer_left"));
a=document.createElement("script");a.setAttribute("src","helperScripts/UI_helper_scripts/mobileStyle.js");document.getElementsByTagName("head")[0].removeChild(document.getElementById("newStyleJS"));document.getElementsByTagName("head")[0].appendChild(a);document.getElementById("ws_body").removeChild(document.getElementById("ws_body").children[2]);document.getElementById("ws_loadMenu").style.top="5%";document.getElementById("ws_loadMenu").style.left="calc(50% + 25px)";document.getElementById("std_timeline_popUp").children[5].style.width=
"655px";document.getElementById("std_timeline_popUp").children[5].style.marginLeft="calc(50% - 324.5px)";document.getElementById("std_timeline_popUp").children[5].children[0].style.maxWidth="345px";document.getElementById("std_timeline_popUp").children[5].children[0].style.marginLeft="calc(50% - 172.5px)"}smallScreen&&(document.getElementById("status_ver").style.display="none");saveEngine=new SaveEngine(!0,!0);stylesheetLoader(settings.userInterface.stylesheetPref);saveEngine.setLocalStorageSelectorElement("ws_loadMenu",
"Load Save",!1);saveEngine.setLocalStorageSelectorElement("localStorage_saveSelector","none",!0);saveEngine.setCloudStorageSelectorElement("signedIn_loadSelector","Load Cloud Save",!0);switch(settings.userInterface.stylesheetPref){case "normalMode":getId("settings_styleSheetSelector").selectedIndex=0;break;case "darkMode":getId("settings_styleSheetSelector").selectedIndex=1;break;case "amoledMode":getId("settings_styleSheetSelector").selectedIndex=2;break;case "memeMode":getId("settings_styleSheetSelector").selectedIndex=
3}getId("settings_mouseSensitivity").value=settings.camera.mouseSensitivity;getId("settings_zoomAmount").value=settings.camera.zoomAmount;getId("advCamera_centerX").value=settings.camera.centerPos[0];getId("advCamera_centerY").value=settings.camera.centerPos[1];getId("advCamera_centerZ").value=settings.camera.centerPos[2];getId("advCamera_focusX").value=settings.camera.focusPos[0];getId("advCamera_focusY").value=settings.camera.focusPos[1];getId("advCamera_focusZ").value=settings.camera.focusPos[2]};
var xPosition=10,yPosition=10,zPosition=10,xStart=0,yStart=0,xPosStart=xPosition,yPosStart=yPosition,xCCenter=0,yCCenter=0,zCCenter=0,xCLook=0,yCLook=0,zCLook=0,shapeCenter={x:0,y:0,z:0},shapeCenters=[],mouseDown=!1,inAnimationWindow=0,lockCamera=!0,circleCameraRotation=!1,zoom=5,zoomZ=5,MvX,MvY,Rz1,Ry1,Rz2,Ry2,zoom1,zoom1Z,zoom2,zoom2Z,zoomChange,zoomZChange,MvXv,MvYv,Rz1v,Ry1v,Rz2v,Ry2v,zoom1v,zoom1Zv,zoom2v,zoom2Zv,zoomChangev,zoomZChangev,showingLight,noLook=!1,cameraDebug=!1,tempCircleMoveShapes=
{MvX:0,MvY:0,Rz1:0,Ry1:0,Rz2:0,Ry2:0,zoom1:0,zoom1Z:0,zoom2:0,zoom2Z:0},shapesCmove=[],lastTickAnimated=0;
function start(){camera=new THREE.PerspectiveCamera(75,UIDiemsions.std_body.window_width/UIDiemsions.std_body.window_height,.1,1E3);mobile?(renderer=new THREE.WebGLRenderer({logarithmicDepthBuffer:!0}),renderer.setSize(UIDiemsions.std_body.renderer_width,UIDiemsions.std_body.renderer_height),renderer.shadowMap.enabled=!0):(renderer=new THREE.WebGLRenderer({logarithmicDepthBuffer:!0,antialias:!0}),renderer.setSize(UIDiemsions.std_body.renderer_width,UIDiemsions.std_body.renderer_height),renderer.shadowMap.enabled=
!0,renderer.shadowMapSoft=!0,renderer.shadowMap.type=THREE.PCFSoftShadowMap);document.getElementById("animationEngine_renderArea").appendChild(renderer.domElement);var a=document.getElementById("ws_loadMenu").options[document.getElementById("ws_loadMenu").selectedIndex].value;shapes=[];scales=[];keyFrames=[];borders=[];selectedLight=selectedShape=-1;toggleEditShapeOrLight(!1);saveEngine._localStorageEnable?saveEngine.localNewSave&&!prepTutorial?showPopUp("popUp_input_body","New Save","Enter Save Name",
0):saveEngine.localNewSave&&prepTutorial?(showPopUp("popUp_input_body","New Save","Enter Save Name",2),prepTutorial=!1):saveEngine.localNewSave||(scene=saveEngine.loadLocalSave(a),getId("element_Information").style.display="none",getId("currentEditing_type").style.display="none"):showPopUp("popUp_error_body","Warning","The local save engine has been disabled",-1);getId("localStorage_saveSelector").selectedIndex=saveEngine.localFileIndex;init=!0;saveEngine.forceLoadSelectUpdate();onWindowResize()}
;function showList(){var a=document.getElementById("shapesList_shapes").children[0],b=document.getElementById("shapesList_lights").children[0];a.innerHTML="";b.innerHTML="";if(mobile){for(var c=0;c<shapes.length;c++)a.innerHTML+="<li class='elementList_body' onclick='setSelectedShape("+c+")'>"+shapes[c].geometry.name+"<div style='display: block;margin-left: 5px;width: 50px; float: left;height: 50px;background-color: #"+shapes[c].material.color.getHexString()+";'</li>";for(a=0;a<lights.length;a++)b.innerHTML+=
"<li class='elementList_body' onclick='setSelectedLight("+a+")'>"+lights[a].name+"<div style='display: block;margin-left: 5px;width: 50px; float: left;height: 50px;background-color: #"+lights[a].color.getHexString()+";'</li>"}else{for(c=0;c<shapes.length;c++)a.innerHTML+="<li class='elementList_body' onclick='setSelectedShape("+c+")'>"+shapes[c].geometry.name+"<div style='display: block;margin-left: 5px;width: 20px; float: left;height: 20px;background-color: #"+shapes[c].material.color.getHexString()+
";'</li>";for(a=0;a<lights.length;a++)b.innerHTML+="<li class='elementList_body' onclick='setSelectedLight("+a+")'>"+lights[a].name+"<div style='display: block;margin-left: 5px;width: 20px; float: left;height: 20px;background-color: #"+lights[a].color.getHexString()+";'</li>"}}
function setSelectedShape(a){selectedShape=a;toggleEditShapeOrLight(!1);-1===a?(document.getElementById("element_Information").style.display="none",document.getElementById("currentEditing_type").style.display="none"):(document.getElementById("element_Information").style.display="initial",document.getElementById("currentEditing_type").style.display="initial",document.getElementById("element_color").children[0].jscolor.fromString(shapes[selectedShape].material.color.getHexString()),document.getElementById("element_border_color").children[0].jscolor.fromString(borders[selectedShape].material.color.getHexString()),
document.getElementById("position_x").value=shapes[selectedShape].position.x,document.getElementById("position_y").value=shapes[selectedShape].position.y,document.getElementById("position_z").value=shapes[selectedShape].position.z,document.getElementById("rotation_x").value=180*shapes[selectedShape].rotation.x/Math.PI,document.getElementById("rotation_y").value=180*shapes[selectedShape].rotation.y/Math.PI,document.getElementById("rotation_z").value=180*shapes[selectedShape].rotation.z/Math.PI,document.getElementById("diemsions_x").value=
scales[selectedShape][0],document.getElementById("diemsions_y").value=scales[selectedShape][1],document.getElementById("diemsions_z").value=scales[selectedShape][2],document.getElementById("borders").checked=borders[selectedShape].visible,document.getElementById("shape_castShadow").checked=shapes[selectedShape].castShadow,document.getElementById("shape_receiveShadow").checked=shapes[selectedShape].receiveShadow,shapes[selectedShape].visible?getId("element_visibility").children[0].innerHTML="Hide Element":
getId("element_visibility").children[0].innerHTML="Show Element",showMenu("menu_newShapes"))}
function setSelectedLight(a){selectedLight=a;-1===a?(document.getElementById("element_Information").style.display="none",document.getElementById("currentEditing_type").style.display="none"):(document.getElementById("element_Information").style.display="initial",document.getElementById("currentEditing_type").style.display="initial","Hemisphere light"===lights[selectedLight].name&&document.getElementById("element_border_color").children[0].jscolor.fromString(lights[selectedLight].groundColor.getHexString()),toggleEditShapeOrLight(!0),
document.getElementById("element_color").children[0].jscolor.fromString(lights[selectedLight].color.getHexString()),document.getElementById("position_x").value=lights[selectedLight].position.x,document.getElementById("position_y").value=lights[selectedLight].position.y,document.getElementById("position_z").value=lights[selectedLight].position.z,document.getElementById("intensity_slider").value=100*lights[selectedLight].intensity,document.getElementById("intensity_value").innerHTML=100*lights[selectedLight].intensity+
"",document.getElementById("light_castShadow").checked=lights[selectedLight].castShadow,"Spot Light"===lights[selectedLight].name&&lights[selectedLight].target.isObject3D()&&(document.getElementById("target_x").value=lights[selectedLight].target.position.x,document.getElementById("target_y").value=lights[selectedLight].target.position.y,document.getElementById("target_z").value=lights[selectedLight].target.position.z),lights[selectedLight].visible?getId("element_visibility").children[0].innerHTML=
"Hide Element":getId("element_visibility").children[0].innerHTML="Show Element",showMenu("menu_newShapes"))}function hideAll(){}function shapeMenu(){document.getElementById("shapeMenu").style.display="inherit"}function borderVisibility(){document.getElementById("borders").checked?(borders[selectedShape].visible=!0,document.getElementById("element_border_color").style.display="inherit"):(borders[selectedShape].visible=!1,document.getElementById("element_border_color").style.display="none")}
function toggleEditShapeOrLight(a){(showingLight=a)?(getId("currentEditing_type").innerHTML="Edit Current Light",getId("currentEditing_dimensions").style.display="none",getId("currentEditing_intensity").style.display="inherit",getId("currentEditing_rotation").style.display="none",getId("currentEditing_borders").style.display="none",getId("currentEditing_shape_shadows").style.display="none",getId("default_target_position").style.display="none","Hemisphere light"===lights[selectedLight].name?(getId("element_border_color").style.display=
"inherit",getId("currentEditing_positions").style.display="inherit",getId("currentEditing_spotlight_parameters").style.display="none"):"Ambient light"===lights[selectedLight].name?(getId("currentEditing_positions").style.display="none",getId("element_border_color").style.display="none",getId("currentEditing_spotlight_parameters").style.display="none"):"Spot light"===lights[selectedLight].name?(getId("currentEditing_positions").style.display="inherit",getId("element_border_color").style.display="none",
getId("currentEditing_spotlight_parameters").style.display="inherit",setTargetList()):(getId("currentEditing_positions").style.display="inherit",getId("element_border_color").style.display="none",getId("currentEditing_spotlight_parameters").style.display="none")):(getId("currentEditing_type").innerHTML="Edit Current Shape",getId("currentEditing_dimensions").style.display="inherit",getId("currentEditing_intensity").style.display="none",getId("currentEditing_rotation").style.display="inherit",getId("currentEditing_positions").style.display=
"inherit",getId("currentEditing_borders").style.display="inherit",getId("currentEditing_spotlight_parameters").style.display="none",getId("currentEditing_shape_shadows").style.display="inherit",getId("default_target_position").style.display="none",0<borders.length?!0===document.getElementById("borders").checked?getId("element_border_color").style.display="inherit":getId("element_border_color").style.display="none":getId("element_border_color").style.display="inherit")};var SaveEngine=function(a,b){this._localStorageEnable=a;this._cloudStorageEnable=b;this.localStore=new LocalStore;this.cloudStorage=new CloudStorage;this.legacySupport=this.firstRun=this.localNewSave=!1;this.localFileName="";this.localFileID="init";this.localFileIndex=0;this.localStorageUpdateList=[[],[]];this.cloudStorageUpdateList=[[],[]];this.localSaveIdList=[];this.localSaveFriendlyNamesList=[];this.cloudSaveIdList=[];this.cloudSaveFriendlyNamesList=[];this.stagedLights=[];this.stagedShapes=[];
this.stagedKeyframes=[];this.stagedScales=[];this.stagedBorders=[];this.stagedDefaultTargets=[];this.stagedScene=[];this.stagedSettings=[];this.loadSettings();this.firstRun&&(this._generateSessionId(),this.localStore.saveToStorage(settings.sessionId,this.localSaveIdList),this.localStore.saveToStorage("settings",this.stagedSettings));this.loadSaveList();this._localStorageEnable&&(getId("settings_localStorage").style.display="inherit");this._cloudStorageEnable&&(getId("settings_cloudStorage").style.display=
"inherit")};SaveEngine.prototype._generateFileId=function(){this.localFileID=Base64.encode(this.localFileName+"-"+settings.saveNumber)};SaveEngine.prototype._generateSessionId=function(){settings.sessionId=Base64.encode(navigator.appCodeName+navigator.appName+navigator.platform)};SaveEngine.prototype.loadSettings=function(){this.localStore.exists("settings")?this.stagedSettings=this.localStore.getFromStorage("settings"):(this.firstRun=!0,settings.setToDefault(),this.stagedSettings=settings);settings.updateSettings(this.stagedSettings)};
SaveEngine.prototype.loadSaveList=function(){this.localStore.exists(settings.sessionId)&&(this.localSaveIdList=this.localStore.getFromStorage(settings.sessionId));for(var a=0;a<this.localSaveIdList.length;a++){var b=!1;this.localStore.exists(this.localSaveIdList[a])||(this.localSaveIdList.splice(a,1),a--,b=!0);b||this.legacySupport||this.localSaveFriendlyNamesList.push(this.localStore.getFromStorage(this.localSaveIdList[a]))}this.localStore.saveToStorage(settings.sessionId,this.localSaveIdList)};
SaveEngine.prototype.loadLocalSave=function(a){if(this._localStorageEnable&&this.localStore.exists(a)){this.localFileID=a;this.localFileName=this.localStore.getFromStorage(a);for(a=0;a<this.localSaveIdList.length;a++)this.localSaveIdList[a]===this.localFileID&&(this.localFileIndex=a);this.stagedScene=this.localStore.getFromStorage(this.getKeyName("scene"));this.stagedScene=conversion.convertJSONToScene(this.stagedScene);a=conversion.breakoutScene(this.stagedScene);this.stagedShapes=a[0];this.stagedScales=
a[1];this.stagedBorders=a[2];this.stagedLights=a[3];this.stagedDefaultTargets=a[5];this.stagedScene=a[4];this.stagedScene.background||(this.stagedScene.background=new THREE.Color("#000000"));keyFrames=this.stagedKeyframes=this.localStore.getFromStorage(this.getKeyName("keyframes"));shapes=this.stagedShapes;scales=this.stagedScales;lights=this.stagedLights;borders=this.stagedBorders;defaultTargets=this.stagedDefaultTargets;updateTimeline();return this.stagedScene}};
SaveEngine.prototype.downloadCloudSave=function(a){"default"!==a&&this._cloudStorageEnable&&saveEngine.cloudStorage.userSignedIn&&(this.cloudStorage.downloadSave(a),getId("signedIn_loadSelector").selectedIndex=0)};
SaveEngine.prototype.createNewLocalSave=function(a){if(this._localStorageEnable&&this.localNewSave){this.localFileName=a;this._generateFileId();this.localStore.saveToStorage(this.localFileID,this.localFileName);this.incrementSaveNumber();this.stagedScene=new THREE.Scene;this.stagedScene.background=new THREE.Color("#000000");this.localStore.saveToStorage(this.getKeyName("scene"),this.stagedScene);this.localStore.saveToStorage(this.getKeyName("keyframes"),this.stagedKeyframes);this.addNewSave(this.localFileID);
this.localNewSave=!1;for(a=0;a<this.localStorageUpdateList[0].length;a++)this.setLocalStorageSelectorElement(this.localStorageUpdateList[0][a],this.localStorageUpdateList[1][a],!1);if(saveEngine.cloudStorage.userSignedIn)for(a=0;a<this.cloudStorageUpdateList[0].length;a++)this.setCloudStorageSelectorElement(this.cloudStorageUpdateList[0][a],this.cloudStorageUpdateList[1][a],!1);return this.loadLocalSave(this.localFileID)}};
SaveEngine.prototype.save=function(a,b){this.stagedSettings=settings;this.stagedScene=scene;this.stagedKeyframes=keyFrames;a&&this._localStorageEnable&&(this.localStore.saveToStorage("settings",this.stagedSettings),this.localStore.saveToStorage(this.getKeyName("scene"),this.stagedScene),this.localStore.saveToStorage(this.getKeyName("keyframes"),this.stagedKeyframes));b&&this._cloudStorageEnable&&this.cloudStorage.userSignedIn&&this.cloudStorage.saveToCloud(this.localFileName,this.localFileID,this.stagedKeyframes,
this.stagedScene,this.stagedSettings)};
SaveEngine.prototype.deleteLocalSave=function(a){if(this._localStorageEnable){var b=this.localFileID;this.localFileID=a;var c=this.localSaveIdList.findIndex(function(b){return b===a});this.localSaveIdList.splice(c,1);this.localSaveFriendlyNamesList.splice(c,1);this.localStore.saveToStorage(settings.sessionId,this.localSaveIdList);this.localStore.deleteFromStorage(this.getKeyName(scene));this.localStore.deleteFromStorage(this.getKeyName(keyFrames));if(b===a)location.reload();else{this.localFileID=
b;for(b=0;b<this.localStorageUpdateList[0].length;b++)this.setLocalStorageSelectorElement(this.localStorageUpdateList[0][b],this.localStorageUpdateList[1][b],!1);if(saveEngine.cloudStorage.userSignedIn)for(b=0;b<this.cloudStorageUpdateList[0].length;b++)this.setCloudStorageSelectorElement(this.cloudStorageUpdateList[0][b],this.cloudStorageUpdateList[1][b],!1)}}};SaveEngine.prototype.deleteCloudSave=function(a){this._cloudStorageEnable&&this.cloudStorage.deleteCloudSave(a)};
SaveEngine.prototype.setLocalStorageSelectorElement=function(a,b,c){var d=document.getElementById(a);d.innerHTML="";"none"!==b&&(d.innerHTML+=" <option> "+b+"</option>");for(var f=0;f<this.localSaveIdList.length;f++){var k=this.localSaveIdList[f];var m=this.localSaveFriendlyNamesList[f];d.innerHTML+=" <option value="+k+"> "+m+"</option>"}c&&(this.localStorageUpdateList[0].push(a),this.localStorageUpdateList[1].push(b))};
SaveEngine.prototype.setCloudStorageSelectorElement=function(a,b,c){if(this._cloudStorageEnable){var d=document.getElementById(a);d.innerHTML="";"none"!==b&&(d.innerHTML+=" <option value='default'> "+b+"</option>");if(saveEngine.cloudStorage.userSignedIn)for(var f=0;f<this.cloudSaveIdList.length;f++){var k=this.cloudSaveIdList[f];var m=this.cloudSaveFriendlyNamesList[f];d.innerHTML+=" <option value="+k+"> "+m+"</option>"}c&&(this.cloudStorageUpdateList[0].push(a),this.cloudStorageUpdateList[1].push(b))}};
SaveEngine.prototype.forceLoadSelectUpdate=function(){for(var a=0;a<this.localStorageUpdateList[0].length;a++)this.setLocalStorageSelectorElement(this.localStorageUpdateList[0][a],this.localStorageUpdateList[1][a],!1);if(this.cloudStorage.userSignedIn)for(a=0;a<this.cloudStorageUpdateList[0].length;a++)this.setCloudStorageSelectorElement(this.cloudStorageUpdateList[0][a],this.cloudStorageUpdateList[1][a],!1)};
SaveEngine.prototype.getKeyName=function(a){"init"===this.localFileID&&this._generateFileId();return a+=":"+this.localFileID};SaveEngine.prototype.addNewSave=function(a){this.localSaveIdList.push(a);this.localSaveFriendlyNamesList.push(this.localStore.getFromStorage(a));this.localStore.saveToStorage(settings.sessionId,this.localSaveIdList)};
SaveEngine.prototype.incrementSaveNumber=function(){var a=parseInt(settings.saveNumber);a++;1E3<=a?settings.saveNumber=a.toString():100<=a?settings.saveNumber="0"+a.toString():10<=a?settings.saveNumber="00"+a.toString():1<=a&&(settings.saveNumber="000"+a.toString());this.localStore.saveToStorage("settings",settings)};
$jscomp.global.Object.defineProperties(SaveEngine.prototype,{setLocalStorageEnable:{configurable:!0,enumerable:!0,set:function(a){(this._localStorageEnable=a)?getId("settings_localStorage").style.display="inherit":getId("settings_localStorage").style.display="none"}},setCloudStorageEnable:{configurable:!0,enumerable:!0,set:function(a){(this._cloudStorageEnable=a)?getId("settings_cloudStorage").style.display="inherit":getId("settings_cloudStorage").style.display="none"}}});(function(a,b){"object"===typeof exports&&"undefined"!==typeof module?module.exports=b(a):"function"===typeof define&&define.amd?define(b):b(a)})("undefined"!==typeof self?self:"undefined"!==typeof window?window:"undefined"!==typeof global?global:this,function(a){a=a||{};var b=a.Base64;if("undefined"!==typeof module&&module.exports)try{var c=eval("require('buffer').Buffer")}catch(y){c=void 0}var d=function(a){for(var b={},c=0,d=a.length;c<d;c++)b[a.charAt(c)]=c;return b}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),
f=String.fromCharCode,k=function(a){if(2>a.length){var b=a.charCodeAt(0);return 128>b?a:2048>b?f(192|b>>>6)+f(128|b&63):f(224|b>>>12&15)+f(128|b>>>6&63)+f(128|b&63)}b=65536+1024*(a.charCodeAt(0)-55296)+(a.charCodeAt(1)-56320);return f(240|b>>>18&7)+f(128|b>>>12&63)+f(128|b>>>6&63)+f(128|b&63)},m=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,n=function(a){return a.replace(m,k)},l=function(a){var b=[0,2,1][a.length%3];a=a.charCodeAt(0)<<16|(1<a.length?a.charCodeAt(1):0)<<8|(2<a.length?a.charCodeAt(2):
0);return["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(a>>>18),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(a>>>12&63),2<=b?"=":"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(a>>>6&63),1<=b?"=":"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(a&63)].join("")},e=a.btoa?function(b){return a.btoa(b)}:function(a){return a.replace(/[\s\S]{1,3}/g,l)},h=c?c.from&&Uint8Array&&c.from!==Uint8Array.from?
function(a){return(a.constructor===c.constructor?a:c.from(a)).toString("base64")}:function(a){return(a.constructor===c.constructor?a:new c(a)).toString("base64")}:function(a){return e(n(a))},p=function(a,b){return b?h(String(a)).replace(/[+\/]/g,function(a){return"+"==a?"-":"_"}).replace(/=/g,""):h(String(a))},q=/[\u00c0-\u00df][\u0080-\u00bf]|[\u00e0-\u00ef][\u0080-\u00bf]{2}|[\u00f0-\u00f7][\u0080-\u00bf]{3}/g,g=function(a){switch(a.length){case 4:return a=((7&a.charCodeAt(0))<<18|(63&a.charCodeAt(1))<<
12|(63&a.charCodeAt(2))<<6|63&a.charCodeAt(3))-65536,f((a>>>10)+55296)+f((a&1023)+56320);case 3:return f((15&a.charCodeAt(0))<<12|(63&a.charCodeAt(1))<<6|63&a.charCodeAt(2));default:return f((31&a.charCodeAt(0))<<6|63&a.charCodeAt(1))}},r=function(a){return a.replace(q,g)},w=function(a){var b=a.length,c=b%4;a=(0<b?d[a.charAt(0)]<<18:0)|(1<b?d[a.charAt(1)]<<12:0)|(2<b?d[a.charAt(2)]<<6:0)|(3<b?d[a.charAt(3)]:0);a=[f(a>>>16),f(a>>>8&255),f(a&255)];a.length-=[0,0,2,1][c];return a.join("")},v=a.atob?
function(b){return a.atob(b)}:function(a){return a.replace(/\S{1,4}/g,w)},x=c?c.from&&Uint8Array&&c.from!==Uint8Array.from?function(a){return(a.constructor===c.constructor?a:c.from(a,"base64")).toString()}:function(a){return(a.constructor===c.constructor?a:new c(a,"base64")).toString()}:function(a){return r(v(a))},t=function(a){return x(String(a).replace(/[-_]/g,function(a){return"-"==a?"+":"/"}).replace(/[^A-Za-z0-9\+\/]/g,""))};a.Base64={VERSION:"2.5.1",atob:function(a){return v(String(a).replace(/[^A-Za-z0-9\+\/]/g,
""))},btoa:e,fromBase64:t,toBase64:p,utob:n,encode:p,encodeURI:function(a){return p(a,!0)},btou:r,decode:t,noConflict:function(){var c=a.Base64;a.Base64=b;return c},__buffer__:c};if("function"===typeof Object.defineProperty){var u=function(a){return{value:a,enumerable:!1,writable:!0,configurable:!0}};a.Base64.extendString=function(){Object.defineProperty(String.prototype,"fromBase64",u(function(){return t(this)}));Object.defineProperty(String.prototype,"toBase64",u(function(a){return p(this,a)}));
Object.defineProperty(String.prototype,"toBase64URI",u(function(){return p(this,!0)}))}}a.Meteor&&(Base64=a.Base64);"undefined"!==typeof module&&module.exports?module.exports.Base64=a.Base64:"function"===typeof define&&define.amd&&define([],function(){return a.Base64});return{Base64:a.Base64}});var firebaseConfig={apiKey:"AIzaSyDbwUcLJqhpSwhET7bL54mRUd28FfZ9x_A",authDomain:"monarchanimation-cloudstorage.firebaseapp.com",databaseURL:"https://monarchanimation-cloudstorage.firebaseio.com",projectId:"monarchanimation-cloudstorage",storageBucket:"monarchanimation-cloudstorage.appspot.com",messagingSenderId:"5911128418",appId:"1:5911128418:web:a62eabfd3b182b60"};firebase.initializeApp(firebaseConfig);
firebase.auth().onAuthStateChanged(function(a){try{a?(console.log("Signed In"),saveEngine.cloudStorage.userSignedIn=!0,saveEngine.cloudStorage.userName=a.email,saveEngine.cloudStorage.userUID=a.uid,saveEngine.cloudStorage.generateUserData(),saveEngine.cloudStorage.getUserData(),saveEngine.cloudSaveIdList=this.downloadedFileIDs,document.getElementById("account_sub_signedIn").style.display="inherit",document.getElementById("account_sub_signedOut").style.display="none"):(console.log("Signed Out"),saveEngine.cloudStorage.userSignedIn=
!1,document.getElementById("account_sub_signedOut").style.display="inherit",document.getElementById("account_sub_signedIn").style.display="none")}catch(b){console.log("error")}});var CloudStorage=function(){this.userSignedIn=!1;this.userUID=this.userName="";this.firestore={};this.saveDataRef=this.userDataRef="";this.newUser=!1;this.downloadedFileIDs=[];this.downloadedSettings={};this.firestore=firebase.firestore();this.downloadData={name:"default",keyframes:"default",scene:"default"}};
CloudStorage.prototype.generateUserData=function(){this.constructor.userSignedIn&&this.newUser&&(this.userDataRef=this.firestore.collection("userData").doc(saveEngine.cloudStorage.userUID),this.saveDataRef=this.firestore.collection("saveData").doc("data").collection(saveEngine.cloudStorage.userUID),this.userDataRef.set({fileIDs:JSON.stringify([]),settings:JSON.stringify(saveEngine.stagedSettings)}),this.newUser=!1)};
CloudStorage.prototype.getUserData=function(){this.userDataRef=this.firestore.collection("userData").doc(saveEngine.cloudStorage.userUID);this.saveDataRef=this.firestore.collection("saveData").doc("data").collection(saveEngine.cloudStorage.userUID);this.userDataRef.get().then(function(a){if(a.exists){saveEngine.cloudStorage.downloadedFileIDs=JSON.parse(a.data().fileIDs);saveEngine.cloudStorage.downloadedSettings=JSON.parse(a.data().settings);console.log(JSON.parse(a.data().fileIDs));for(a={$jscomp$loop$prop$i$22:0};a.$jscomp$loop$prop$i$22<
saveEngine.cloudStorage.downloadedFileIDs.length;a={$jscomp$loop$prop$i$22:a.$jscomp$loop$prop$i$22},a.$jscomp$loop$prop$i$22++)saveEngine.cloudStorage.saveDataRef.doc(saveEngine.cloudStorage.downloadedFileIDs[a.$jscomp$loop$prop$i$22]).get().then(function(a){return function(b){b.exists?saveEngine.cloudSaveFriendlyNamesList.push(b.data().name):(saveEngine.cloudStorage.downloadedFileIDs.splice(a.$jscomp$loop$prop$i$22,1),a.$jscomp$loop$prop$i$22--)}}(a));saveEngine.cloudSaveIdList=saveEngine.cloudStorage.downloadedFileIDs}})};
CloudStorage.prototype.createNewUser=function(a,b){showPopUp("popUp_confirm_body","Confirm Account Creation","Email: "+a,3);saveEngine.cloudStorage.userName=a;saveEngine.cloudStorage.userUID=Base64.encode(b);this.newUser=!0};CloudStorage.prototype.signIn=function(a,b){firebase.auth().signInWithEmailAndPassword(a,b).catch(function(a){console.log(a)})};CloudStorage.prototype.signOut=function(){showPopUp("popUp_confirm_body","Confirm","Do you want to sign out?",4)};
CloudStorage.prototype.saveToCloud=function(a,b,c,d,f){if(saveEngine.cloudStorage.userSignedIn){a={name:a,keyframes:JSON.stringify(c),scene:JSON.stringify(d)};c=!0;for(d=0;d<this.downloadedFileIDs.length;d++)this.downloadedFileIDs[d]===b&&(c=!1);c&&this.downloadedFileIDs.push(b);this.userDataRef.set({fileIDs:JSON.stringify(this.downloadedFileIDs),settings:JSON.stringify(f)},{merge:!0});this.saveDataRef.doc(b).set(a,{merge:!0})}else return-5};
CloudStorage.prototype.downloadSave=function(a){this.saveDataRef.doc(a).get().then(function(b){if(b.exists){saveEngine.cloudStorage.downloadData=b.data();saveEngine.stagedScene=conversion.convertJSONToScene(JSON.parse(b.data().scene));saveEngine.stagedKeyframes=JSON.parse(b.data().keyframes);saveEngine.localFileName=b.data().name;saveEngine.localFileID=a;saveEngine.localStore.saveToStorage(saveEngine.localFileID,saveEngine.localFileName);saveEngine.localStore.saveToStorage(saveEngine.getKeyName("scene"),
saveEngine.stagedScene);saveEngine.localStore.saveToStorage(saveEngine.getKeyName("keyframes"),saveEngine.stagedKeyframes);b=!1;for(var c=0;c<saveEngine.localSaveIdList.length;c++)saveEngine.localSaveIdList[c]===a&&(b=!0);b||saveEngine.addNewSave(saveEngine.localFileID);scene=saveEngine.loadLocalSave(a)}else console.log("save not found")})};
CloudStorage.prototype.deleteCloudSave=function(a){for(var b=0;b<this.downloadedFileIDs.length;b++)this.downloadedFileIDs[b]===a&&this.downloadedFileIDs.splice(b,1);this.saveDataRef.doc(a).delete();this.userDataRef.set({fileIDs:JSON.stringify(this.downloadedFileIDs)},{merge:!0});saveEngine.cloudSaveIdList=this.downloadedFileIDs};var lastLoadedShape,conversion=function(){};
conversion.isShape=function(a){try{return"BoxGeometry"===a.geometry.type||"ConeGeometry"===a.geometry.type||"CylinderGeometry"===a.geometry.type||"Geometry"===a.geometry.type||"DodecahedronGeometry"===a.geometry.type||"IcosahedronGeometry"===a.geometry.type||"OctahedronGeometry"===a.geometry.type||"TetrahedronGeometry"===a.geometry.type||"SphereGeometry"===a.geometry.type||"TorusGeometry"===a.geometry.type||"TextGeometry"===a.geometry.type?(lastLoadedShape=a,!0):!1}catch(b){return!1}};
conversion.isLight=function(a){try{return"PointLight"===a.type||"AmbientLight"===a.type||"DirectionalLight"===a.type||"SpotLight"===a.type||"HemisphereLight"===a.type?!0:!1}catch(b){return!1}};
conversion.addBorder=function(a){var b=new THREE.EdgesGeometry(lastLoadedShape.geometry);b=new THREE.LineSegments(b,new THREE.LineBasicMaterial({color:a.material.color}));b.visible=a.visible;b.position.x=lastLoadedShape.position.x;b.position.y=lastLoadedShape.position.y;b.position.z=lastLoadedShape.position.z;b.scale.x=lastLoadedShape.scale.x;b.scale.y=lastLoadedShape.scale.y;b.scale.z=lastLoadedShape.scale.z;b.rotation.x=lastLoadedShape.rotation.x;b.rotation.y=lastLoadedShape.rotation.y;b.rotation.z=
lastLoadedShape.rotation.z;lastLoadedShape=null;return b};conversion.isBoarder=function(a){try{return"LineSegments"===a.type}catch(b){return!1}};conversion.convertJSONToScene=function(a){if("Scene"===a.object.type)return(new THREE.ObjectLoader).parse(a)};conversion.toRenderableArr=function(a,b,c){};
conversion.breakoutScene=function(a){var b=[[],[],[],[],Object,[]];if(void 0!==a.children)for(var c=0;c<a.children.length;c++)if(this.isShape(a.children[c])){if(isNaN(a.children[c].rotation._x)||isNaN(a.children[c].rotation._y)||isNaN(a.children[c].rotation._z))a.children[c].rotation.x=0,a.children[c].rotation.y=0,a.children[c].rotation.z=0;b[0].push(a.children[c]);b[1].push([a.children[c].scale.x,a.children[c].scale.y,a.children[c].scale.z])}else this.isBoarder(a.children[c])?(a.children[c]=this.addBorder(a.children[c]),
b[2].push(a.children[c])):this.isLight(a.children[c])?b[3].push(a.children[c]):a.children[c].isObject3D&&b[5].push(a.children[c]);b[4]=a;console.log(b);return b};
conversion.toSavableArr=function(a,b){var c=[];if("lights"===b)for(b=0;b<a.length;b++)c.push({type:a[b].type,positionX:a[b].position.x,positionY:a[b].position.y,positionZ:a[b].position.z,r:a[b].color.r,g:a[b].color.g,b:a[b].color.b,intensity:a[b].intensity}),"Hemisphere light"===a[b].name&&(c[b]+={r2:a[b].groundColor.r,g2:a[b].groundColor.g,b2:a[b].groundColor.b});else if("shapes"===b)for(b=0;b<a[0].length;b++)c.push({type:a[0][b].geometry.type,positionX:a[0][b].position.x,positionY:a[0][b].position.y,
positionZ:a[0][b].position.z,r:a[0][b].material.color.r,g:a[0][b].material.color.g,b:a[0][b].material.color.b,borders:a[1][b].visible,borderR:a[1][b].material.color.r,borderG:a[1][b].material.color.g,borderB:a[1][b].material.color.b});else c=a;console.log(c);return c};var LocalStore=function(){};LocalStore.prototype.exists=function(a){return null!==localStorage.getItem(a)};LocalStore.prototype.getFromStorage=function(a){return JSON.parse(localStorage.getItem(a))};LocalStore.prototype.loadScene=function(a){var b=new THREE.ObjectLoader;a=this.getFromStorage(a);return a=b.parse(a)};LocalStore.prototype.deleteFromStorage=function(a){localStorage.removeItem(a)};
LocalStore.prototype.saveToStorage=function(a,b){localStorage.setItem(a,JSON.stringify(b));console.log("Saved: "+a)};function scenePosition(a,b){scene.position[a]=Number(b)}function sceneScale(a,b){scene.scale[a]=Number(b)}function sceneBackground(a){scene.background=new THREE.Color(a)}function sceneRotation(a,b){scene.rotation[a]=Number(b)*Math.PI/180}window.addEventListener("resize",onWindowResize,!1);
function onWindowResize(){init&&(renderer.setSize(UIDiemsions.std_body.renderer_width,UIDiemsions.std_body.renderer_height),camera.aspect=UIDiemsions.std_body.renderer_width/UIDiemsions.std_body.renderer_height,camera.updateProjectionMatrix(),updateTimeline())};var settings={version:"1.4.0 rev 0b",saveNumber:"0000",sessionId:"sessionId-"+this.saveNumber,camera:{mouseSensitivity:0,zoomAmount:0,centerPos:[0,0,0],focusPos:[0,0,0]},userInterface:{stylesheetPref:"",usingCustomStyle:!1,customJSPath:"",customCSSPath:""},setToDefault:function(){this.camera.mouseSensitivity=1;this.camera.zoomAmount=1.5;this.camera.centerPos=[0,0,0];this.camera.focusPos=[0,0,0];this.userInterface.stylesheetPref="darkMode";this.saveNumber="0000";this.sessionId="sessionId-"+this.saveNumber},
updateSettings:function(a){if("resetAll"===a)this.setToDefault();else{if(null===a.camera||void 0===a.camera)a.camera={mouseSensitivity:a.mouseSensitivity,zoomAmount:a.zoomAmount,centerPos:[0,0,0],focusPos:[0,0,0]};null==a.userInterface&&(a.userInterface={stylesheetPref:"darkMode",usingCustomStyle:!1,customJSPath:"",customCSSPath:""});null==(a.saveNumber||a.sessionId)&&(a.saveNumber="0000",a.sessionId="sessionId-"+a.saveNumber);this.camera=a.camera;this.saveNumber=a.saveNumber;this.sessionId=a.sessionId;
this.userInterface.stylesheetPref=a.userInterface.stylesheetPref;a.userInterface.usingCustomStyle&&(this.userInterface.customJSPath=a.userInterface.customJSPath,this.userInterface.customCSSPath=a.userInterface.customCSSPath,console.log("ERROR: Custom style failed to load. Defaulting to dark mode."),this.userInterface.stylesheetPref="darkMode")}}};var usingTutorial=!1,tutorialPopUp=document.getElementById("std_tutorial_popUp");function launchTutorial(){tutorialPopUp||(tutorialPopUp=document.getElementById("std_tutorial_popUp"));usingTutorial=!0;addfortutorial("start")}function moveArrow(a,b){document.getElementById("tutorial_arrow").style.left=a.toString()+"px";document.getElementById("tutorial_arrow").style.top=b.toString()+"px"}var tutorialnum=0;
function addfortutorial(a){tutorialnum++;switch(tutorialnum){case 1:"start"==a&&tutorialMovement(120,-100,"The assets menu gives you access to all of the elements like lighing and shapes click this button to access it.",0);break;case 2:"animation_element_menu"==a?tutorialMovement(200,30,"To create a shape, click Create Shape",0):tutorialnum--;break;case 3:"new_shape"==a?tutorialMovement(150,410,"Now click on the shape you want. Once you create it, scroll down to the Diementions options and change the x dimention",
0):tutorialnum--;break;case 4:"dimenX"==a?tutorialMovement(200,220,"Now press TAB and change the next value",0):tutorialnum--;break;case 5:"dimenY"==a?tutorialMovement(200,220,"Now create a light so that you can see the shape. Scroll all the way up in the menu and follow the arrow.",0):tutorialnum--;break;case 6:"light_menu"==a?tutorialMovement(50,-100,"This is the light editor. You can change the intensity and position of most lights. Some lights have specific settings. There is also a shapes editor. To get there, click on the assets list button.",
0):tutorialnum--;break;case 7:"shape_list"==a?tutorialMovement(270,10,"Here you can find a list of all assets in the scene, click on the shape to edit it.",0):tutorialnum--;break;case 8:"shape_menu"==a?tutorialMovement(120,430,"Now you can make an animation. To do so, add a keyframe by clicking on the keyframe button.",!1):tutorialnum--;break;case 9:"add_frame"==a?tutorialMovement(120,window.innerHeight-125,"Now change the X DIMENTION of the shape",0):tutorialnum--;break;case 10:"dimenX"==a?tutorialMovement(120,
430,"Now add Another Keyframe",0):tutorialnum--;break;case 11:"add_frame"==a?tutorialMovement(300,window.innerHeight-245,"Now you have an animation set up. Press the play button to play the animation",0):tutorialnum--;break;case 12:"play"==a?tutorialMovement(370,window.innerHeight-245,"You can also pause an animation by pressing the play button again. You can also loop the animation. Click the button to the right of the play button to loop the animation to do so.",0):tutorialnum--;break;case 13:"loop"==
a?tutorialMovement(190,window.innerHeight-245,"Now if you want to delete a keyframe, you can do so. Click Continue and follow the arrow to delete the last keyframe",0):tutorialnum--;break;case 14:"remove_frame"==a&&tutorialMovement(120,window.innerHeight-245,"You can also hide the shape. Go back to the shapes options menu at the left, scroll all the way down, and click on HIDE ELEMENT",0);break;case 15:"hide_shape"==a&&tutorialMovement(1180,-100,"You are now done with the tutorial. To view our advanced features, go to settings.",
0);break;case 16:"setting_menu"==a?tutorialMovement(1180,-100,"Here you will find advanced and saving options. A thorough list and explanation of all buttons can be seen at the bottom.",0):tutorialnum--}}
function tutorialMovement(a,b,c,d){usingTutorial&&(document.getElementById("tutorial_arrow").style.display="block",d?tutorialPopUp.children[2].children[0].setAttribute("onclick","exitTutorial();"):tutorialPopUp.children[2].children[0].setAttribute("onclick","hideTutorialPopup();"),moveArrow(a,b),showTutorialPopup(c))}
function showTutorialPopup(a){usingTutorial&&(tutorialPopUp||(tutorialPopUp=document.getElementById("std_tutorial_popUp")),tutorialPopUp.children[1].innerHTML=a,tutorialPopUp.style.display="block",tutorialPopUp.classList.add("tutorial_popUp_show"))}function exitTutorial(){usingTutorial=!1;moveArrow(0,0);document.getElementById("tutorial_arrow").style.display="none";hideTutorialPopup()}
function hideTutorialPopup(){tutorialPopUp||(tutorialPopUp=document.getElementById("std_tutorial_popUp"));tutorialPopUp.style.display="none";tutorialPopUp.classList.remove("tutorial_popUp_show");tutorialPopUp.children[2].children[0].setAttribute("onclick","")};
