var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};
$jscomp.polyfill=function(a,b,c,g){if(b){c=$jscomp.global;a=a.split(".");for(g=0;g<a.length-1;g++){var f=a[g];f in c||(c[f]={});c=c[f]}a=a[a.length-1];g=c[a];b=b(g);b!=g&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};$jscomp.polyfill("Object.is",function(a){return a?a:function(a,c){return a===c?0!==a||1/a===1/c:a!==a&&c!==c}},"es6","es3");
$jscomp.polyfill("Array.prototype.includes",function(a){return a?a:function(a,c){var b=this;b instanceof String&&(b=String(b));var f=b.length;c=c||0;for(0>c&&(c=Math.max(c+f,0));c<f;c++){var h=b[c];if(h===a||Object.is(h,a))return!0}return!1}},"es7","es3");
$jscomp.checkStringArgs=function(a,b,c){if(null==a)throw new TypeError("The 'this' value for String.prototype."+c+" must not be null or undefined");if(b instanceof RegExp)throw new TypeError("First argument to String.prototype."+c+" must not be a regular expression");return a+""};$jscomp.polyfill("String.prototype.includes",function(a){return a?a:function(a,c){return-1!==$jscomp.checkStringArgs(this,a,"includes").indexOf(a,c||0)}},"es6","es3");
$jscomp.findInternal=function(a,b,c){a instanceof String&&(a=String(a));for(var g=a.length,f=0;f<g;f++){var h=a[f];if(b.call(c,h,f,a))return{i:f,v:h}}return{i:-1,v:void 0}};$jscomp.polyfill("Array.prototype.findIndex",function(a){return a?a:function(a,c){return $jscomp.findInternal(this,a,c).i}},"es6","es3");function moveCamera(a,b){switch(a){case "x":xPosition=b;break;case "y":yPosition=b;break;case "z":zPosition=b}}
function changeCameraCenter(a,b){switch(a){case "x":xCCenter=b;settings.camera.centerPos[0]=b;break;case "y":yCCenter=b;settings.camera.centerPos[1]=b;break;case "z":zCCenter=b,settings.camera.centerPos[2]=b}}function changeCameraFocus(a,b){switch(a){case "x":xCLook=b;settings.camera.focusPos[0]=b;break;case "y":yCLook=b;settings.camera.focusPos[1]=b;break;case "z":zCLook=b,settings.camera.focusPos[2]=b}}
function changeCameraCircleRotation(){circleCameraRotation=document.getElementById("advCamera_circleToggle").checked}function changeCameraLock(){lockCamera=document.getElementById("advCamera_lockToggle").checked}function changeSensitivity(a){settings.camera.mouseSensitivity=a}function changeZoomSensitivity(a){0>a&&(a*=-1);settings.camera.zoomAmount=1+a/2}$(document).on("change",function(a){isNaN(yPosition)&&(yPosition=0);isNaN(xPosition)&&(xPosition=0);isNaN(zPosition)&&(zPosition=0)});
var mouseOnTimeline=!1;$(document).on("mousedown",function(a){mobile||(1==inAnimationWindow?(xStart=a.pageX,yStart=a.pageY,mouseDown=!0):a.pageY>=window.innerHeight-100&&a.pageY<=window.innerHeight-25&&(mouseOnTimeline=!0,timelineScrub(a.pageX)))});$(document).on("mouseup",function(a){300<=a.pageX&&50<=a.pageY&&a.pageY<window.innerHeight-70&&(mouseDown=!1);mouseOnTimeline=!1});
$(document).on("touchstart",function(a){inAnimationWindow=50<=a.touches[0].pageY&&a.touches[0].pageY<window.innerHeight-150?1:0;1==inAnimationWindow?(xStart=a.touches[0].pageX,yStart=a.touches[0].pageY):a.touches[0].pageY>=window.innerHeight-100&&a.touches[0].pageY<=window.innerHeight-25&&(mouseOnTimeline=!0,timelineScrub(a.touches[0].pageX))});$(document).on("touchend",function(a){50<=a.pageY&&a.pageY<window.innerHeight-70&&(mouseDown=!1);mouseOnTimeline=!1});
$(document).on("keydown",function(a){1!=inAnimationWindow||!getId("std_settings").classList.contains("settings_hide")||animationRunning&&lockCamera||("-"==a.key?zoomCameraM(settings.camera.zoomAmount):"="==a.key&&zoomCameraM(1/settings.camera.zoomAmount))});
$(document).on("wheel",function(a){mobile&&"init"!==activeMenu||1!=inAnimationWindow||!getId("std_settings").classList.contains("settings_hide")||animationRunning&&lockCamera||(0<a.originalEvent.deltaY?zoomCameraM(settings.camera.zoomAmount/1.16667):0>a.originalEvent.deltaY&&zoomCameraM(1/(settings.camera.zoomAmount/1.16667)))});$(document).on("mouseup",function(a){mouseOnTimeline=mouseDown=!1});var timelinePosition=0;
$(document).ready(function(){$(document).on("mousemove",function(a){inAnimationWindow=300<=a.pageX&&50<=a.pageY&&a.pageY<window.innerHeight-150?1:0;!mouseDown||1!=inAnimationWindow||!getId("std_settings").classList.contains("settings_hide")||animationRunning&&lockCamera||(rotateCamera(settings.camera.mouseSensitivity*(a.pageX-xStart)/100,settings.camera.mouseSensitivity*(a.pageY-yStart)/100),300<=a.pageX&&50<=a.pageY&&a.pageY<window.innerHeight-70&&(xStart=a.pageX,yStart=a.pageY));mouseOnTimeline&&
timelineScrub(a.pageX)})});
$(document).ready(function(){$(document).on("touchmove",function(a){inAnimationWindow=50<=a.touches[0].pageY&&a.touches[0].pageY<window.innerHeight-150?1:0;"init"!==activeMenu||1!=inAnimationWindow||!getId("std_settings").classList.contains("settings_hide")||animationRunning&&lockCamera||(rotateCamera(settings.camera.mouseSensitivity*(a.touches[0].pageX-xStart)/100,settings.camera.mouseSensitivity*(a.touches[0].pageY-yStart)/100),50<=a.touches[0].pageY&&a.touches[0].pageY<window.innerHeight-150&&
(xStart=a.touches[0].pageX,yStart=a.touches[0].pageY));mouseOnTimeline&&timelineScrub(a.touches[0].pageX)})});
function zoomCameraM(a){zoom=Math.pow(Math.pow(xPosition,2)+Math.pow(yPosition,2)+Math.pow(zPosition,2),.5);if(zoom*a>1*Math.pow(10,100)||zoom*a<1*Math.pow(10,-100))zPosition=yPosition=xPosition=10,showPopUp("popUp_error_body","You dun messed up","You have zoomed to infinity and entered easter egg mode, where css styling degrades into madness and everything is pain. Remember to save your changes before refreshing the page to end this madness.",-1),stylesheetLoader("memeMode");else{zoom*=a;zoomZ=Math.cos(Math.asin(yPosition/
zoom));var b,c;0!==xPosition?b=Math.atan(zPosition/xPosition):0<zPosition?b=Math.PI:0>zPosition&&(b=-Math.PI);0>xPosition&&(0>b?b+=Math.PI:0<b&&(b-=Math.PI));0!==xPosition||0!==zPosition?c=Math.atan(yPosition/Math.pow(Math.pow(xPosition,2)+Math.pow(zPosition,2),.5)):0<yPosition?c=Math.PI:0>yPosition&&(c=-Math.PI);yPosition=zoom*Math.sin(c);xPosition=zoom*Math.cos(Math.asin(yPosition/zoom))*Math.cos(b);zPosition=zoom*Math.cos(Math.asin(yPosition/zoom))*Math.sin(b);getId("camera_x").value=xPosition;
getId("camera_y").value=yPosition;getId("camera_z").value=zPosition;isNaN(yPosition)&&(yPosition=0);isNaN(xPosition)&&(xPosition=0);isNaN(zPosition)&&(zPosition=0)}}
function rotateCamera(a,b){zoomZ=Math.pow(Math.pow(xPosition,2)+Math.pow(zPosition,2),.5);zoom=Math.pow(Math.pow(zoomZ,2)+Math.pow(yPosition,2),.5);var c,g;0!==xPosition?c=Math.atan(zPosition/xPosition):0<zPosition?c=Math.PI:0>=zPosition&&(c=-Math.PI);0>xPosition&&0>c?c+=Math.PI:0>xPosition&&0<c&&(c-=Math.PI);0!==xPosition||0!==zPosition?g=Math.atan(yPosition/zoomZ):0<yPosition?g=Math.PI:0>yPosition&&(g=-Math.PI);c+=a;yPosition=zoom*Math.sin(g+b);xPosition=zoom*Math.cos(Math.asin(yPosition/zoom))*
Math.cos(c);zPosition=zoom*Math.cos(Math.asin(yPosition/zoom))*Math.sin(c);getId("camera_x").value=xPosition;getId("camera_y").value=yPosition;getId("camera_z").value=zPosition;getId("advCamera_centerX").value=xCCenter;getId("advCamera_centerY").value=yCCenter;getId("advCamera_centerZ").value=zCCenter;getId("advCamera_focusX").value=xCLook;getId("advCamera_focusY").value=yCLook;getId("advCamera_focusZ").value=zCLook;isNaN(yPosition)&&(yPosition=0);isNaN(xPosition)&&(xPosition=0);isNaN(zPosition)&&
(zPosition=0)};var animate=function(){if(init){camera.position.x!==xPosition+xCCenter+scene.position.x&&(camera.position.x=xPosition+xCCenter+scene.position.x);camera.position.y!==yPosition+yCCenter+scene.position.y&&(camera.position.y=yPosition+yCCenter+scene.position.y);camera.position.z!==zPosition+zCCenter+scene.position.z&&(camera.position.z=zPosition+zCCenter+scene.position.z);camera.lookAt(scene.position.x+xCLook,scene.position.y+yCLook,scene.position.z+zCLook);for(var a=0;a<shapes.length;a++)shapes[a].scale.x!==
scales[a][0]&&(shapes[a].scale.x=scales[a][0]),shapes[a].scale.y!==scales[a][1]&&(shapes[a].scale.y=scales[a][1]),shapes[a].scale.z!==scales[a][2]&&(shapes[a].scale.z=scales[a][2]);renderer.render(scene,camera);recording&&capturer.capture(renderer.domElement)}requestAnimationFrame(animate)};animate();function newLight(a,b,c,g,f,h,l){var n={ambient:"Ambient",point:"Point",directional:"Directional",spot:"Spot",hemisphere:"Hemisphere"};"hemisphere"!==a&&"spot"!==a?(b=new THREE[n[a]+"Light"](b,c/100),b.name=n[a]+" light",lights[lights.length]=b,scene.add(b),selectedLight=lights.length-1,defaultTargets[selectedLight]=null,lights[selectedLight].position.x=g,lights[selectedLight].position.y=f,lights[selectedLight].position.z=h,getId("newLights_select").value="newLight"):"hemisphere"===a?(f=new THREE[n[a]+
"Light"](b,l,c/100),f.name=n[a]+" light",lights[lights.length]=f,scene.add(f),selectedLight=lights.length-1,defaultTargets[selectedLight]=null,lights[selectedLight].position.x=g,lights[selectedLight].position.y=-1,lights[selectedLight].position.z=h):"spot"===a&&(b=new THREE[n[a]+"Light"](b,c/100),b.name=n[a]+" light",lights[lights.length]=b,scene.add(b),scene.add(b.target),selectedLight=lights.length-1,defaultTargets[selectedLight]=lights[selectedLight].target,lights[selectedLight].position.x=g,lights[selectedLight].position.y=
f,lights[selectedLight].position.z=h,getId("newLights_select").value="newLight");setSelectedLight(selectedLight);for(a=0;a<keyFrames.length;a++)keyFrames[a].lights.push([0,0,0,0,0,0,0,0,0,0,!1])}function moveTarget(a,b){lights[selectedLight].target.position[a]=Number(b)}
function setTargetList(){var a=document.getElementById("target_select");a.innerHTML="<option value='defaultTarget'>Default Target</option>";for(var b={cube:1,cone:1,cylinder:1,dodecahedron:1,icosahedron:1,octahedron:1,pyramid:1,sphere:1,ring:1,text:1},c=0;c<shapes.length;c++){var g=shapes[c].uuid,f=shapes[c].geometry.name,h=b[f];b[f]++;a.innerHTML=shapes[c].uuid===lights[selectedLight].target.uuid?a.innerHTML+("<option value = "+g+" selected>"+shapes[c].geometry.name+" "+h+"</option>"):a.innerHTML+
("<option value = "+g+">"+shapes[c].geometry.name+" "+h+"</option>")}}function setTarget(a){var b;if("defaultTarget"===a)lights[selectedLight].target=defaultTargets[selectedLight],console.log(lights[selectedLight].target.position),getId("default_target_position").style.display="inherit";else{getId("default_target_position").style.display="none";for(var c=0;c<shapes.length;c++)shapes[c].uuid===a&&(b=shapes[c]);null!==b?lights[selectedLight].target=b:console.log("No shape with that id exists")}}
function toggleCastShadow(){showingLight?lights[selectedLight].castShadow=document.getElementById("light_castShadow").checked:shapes[selectedShape].castShadow=document.getElementById("shape_castShadow").checked}function toggleReceiveShadow(){shapes[selectedShape].receiveShadow=document.getElementById("shape_receiveShadow").checked}
function removeLight(){if(0<=selectedLight){scene.remove(lights[selectedLight]);lights.splice(selectedLight,1);selectedLight=-1;setSelectedLight(selectedLight);for(var a=0;a<keyFrames.length;a++)keyFrames[a].lights.splice(selectedLight,1);saveEngine.save(!0,!1)}}function moveLight(a,b){lights[selectedLight].position[a]=Number(b)}function changeLightColor(a){lights[selectedLight].color.set(a)}
function changeGroundLightColor(a){"HemisphereLight"===lights[selectedLight].type?lights[selectedLight].groundColor.set(a):changeLightColor(a)}function changeIntensity(){var a=document.getElementById("intensity_slider");document.getElementById("intensity_value").innerHTML=a.value;lights[selectedLight].intensity=a.value/100};function addCustom2(){var a=document.createElement("INPUT");a.setAttribute("type","file");document.getElementById("newShape_OBJUploader").appendChild(a)}function getRandomColor(){for(var a="#",b=0;6>b;b++)a+="0123456789ABCDEF"[Math.floor(16*Math.random())];return a}function readSingleFile(a){if(a=a.target.files[0]){var b=new FileReader;b.onload=function(a){strin=a.target.result.replace(/\r\n/g,"\n");strin=strin.split("\n");parseFile1(strin)};b.readAsText(a)}else alert("Failed to load file")}
function parseFile1(a){for(var b=[],c=[],g=!1,f=!1,h,l=1;l<a.length-1;l++)"o"==a[l-1][0]&&(h=a[l-1],f=!0),"v"==a[l][0]&&" "==a[l][1]&&(a[l]=" "==a[l][2]?a[l].slice(3):a[l].slice(2),b.push(a[l].split(" ").map(parseFloat))),"g"==a[l][0]&&(g=!0),"f"==a[l][0]&&(a[l]=" "==a[l][2]?a[l].slice(3):a[l].slice(2),c.push(a[l].split(/[\/\s]/).map(parseFloat))),1<c.length&&(!a[l+1]||"v"==a[l+1][0])&&(g&&(newCustom2(1,1,1,0,0,0,getRandomColor(),"#000000",b,c,l,h),c=[],g=!1),f&&(newCustom2(1,1,1,0,0,0,getRandomColor(),
"#000000",b,c,l,h),c=[],f=!1))}document.getElementById("newShape_OBJUploader").addEventListener("change",readSingleFile,!1);function newCustom2(a,b,c,g,f,h,l,n,k,e,q,m){var p=new THREE.Geometry;l=new THREE.MeshLambertMaterial({color:l});l.lights=!0;console.log(e);for(var d=0;d<k.length;d++)p.vertices.push(new THREE.Vector3(k[d][0],k[d][1],k[d][2])),3<k[d].length&&alert(d+" "+k[d]+" Is a vertex4");for(d=0;d<e.length;d++){for(var r=0;r<e[d].length;r++);isNaN(e[d][e[d].length-1])&&e[d].pop();3==e[d].length&&(0>e[d][0]?(e[d][0]=k.length+e[d][0],e[d][1]=k.length+e[d][1],e[d][2]=k.length+e[d][2]):0<e[d][0]&&(--e[d][0],--e[d][1],
--e[d][2]),p.faces.push(new THREE.Face3(e[d][1],e[d][2],e[d][0])));4==e[d].length&&(0>e[d][0]?(e[d][0]=k.length+e[d][0],e[d][1]=k.length+e[d][1],e[d][2]=k.length+e[d][2]):0<e[d][0]&&(--e[d][0],--e[d][1],--e[d][2],--e[d][3]),p.faces.push(new THREE.Face3(e[d][0],e[d][1],e[d][2])),p.faces.push(new THREE.Face3(e[d][0],e[d][2],e[d][3])));6==e[d].length&&(0>e[d][0]?(e[d][0]=k.length+e[d][0],e[d][2]=k.length+e[d][2],e[d][4]=k.length+e[d][4]):0<e[d][0]&&(--e[d][0],--e[d][2],--e[d][4]),p.faces.push(new THREE.Face3(e[d][0],
e[d][2],e[d][4])));8==e[d].length&&(0>e[d][0]?(e[d][0]=k.length+e[d][0],e[d][2]=k.length+e[d][2],e[d][4]=k.length+e[d][4],e[d][6]=k.length+e[d][6]):0<e[d][0]&&(--e[d][0],--e[d][2],--e[d][4],--e[d][6]),p.faces.push(new THREE.Face3(e[d][0],e[d][2],e[d][4])),p.faces.push(new THREE.Face3(e[d][0],e[d][4],e[d][6])));9==e[d].length&&(0>e[d][0]?(e[d][0]=k.length+e[d][0],e[d][3]=k.length+e[d][3],e[d][6]=k.length+e[d][6]):0<e[d][0]&&(--e[d][0],--e[d][3],--e[d][6]),p.faces.push(new THREE.Face3(e[d][0],e[d][3],
e[d][6])));12==e[d].length&&(0>e[d][0]?(e[d][0]=k.length+e[d][0],e[d][3]=k.length+e[d][3],e[d][6]=k.length+e[d][6],e[d][9]=k.length+e[d][9]):0<e[d][0]&&(--e[d][0],--e[d][3],--e[d][6],--e[d][9]),p.faces.push(new THREE.Face3(e[d][0],e[d][3],e[d][6])),p.faces.push(new THREE.Face3(e[d][0],e[d][6],e[d][9])));18==e[d].length&&(0>e[d][0]?(e[d][0]=k.length+e[d][0],e[d][3]=k.length+e[d][3],e[d][6]=k.length+e[d][6],e[d][9]=k.length+e[d][9],e[d][12]=k.length+e[d][12],e[d][15]=k.length+e[d][15]):0<e[d][0]&&(--e[d][0],
--e[d][3],--e[d][6],--e[d][9],--e[d][12],--e[d][15]),p.faces.push(new THREE.Face3(e[d][0],e[d][3],e[d][6])),p.faces.push(new THREE.Face3(e[d][0],e[d][6],e[d][9])),p.faces.push(new THREE.Face3(e[d][9],e[d][12],e[d][15])))}console.log(k.length+" Vertices");console.log(e.length+" Faces");console.log("Shape Ends at "+q);k=(new THREE.BufferGeometry).fromGeometry(p);shapes[shapes.length]=new THREE.Mesh(k,l);n=new THREE.LineSegments(k,new THREE.LineBasicMaterial({color:n}));p.name=null!=m?m:"Uploaded_Shape";
scene.add(shapes[shapes.length-1]);selectedShape=shapes.length-1;k.computeVertexNormals();n.scale.x=a;n.scale.y=b;n.scale.z=c;borders.push(n);scene.add(n);borders[borders.length-1].visible=!1;m=scales.length;scales[m]=[];scales[m][0]=a;scales[m][1]=b;scales[m][2]=c;setSelectedShape(selectedShape);moveElement("x",g);moveElement("y",f);moveElement("z",h);document.getElementById("diemsions_x").value=a;document.getElementById("diemsions_y").value=b;document.getElementById("diemsions_z").value=c;document.getElementById("position_x").value=
g;document.getElementById("position_y").value=f;document.getElementById("position_z").value=h;saveEngine._localStorageEnable=!1;saveEngine._cloudStorageEnable=!1;showPopUp("popUp_error_body","Warning","Uploading OBJs disables the save engine due to their large amount of polygons",-1)};var createVertices=[],createFaces=[];
function newCustom(a,b,c,g,f,h,l,n,k,e){var q=new THREE.Geometry(1,1,1);if(0!==k.length)for(var m=0;m<k.length;m++)createVertices.push(k[m]);if(0!==e.length)for(m=0;m<k.length;m++)createFaces.push(e[m]);for(k=0;k<createVertices.length;k++)q.vertices.push(createVertices[k]);for(k=0;k<createFaces.length;k++)q.faces.push(createFaces[k]);k=(new THREE.BufferGeometry).fromGeometry(q);n=new THREE.LineSegments(k,new THREE.LineBasicMaterial({color:n}));n.scale.x=a;n.scale.y=b;n.scale.z=c;borders.push(n);scene.add(n);
l=new THREE.MeshLambertMaterial({color:l});q.computeFaceNormals();l.lights=!0;shapes[shapes.length]=new THREE.Mesh(q,l);l=scales.length;q.name="custom";scales[l]=[];scales[l][0]=a;scales[l][1]=b;scales[l][2]=c;scene.add(shapes[shapes.length-1]);selectedShape=shapes.length-1;setSelectedShape(selectedShape);moveElement("x",g);moveElement("y",f);moveElement("z",h);document.getElementById("dimensionX").value=a;document.getElementById("dimensionY").value=b;document.getElementById("dimensionZ").value=c;
document.getElementById("positionBoxX").value=g;document.getElementById("positionBoxY").value=f;document.getElementById("positionBoxZ").value=h;createVertices.length=0;createFaces.length=0;loadCreateFaceList();loadCreateVectorList()}function createVertex(){createVertices.push(new THREE.Vector3(0,0,0));console.log("vector added");console.log(createVertices);loadCreateVectorList()}function cancelVector(a){createVertices.splice(a,1);loadCreateVectorList()}
function loadCreateVectorList(){document.getElementById("createVectorList").innerHTML="";for(var a=0;a<createVertices.length;a++)document.getElementById("createVectorList").innerHTML+='<input id="xCreateCoord" type="number" value="'+createVertices[a].x+'" onkeyup="createVertices['+a+'].setX(this.value)" onchange="createVertices['+a+'].setX(this.value)">X\n        <input id="yCreateCoord" type="number" value="'+createVertices[a].y+'" onkeyup="createVertices['+a+'].setY(this.value)" onchange="createVertices['+
a+'].setY(this.value)">Y\n        <input id="zCreateCoord" type="number" value="'+createVertices[a].z+'" onkeyup="createVertices['+a+'].setZ(this.value)" onchange="createVertices['+a+"].setZ(this.value)\">Z\n        <button class='material-icons' onclick='cancelVector("+a+")'>close</button>\n        \n        <br>";console.log("vector list loaded")}
function cancelCustom(){createVertices.length=0;createFaces.length=0;document.getElementById("createVectorList").innerHTML="";document.getElementById("createFaceList").innerHTML="";shapeMenu()}function createFace(){createFaces.push(new THREE.Face3(0,1,2));console.log("face added");console.log(createFaces);loadCreateFaceList()}function cancelFace(a){createFaces.splice(a,1);loadCreateFaceList()}
function loadCreateFaceList(){document.getElementById("createFaceList").innerHTML="";for(var a=0;a<createFaces.length;a++)document.getElementById("createFaceList").innerHTML+='<input id="xCreatePoint" type="number" value="'+createFaces[a].a+'" onkeyup="createFaces['+a+"].copy(new THREE.Face3(this.value, createFaces["+a+"].b, createFaces["+a+'].c))" onchange="createFaces['+a+"].copy(new THREE.Face3(this.value, createFaces["+a+"].b, createFaces["+a+'].c))">A\n        <input id="yCreatePoint" type="number" value="'+
createFaces[a].b+'" onkeyup="createFaces['+a+"].copy(new THREE.Face3(createFaces["+a+"].a, this.value, createFaces["+a+'].c))" onchange="createFaces['+a+"].copy(new THREE.Face3(createFaces["+a+"].a, this.value, createFaces["+a+'].c))">B\n        <input id="zCreatePoint" type="number" value="'+createFaces[a].c+'" onkeyup="createFaces['+a+"].copy(new THREE.Face3(createFaces["+a+"].a, createFaces["+a+'].b, this.value))" onchange="createFaces['+a+"].copy(new THREE.Face3(createFaces["+a+"].a, createFaces["+
a+"].b, this.value))\">C\n        <button class='material-icons' onclick='cancelFace("+a+")'>close</button>\n        \n        <br>";console.log("face list loaded")};function moveElement(a,b){showingLight?lights[selectedLight].position[a]=Number(b):(shapes[selectedShape].position[a]=Number(b),borders[selectedShape].position[a]=Number(b))}function postitionShape(a,b){shapes[selectedShape].position[a]=Number(b);borders[selectedShape].position[a]=Number(b)}function rotateShape(a,b){shapes[selectedShape].rotation[a]=Number(b)*Math.PI/180;borders[selectedShape].rotation[a]=Number(b)*Math.PI/180}var hasMovedZ=!1;
function resizeShape(a,b){switch(a){case "x":scales[selectedShape][0]=Number(b);borders[selectedShape].scale.x=Number(b);break;case "y":scales[selectedShape][1]=Number(b);borders[selectedShape].scale.y=Number(b);break;case "z":scales[selectedShape][2]=Number(b),borders[selectedShape].scale.z=Number(b)}}function removeElement(){showingLight?removeLight():removeShape()}
function removeShape(){if(0<=selectedShape){scene.remove(shapes[selectedShape]);scene.remove(borders[selectedShape]);shapes.splice(selectedShape,1);scales.splice(selectedShape,1);borders.splice(selectedShape,1);selectedShape=-1;setSelectedShape(selectedShape);for(var a=0;a<keyFrames.length;a++)keyFrames[a].shapes.splice(selectedShape,1),keyFrames[a].scales.splice(selectedShape,1);saveEngine.save(!0,!1)}}
function toggleVisibility(){var a=getId("element_visibility").children[0],b;showingLight?(b=lights[selectedLight].visible)?(lights[selectedLight].visible=!1,a.innerHTML="Show Element"):(lights[selectedLight].visible=!0,a.innerHTML="Hide Element"):(b=shapes[selectedShape].visible)?(shapes[selectedShape].visible=!1,a.innerHTML="Show Element"):(shapes[selectedShape].visible=!0,a.innerHTML="Hide Element")}
function borderChange(a){showingLight?changeGroundLightColor(a):borders[selectedShape].material.color.set(a)}function toggleColorBorder(a){a?document.getElementById("createColorBorder").style.display="inherit":document.getElementById("createColorBorder").style.display="none"}
function duplicateCurrentShape(){var a=shapes[selectedShape];switch(a.geometry.name){case "cube":console.log("Start duplication");newCube(scales[selectedShape][0],scales[selectedShape][1],scales[selectedShape][2],a.position.x,a.position.y,a.position.z,"#"+a.material.color.getHexString(),"#"+borders[selectedShape].material.color.getHexString());break;case "cylinder":newCylinder(scales[selectedShape][0],scales[selectedShape][1],scales[selectedShape][2],a.position.x,a.position.y,a.position.z,"#"+a.material.color.getHexString(),
"#"+borders[selectedShape].material.color.getHexString());break;case "cone":newCone(scales[selectedShape][0],scales[selectedShape][1],scales[selectedShape][2],a.position.x,a.position.y,a.position.z,"#"+a.material.color.getHexString(),"#"+borders[selectedShape].material.color.getHexString());break;case "dodecahedron":newDodecahedron(scales[selectedShape][0],scales[selectedShape][1],scales[selectedShape][2],a.position.x,a.position.y,a.position.z,"#"+a.material.color.getHexString(),"#"+borders[selectedShape].material.color.getHexString());
break;case "icosahedron":newIcosahedron(scales[selectedShape][0],scales[selectedShape][1],scales[selectedShape][2],a.position.x,a.position.y,a.position.z,"#"+a.material.color.getHexString(),"#"+borders[selectedShape].material.color.getHexString());break;case "octahedron":newOctahedron(scales[selectedShape][0],scales[selectedShape][1],scales[selectedShape][2],a.position.x,a.position.y,a.position.z,"#"+a.material.color.getHexString(),"#"+borders[selectedShape].material.color.getHexString());break;case "pyramid":newPyramid(scales[selectedShape][0],
scales[selectedShape][1],scales[selectedShape][2],a.position.x,a.position.y,a.position.z,"#"+a.material.color.getHexString(),"#"+borders[selectedShape].material.color.getHexString());break;case "ring":newRing(scales[selectedShape][0],scales[selectedShape][1],scales[selectedShape][2],a.position.x,a.position.y,a.position.z,"#"+a.material.color.getHexString(),"#"+borders[selectedShape].material.color.getHexString());break;case "sphere":newSphere(scales[selectedShape][0],scales[selectedShape][1],scales[selectedShape][2],
a.position.x,a.position.y,a.position.z,"#"+a.material.color.getHexString(),"#"+borders[selectedShape].material.color.getHexString());break;case "custom":newCustom(scales[selectedShape][0],scales[selectedShape][1],scales[selectedShape][2],a.position.x,a.position.y,a.position.z,"#"+a.material.color.getHexString(),"#"+borders[selectedShape].material.color.getHexString(),a.geometry.vertices,a.geometry.faces);break;case "text":document.getElementById("createText").value=a.geometry.parameters.text,newText(scales[selectedShape][0],
scales[selectedShape][1],scales[selectedShape][2],a.position.x,a.position.y,a.position.z,"#"+a.material.color.getHexString(),"#"+borders[selectedShape].material.color.getHexString()),saveEngine.save(!0,!1)}saveEngine.save(!0,!1)}
function newShape(a,b,c,g,f,h,l,n,k,e){if("custom"!==a&&"text"!==a&&"textIn"!==a){switch(a){case "cube":var q=new THREE.BoxGeometry(1,1,1);var m=new THREE.BoxBufferGeometry(1,1,1);break;case "cone":q=new THREE.ConeGeometry(.5,1,100);m=new THREE.ConeBufferGeometry(.5,1,100);break;case "cylinder":q=new THREE.CylinderGeometry(.5,.5,1,100);m=new THREE.CylinderBufferGeometry(.5,.5,1,100);break;case "dodecahedron":q=new THREE.DodecahedronGeometry(.5,0);m=new THREE.DodecahedronBufferGeometry(.5,0);break;
case "icosahedron":q=new THREE.IcosahedronGeometry(.5,0);m=new THREE.IcosahedronBufferGeometry(.5,0);break;case "octahedron":q=new THREE.OctahedronGeometry(.5,0);m=new THREE.OctahedronBufferGeometry(.5,0);break;case "pyramid":q=new THREE.TetrahedronGeometry(.5,0);m=new THREE.TetrahedronBufferGeometry(.5,0);break;case "ring":q=new THREE.TorusGeometry(.5,.25,200,200);m=new THREE.TorusBufferGeometry(.5,.25,200,200);break;case "sphere":q=new THREE.SphereGeometry(.5,100,100);m=new THREE.SphereBufferGeometry(.5,
100,100);break;default:showPopUp("popUp_error_body","Error","Invalid Shape",-1)}a=a.charAt(0).toUpperCase()+a.substring(1,a.length);var p=new THREE.MeshLambertMaterial({color:n});p.lights=!0;shapes[shapes.length]=new THREE.Mesh(q,p);p=scales.length;q.name=a;scales[p]=[];scales[p][0]=b;scales[p][1]=c;scales[p][2]=g;scene.add(shapes[shapes.length-1]);selectedShape=shapes.length-1;a=new THREE.EdgesGeometry(m);a=new THREE.LineSegments(a,new THREE.LineBasicMaterial({color:k}));a.scale.x=b;a.scale.y=c;
a.scale.z=g;borders.push(a);scene.add(a);setSelectedShape(selectedShape);moveElement("x",f);moveElement("y",h);moveElement("z",l);document.getElementById("diemsions_x").value=b;document.getElementById("diemsions_y").value=c;document.getElementById("diemsions_z").value=g;document.getElementById("position_x").value=f;document.getElementById("position_y").value=h;document.getElementById("position_z").value=l;getId("newShapes_select").selectedIndex=0}else"TextIn"===a?showPopUp("popUp_input_body","New Text",
"Enter Text",1):"Text"===a&&(new THREE.FontLoader).load("https://threejs.org/examples/fonts/helvetiker_regular.typeface.json",function(a){var d=new THREE.TextGeometry(e,{font:a,size:1,height:.05,curveSegments:6,bevelEnabled:!0,bevelThickness:.5,bevelSize:.05,bevelSegments:2.5}),m=new THREE.MeshLambertMaterial({color:n});m.lights=!0;shapes[shapes.length]=new THREE.Mesh(d,m);m=scales.length;d.name=e;scales[m]=[];scales[m][0]=b;scales[m][1]=c;scales[m][2]=g;scene.add(shapes[shapes.length-1]);selectedShape=
shapes.length-1;a=new THREE.TextBufferGeometry(e,{font:a,size:1,height:.05,curveSegments:6,bevelEnabled:!0,bevelThickness:.5,bevelSize:.05,bevelSegments:2.5});a=new THREE.EdgesGeometry(a);a=new THREE.LineSegments(a,new THREE.LineBasicMaterial({color:k}));a.scale.x=b;a.scale.y=c;a.scale.z=g;borders.push(a);scene.add(a);setSelectedShape(selectedShape);moveElement("x",f);moveElement("y",h);moveElement("z",l);document.getElementById("diemsions_x").value=b;document.getElementById("diemsions_y").value=
c;document.getElementById("diemsions_z").value=g;document.getElementById("position_x").value=f;document.getElementById("position_y").value=h;document.getElementById("position_z").value=l;getId("newShapes_select").selectedIndex=0});for(a=0;a<keyFrames.length;a++)keyFrames[a].shapes.push([0,0,0,0,0,0,!1]),keyFrames[a].scales.push([0,0,0]),keyFrames[a].color.push([0,0,0]),keyFrames[a].borderColor.push([0,0,0])}function getId(a){return document.getElementById(a)};function addFrame(){addfortutorial("add_frame");scene.background||(scene.background=new THREE.Color("#000000"));keyFrames.push({duration:2E3,shapes:getShapes(shapes),scales:JSON.parse(JSON.stringify(scales)),xPosition:xPosition,yPosition:yPosition,zPosition:zPosition,xCCenter:xCCenter,yCCenter:yCCenter,zCCenter:zCCenter,xCLook:xCLook,yCLook:yCLook,zCLook:zCLook,circleCameraRotation:circleCameraRotation,color:getColors(shapes),name:"Frame "+keyFrames.length.toString(),borderColor:getColors(borders),
borderVisible:getBorderVisbility(borders),scene:[scene.background.r,scene.background.g,scene.background.b,scene.scale.x,scene.scale.y,scene.scale.z,scene.rotation.x,scene.rotation.y,scene.rotation.z,scene.position.x,scene.position.y,scene.position.z],lights:getLights(lights)});console.log("frame added");console.log(keyFrames);updateTimeline();saveEngine.save(!0,!0)}function loadKeyList(){console.log("Load Key List Called ")}
function playAnimation(a){addfortutorial("play");var b=!1;0===keyFrames.length&&(b=!0);if(!b)if(animationRunning)clearInterval(animationTimer),timelineButtonToggle("timeline_play"),console.log("stopped"),animationRunning=!1,recording&&(timelineButtonToggle("timeline_record"),recording=!1,capturer.stop(),capturer.save());else if(timelineButtonToggle("timeline_play"),console.log("starting"),animationRunning=!0,0<=a&&a<getTotalAnimationTime()){b=0;for(var c,g,f=0,h=0;h<keyFrames.length-1;h++)if(a>=b&&
a<b+keyFrames[h].duration){c=h;break}else b+=keyFrames[h].duration,f+=keyFrames[h].duration;null!=c&&(g=a-b,animationTimer=setInterval(function(){document.getElementById("timeline_playHead").style.left=11+(g+f)/timelineScale+"px";g<keyFrames[c].duration?(g+=10,updateAnimation(g,c)):c<keyFrames.length-2?(f+=keyFrames[c].duration,c++,g=0):loopAnimation?(g=f=c=0,document.getElementById("timeline_playHead").style.left="1px"):(clearInterval(animationTimer),timelineButtonToggle("timeline_play"),console.log("done"),
animationRunning=!1,recording&&(timelineButtonToggle("timeline_record"),recording=!1,capturer.stop(),capturer.save()),lastTickAnimated=0)},10))}}function getShapes(a){for(var b=[],c=0;c<a.length;c++)b.push([a[c].position.x,a[c].position.y,a[c].position.z,a[c].rotation.x,a[c].rotation.y,a[c].rotation.z,a[c].visible]);return b}
function getLights(a){for(var b=[],c=0;c<a.length;c++)b.push([a[c].intensity,a[c].position.x,a[c].position.y,a[c].position.z,a[c].color.r,a[c].color.g,a[c].color.b,a[c].rotation.x,a[c].rotation.y,a[c].rotation.z,a[c].visible]),"HemisphereLight"===a[c].type&&b[c].push(a[c].groundColor.r,a[c].groundColor.g,a[c].groundColor.b);return b}function getBorderVisbility(a){for(var b=[],c=0;c<a.length;c++)b.push(a[c].visible);return b}
function getColors(a){for(var b=[],c=0;c<a.length;c++)b.push([a[c].material.color.r,a[c].material.color.g,a[c].material.color.b]);return b}
function updateAnimation(a,b){if(lockCamera)if(xCLook=keyFrames[b].xCLook+(keyFrames[b+1].xCLook-keyFrames[b].xCLook)/keyFrames[b].duration*a,yCLook=keyFrames[b].yCLook+(keyFrames[b+1].yCLook-keyFrames[b].yCLook)/keyFrames[b].duration*a,zCLook=keyFrames[b].zCLook+(keyFrames[b+1].zCLook-keyFrames[b].zCLook)/keyFrames[b].duration*a,xCCenter=keyFrames[b].xCCenter+(keyFrames[b+1].xCCenter-keyFrames[b].xCCenter)/keyFrames[b].duration*a,yCCenter=keyFrames[b].yCCenter+(keyFrames[b+1].yCCenter-keyFrames[b].yCCenter)/
keyFrames[b].duration*a,zCCenter=keyFrames[b].zCCenter+(keyFrames[b+1].zCCenter-keyFrames[b].zCCenter)/keyFrames[b].duration*a,isNaN(keyFrames[0].xCLook)&&(keyFrames[0].xCLook=0),isNaN(keyFrames[0].yCLook)&&(keyFrames[0].yCLook=0),isNaN(keyFrames[0].zCLook)&&(keyFrames[0].zCLook=0),isNaN(keyFrames[1].xCLook)&&(keyFrames[1].xCLook=0),isNaN(keyFrames[1].yCLook)&&(keyFrames[1].yCLook=0),isNaN(keyFrames[1].zCLook)&&(keyFrames[1].zCLook=0),zoom1Zv=Math.pow(Math.pow(keyFrames[b].xCLook-xPosition,2)+Math.pow(keyFrames[b].zCLook-
zPosition,2),.5),zoom1v=Math.pow(Math.pow(zoom1Zv,2)+Math.pow(keyFrames[b].yCLook-yPosition,2),.5),cameraDebug&&(console.log("f1zoomZ "+zoom1Zv),console.log("f1zoom "+zoom1v)),Ry1v=Rz1v=0,0!==keyFrames[b].xCLook-xPosition?Rz1v=Math.atan((keyFrames[b].zCLook-zPosition)/(keyFrames[b].xCLook-xPosition)):0<keyFrames[b].zCLook-zPosition?Rz1v=Math.PI:0>keyFrames[b].zCLook-zPosition&&(Rz1v=-Math.PI),0>xPosition&&(0>Rz1v?Rz1v+=Math.PI:0<Rz1v&&(Rz1v-=Math.PI)),0!==keyFrames[b].xCLook-xPosition||0!==zPosition-
keyFrames[b].zCLook?Ry1v=Math.atan((keyFrames[b].yCLook-yPosition)/zoom1Zv):0<keyFrames[b].yCLook-yPosition?Ry1v=Math.PI:0>keyFrames[b].yCLook-yPosition&&(Ry1v=-Math.PI),zoom2Zv=Math.pow(Math.pow(keyFrames[b+1].xCLook-xPosition,2)+Math.pow(keyFrames[b+1].zCLook-zPosition,2),.5),zoom2v=Math.pow(Math.pow(zoom2Zv,2)+Math.pow(yPosition-keyFrames[b+1].yCLook,2),.5),cameraDebug&&(console.log("f2zoomZ "+zoom2Zv),console.log("f2zoom "+zoom2v)),Ry2v=Rz2v=0,0!==keyFrames[b+1].xCLook-xPosition?Rz2v=Math.atan((keyFrames[b+
1].zCLook-zPosition)/(keyFrames[b+1].xCLook-xPosition)):0<keyFrames[b+1].zCLook-zPosition?Rz2v=Math.PI:0>keyFrames[b+1].zCLook-zPosition&&(Rz2v=-Math.PI),0>keyFrames[b+1].xPosition&&0>Rz2v?Rz2v+=Math.PI:0>keyFrames[b+1].xPosition&&0<Rz2v&&(Rz2v-=Math.PI),0!==keyFrames[b+1].xCLook-xPosition||0!==keyFrames[b+1].zCLook-zPosition?Ry2v=Math.atan((keyFrames[b+1].yCLook-yPosition)/zoom2Zv):0<keyFrames[b+1].yCLook-yPosition?Ry2v=Math.PI:0>keyFrames[b+1].yCLook-yPosition&&(Ry2v=-Math.PI),cameraDebug&&(console.log("f1RY "+
Ry1v/Math.PI*180+"\u00b0"),console.log("f2RY "+Ry2v/Math.PI*180+"\u00b0"),console.log("f1RZ "+Rz1v/Math.PI*180+"\u00b0"),console.log("f2RZ "+Rz2v/Math.PI*180+"\u00b0")),MvXv=Rz2v-Rz1v,MvYv=Ry2v-Ry1v,zoomChangev=zoom2v-zoom1v,zoomZChangev=zoom2Zv-zoom1Zv,cameraDebug&&(console.log("moving zoom "+zoomChangev),console.log("moving zoomZ "+zoomZChangev),console.log("moving X "+MvXv/Math.PI*180+"\u00b0"),console.log("moving Y "+MvYv/Math.PI*180+"\u00b0")),cameraDebug&&(console.log(xCLook),console.log(yCLook),
console.log(zCLook)),circleCameraRotation=keyFrames[b+1].circleCameraRotation){if(10>=a||!animationRunning)zoom1Z=Math.pow(Math.pow(keyFrames[b].xPosition,2)+Math.pow(keyFrames[b].zPosition,2),.5),zoom1=Math.pow(Math.pow(zoom1Z,2)+Math.pow(keyFrames[b].yPosition,2),.5),cameraDebug&&(console.log("f1zoomZ "+zoom1Z),console.log("f1zoom "+zoom1)),Ry1=Rz1=0,0!==keyFrames[b].xPosition?Rz1=Math.atan(keyFrames[b].zPosition/keyFrames[b].xPosition):0<keyFrames[b].zPosition?Rz1=Math.PI:0>keyFrames[b].zPosition&&
(Rz1=-Math.PI),0>keyFrames[b].xPosition&&(0>Rz1?Rz1+=Math.PI:0<Rz1&&(Rz1-=Math.PI)),0!==keyFrames[b].xPosition||0!==keyFrames[b].zPosition?Ry1=Math.atan(keyFrames[b].yPosition/zoom1Z):0<keyFrames[b].yPosition?Ry1=Math.PI:0>keyFrames[b].yPosition&&(Ry1=-Math.PI),zoom2Z=Math.pow(Math.pow(keyFrames[b+1].xPosition,2)+Math.pow(keyFrames[b+1].zPosition,2),.5),zoom2=Math.pow(Math.pow(zoom2Z,2)+Math.pow(keyFrames[b+1].yPosition,2),.5),cameraDebug&&(console.log("f2zoomZ "+zoom2Z),console.log("f2zoom "+zoom2)),
Ry2=Rz2=0,0!==keyFrames[b+1].xPosition?Rz2=Math.atan(keyFrames[b+1].zPosition/keyFrames[b+1].xPosition):0<keyFrames[b+1].zPosition?Rz2=Math.PI:0>keyFrames[b+1].zPosition&&(Rz2=-Math.PI),0>keyFrames[b+1].xPosition&&(0>Rz2?Rz2+=Math.PI:0<Rz2&&(Rz2-=Math.PI)),0!==keyFrames[b+1].xPosition||0!==keyFrames[b+1].zPosition?Ry2=Math.atan(keyFrames[b+1].yPosition/zoom2Z):0<keyFrames[b+1].yPosition?Ry2=Math.PI:0>keyFrames[b+1].yPosition&&(Ry2=-Math.PI),cameraDebug&&(console.log("f1RY "+Ry1/Math.PI*180+"\u00b0"),
console.log("f2RY "+Ry2/Math.PI*180+"\u00b0"),console.log("f1RZ "+Rz1/Math.PI*180+"\u00b0"),console.log("f2RZ "+Rz2/Math.PI*180+"\u00b0")),MvX=Rz2-Rz1,MvY=Ry2-Ry1,zoomChange=zoom2-zoom1,zoomZChange=zoom2Z-zoom1Z,cameraDebug&&(console.log("moving zoom "+zoomChange),console.log("moving zoomZ "+zoomZChange),console.log("moving X "+MvX/Math.PI*180+"\u00b0"),console.log("moving Y "+MvY/Math.PI*180+"\u00b0"));yPosition=(zoom1+zoomChange/keyFrames[b].duration*a)*Math.sin(Ry1+MvY/keyFrames[b].duration*a);
xPosition=(zoom1Z+zoomZChange/keyFrames[b].duration*a)*Math.cos(Rz1+MvX/keyFrames[b].duration*a);zPosition=(zoom1Z+zoomZChange/keyFrames[b].duration*a)*Math.sin(Rz1+MvX/keyFrames[b].duration*a);cameraDebug&&(console.log(xPosition),console.log(yPosition),console.log(zPosition));isNaN(yPosition)&&(yPosition=0);isNaN(xPosition)&&(xPosition=0);isNaN(zPosition)&&(zPosition=0)}else xPosition=keyFrames[b].xPosition+(keyFrames[b+1].xPosition-keyFrames[b].xPosition)/keyFrames[b].duration*a,yPosition=keyFrames[b].yPosition+
(keyFrames[b+1].yPosition-keyFrames[b].yPosition)/keyFrames[b].duration*a,zPosition=keyFrames[b].zPosition+(keyFrames[b+1].zPosition-keyFrames[b].zPosition)/keyFrames[b].duration*a;scene.background.fromArray(updateElement([scene.background.r,scene.background.g,scene.background.b],[0,1,2],b,a,"scene",0));scene.scale.fromArray(updateElement([scene.scale.x,scene.scale.y,scene.scale.z],[3,4,5],b,a,"scene",0));scene.rotation.fromArray(updateElement([scene.rotation.x,scene.rotation.y,scene.rotation.z],
[6,7,8],b,a,"scene",0));scene.position.fromArray(updateElement([scene.position.x,scene.position.y,scene.position.z],[9,10,11],b,a,"scene",0));for(var c=0;c<keyFrames[b].scales.length;c++)shapes[c].visible=keyFrames[b+1].shapes[c][6],borders[c].visible=keyFrames[b+1].shapes[c][6]&&keyFrames[b+1].borderVisible[c],scales[c]=updateElement([scales[c][0],scales[c][1],scales[c][2]],[0,1,2],b,a,"scales",c),borders[c].scale.fromArray(updateElement([borders[c].scale.x,borders[c].scale.y,borders[c].scale.z],
[0,1,2],b,a,"scales",c)),shapes[c].position.fromArray(updateElement([shapes[c].position.x,shapes[c].position.y,shapes[c].position.z],[0,1,2],b,a,"shapes",c)),shapes[c].rotation.fromArray(updateElement([shapes[c].rotation.x,shapes[c].rotation.y,shapes[c].rotation.z],[3,4,5],b,a,"shapes",c)),borders[c].position.fromArray(updateElement([borders[c].position.x,borders[c].position.y,borders[c].position.z],[0,1,2],b,a,"shapes",c)),borders[c].rotation.fromArray(updateElement([borders[c].rotation.x,borders[c].rotation.y,
borders[c].rotation.z],[3,4,5],b,a,"shapes",c)),shapes[c].material.color.fromArray(updateElement([shapes[c].material.color.r,shapes[c].material.color.g,shapes[c].material.color.b],[0,1,2],b,a,"shape color",c)),borders[c].material.color.fromArray(updateElement([borders[c].material.color.r,borders[c].material.color.g,borders[c].material.color.b],[0,1,2],b,a,"border color",c));for(c=0;c<lights.length;c++)null!=keyFrames[b].lights[c]&&null!=keyFrames[b+1].lights[c]&&(lights[c].visible=keyFrames[b].lights.visible,
lights[c].position.fromArray(updateElement([lights[c].position.x,lights[c].position.y,lights[c].position.z],[1,2,3],b,a,"lights",c)),lights[c].rotation.fromArray(updateElement([lights[c].rotation.x,lights[c].rotation.y,lights[c].rotation.z],[7,8,9],b,a,"lights",c)),lights[c].color.fromArray(updateElement([lights[c].color.r,lights[c].color.g,lights[c].color.b],[4,5,6],b,a,"lights",c)),"HemisphereLight"===lights[c].type&&lights[c].groundColor.fromArray(updateElement([lights[c].groundColor.r,lights[c].groundColor.g,
lights[c].groundColor.b],[10,11,12],b,a,"lights",c)),lights[c].intensity=updateElement([lights[c].intensity],[0],b,a,"lights",c)[0]);for(c=lastTickAnimated=0;c<b;c++)lastTickAnimated+=keyFrames[c].duration;lastTickAnimated+=a}
function updateElement(a,b,c,g,f,h){switch(f){case "shapes":for(f=0;f<a.length;f++)a[f]=keyFrames[c].shapes[h][b[f]]+(keyFrames[c+1].shapes[h][b[f]]-keyFrames[c].shapes[h][b[f]])/keyFrames[c].duration*g;break;case "shape color":for(f=0;f<a.length;f++)a[f]=keyFrames[c].color[h][b[f]]+(keyFrames[c+1].color[h][b[f]]-keyFrames[c].color[h][b[f]])/keyFrames[c].duration*g;break;case "border color":for(f=0;f<a.length;f++)a[f]=keyFrames[c].borderColor[h][b[f]]+(keyFrames[c+1].borderColor[h][b[f]]-keyFrames[c].borderColor[h][b[f]])/
keyFrames[c].duration*g;break;case "scales":for(f=0;f<a.length;f++)a[f]=keyFrames[c].scales[h][b[f]]+(keyFrames[c+1].scales[h][b[f]]-keyFrames[c].scales[h][b[f]])/keyFrames[c].duration*g;break;case "lights":for(f=0;f<a.length;f++)a[f]=keyFrames[c].lights[h][b[f]]+(keyFrames[c+1].lights[h][b[f]]-keyFrames[c].lights[h][b[f]])/keyFrames[c].duration*g;break;case "scene":for(h=0;h<a.length;h++)a[h]=keyFrames[c].scene[b[h]]+(keyFrames[c+1].scene[b[h]]-keyFrames[c].scene[b[h]])/keyFrames[c].duration*g}return a}
var recording=!1;function record(){recording=!0;capturer=new CCapture({format:"webm",frameRate:60,name:saveEngine.localFileName});timelineButtonToggle("timeline_record");capturer.start();playAnimation(0)};var timelineScale=0;
function updateTimeline(){timelineScale=getTotalAnimationTime()/(window.innerWidth-50);var a=getId("std_timeline").children.item(1);a.innerHTML='<span id="timeline_playHead" ></span>';getId("timeLine_animationFinish").innerHTML=(getTotalAnimationTime()/1E3).toString()+" s";for(var b=5,c=0;c<keyFrames.length;c++)a.innerHTML+="<div class='timeline_keyframe' style='left: "+b+"px'></div>",a.children[c+1].setAttribute("onclick","showKeyframePopup("+c+'); tutorialMovement(10000,10000,"This is the keyframes menu. You can edit stuff for this keyframe like the duration. Duration is in miliseconds. Click comit changes at the bottom to continue.", 0);'),b+=
keyFrames[c].duration/timelineScale;console.log("Updated Time Line")}function getAnimationTimeUpToIndex(a){for(var b=0,c=0;c<a;c++)b+=parseInt(keyFrames[c].duration);return b}function getTotalAnimationTime(){for(var a=0,b=0;b<keyFrames.length-1;b++)a+=parseInt(keyFrames[b].duration);return a}function loop(){animationRunning?(loopAnimation=!1,timelineButtonToggle("timeline_repeat")):(timelineButtonToggle("timeline_repeat"),loopAnimation=!0,playAnimation(0))}
function keyName(a,b){keyFrames[b].name=a}function removeFrame(a){addfortutorial("remove_frame");animationRunning&&playAnimation(0);keyFrames.splice(a,1);updateTimeline()}function moveUp(a){var b=keyFrames[a];keyFrames.splice(a,1);keyFrames.splice(a-1,0,b);updateTimeline()}function moveDown(a){var b=keyFrames[a];keyFrames.splice(a,1);keyFrames.splice(a+1,0,b);updateTimeline()}function setSpeed(a,b){console.log(b);keyFrames[a].duration=b}
function timelineScrub(a){timelinePosition=a=(a-10)*timelineScale;if(0<=a){for(var b=0,c,g=0;g<keyFrames.length-1;g++)if(a>=b&&a<b+keyFrames[g].duration){c=g;break}else b+=keyFrames[g].duration;null!=c&&(document.getElementById("timeline_playHead").style.left=1+a/timelineScale+"px",updateAnimation(a-b,c),animationRunning&&playAnimation())}}
function changeTimelineDuration(a){for(;a>-keyFrames[keyFrames.length-2].duration;)keyFrames.splice(keyFrames.length-1,1),a+=keyFrames[keyFrames.length-1].duration;keyFrames[keyFrames.length-2]+=a}function moveKeyframeto(a,b){for(var c=0,g=0;g<a;g++)c+=keyFrames[g].duration;console.log("duration to frame: "+c);var f=0;for(g=0;g<keyFrames.length;g++)f+=keyFrames[g];0>b||b>f?console.log("point out of bounds"):moveKeyframe(a,b-c)}
function moveKeyframe(a,b){if(0>a||a>=keyFrames.length)console.log("Frame out of bounds");else if(0===a)keyFrames[a].duration-=b;else if(console.log("moving: "+b),b<-keyFrames[a-1].duration){console.log("shifting down");for(var c=0;b<-keyFrames[a-1+c].duration;)b+=keyFrames[a-1+c].duration,c--;b=-b;console.log(c+" frames");console.log(b+" remainder");changeKeyframePosition(a,a+c);keyFrames[a].duration+=keyFrames[a+c].duration;keyFrames[a+c-1].duration-=b;keyFrames[a+c].duration=b}else if(b>keyFrames[a].duration){console.log("shifting up:");
c=0;for(console.log("keyFrames");b>keyFrames[a+c].duration;)b-=keyFrames[a+c].duration,c++;console.log(c+" frames");console.log(b+" remainder");changeKeyframePosition(a,a+c);keyFrames[a-1].duration+=keyFrames[a+c].duration;keyFrames[a+c-1].duration-=b;keyFrames[a+c].duration=b}else console.log("within bounds"),keyFrames[a-1].duration+=b,keyFrames[a].duration-=b}
function changeKeyframePosition(a,b){console.log("moving "+a+" to "+b);var c=keyFrames[b];keyFrames[b]=keyFrames[a];if(b<a){for(;a>b+1;a--)keyFrames[a]=keyFrames[a-1];keyFrames[b+1]=c}else{for(;a<b-1;a++)keyFrames[a]=keyFrames[a+1];keyFrames[b-1]=c}}var activeKeyframeIndex=0,keyframePopup=document.getElementById("std_timeline_popUp");
function showKeyframePopup(a){keyframePopup||(keyframePopup=document.getElementById("std_timeline_popUp"));activeKeyframeIndex=a;setKeyframePopupData();keyframePopup.style.display="block";keyframePopup.classList.add("timeline_popUp_show")}
function setKeyframePopupData(){keyframePopup.children[0].innerHTML="Editing Keyframe "+(activeKeyframeIndex+1).toString();keyframePopup.children[1].children[0].value=(activeKeyframeIndex+1).toString();keyframePopup.children[2].children[0].value=getAnimationTimeUpToIndex(activeKeyframeIndex).toString();keyframePopup.children[3].children[0].value=keyFrames[activeKeyframeIndex].duration;keyframePopup.children[4].children[0].value=getTotalAnimationTime().toString()}
function applyChanges(){keyFrames[activeKeyframeIndex].duration=parseInt(keyframePopup.children[3].children[0].value);1<=keyFrames.length||(changeKeyframePosition(activeKeyframeIndex,parseInt(keyframePopup.children[1].children[0].value)-1),moveKeyframeto(activeKeyframeIndex,parseInt(keyframePopup.children[2].children[0].value)),changeTimelineDuration(parseInt(keyframePopup.children[4].children[0].value)));updateTimeline()}
function hideKeyframePopup(){keyframePopup.style.display="none";keyframePopup.classList.remove("timeline_popUp_show");keyframePopup.children[0].innerHTML="";keyframePopup.children[1].children[0].value="";keyframePopup.children[2].children[0].value=getAnimationTimeUpToIndex(activeKeyframeIndex).toString();keyframePopup.children[3].children[0].value=keyFrames[activeKeyframeIndex].duration;keyframePopup.children[4].children[0].value=getTotalAnimationTime().toString()};function changeColor(a){showingLight?lights[selectedLight].color.set(a):(shapes[selectedShape].material.color.set(a),shapes[selectedShape].material.needsUpdate=!0)}function rgbToHex(a){a=Number(a).toString(16);2>a.length&&(a="0"+a);return a}
function addShape(){document.getElementById("createTextMenu").style.display="none";var a=document.getElementById("shapeSelector").value;saveEngine.save(!0,!1);switch(a){case "cube":newCube(0,0,0,0,0,0,"#ff0000","#000000");break;case "cylinder":newCylinder(0,0,0,0,0,0,"#ff0000","#000000");break;case "cone":newCone(0,0,0,0,0,0,"#ff0000","#000000");break;case "custom":hideAll();document.getElementById("createCustomMenu").style.display="inherit";break;case "custom2":hideAll();document.getElementById("FileUpload").style.display=
"inherit";break;case "dodecahedron":newDodecahedron(0,0,0,0,0,0,"#ff0000","#000000");break;case "icosahedron":newIcosahedron(0,0,0,0,0,0,"#ff0000","#000000");break;case "octahedron":newOctahedron(0,0,0,0,0,0,"#ff0000","#000000");break;case "pyramid":newPyramid(0,0,0,0,0,0,"#ff0000","#000000");break;case "ring":newRing(0,0,0,0,0,0,"#ff0000","#000000");break;case "sphere":newSphere(0,0,0,0,0,0,"#ff0000","#000000");break;case "text":hideAll(),document.getElementById("createTextMenu").style.display="inherit"}}
;var UIDiemsions={std_navBar:{defaultPadding:2,defaultUnit:"px",nav_height:0,element_height:0,menuContainer_height:0,button_width:0,status_width:0,nav_width:0,menuContainer_width:0,leftSpacer_width:0,rightSpacer_width:0,button_placement:[],spacer_placement:[],status_placement:0,menuContainer_placement:0},std_body:{window_height:window.innerHeight,window_width:window.innerWidth,body_height:0,body_width:0,renderer_height:0,renderer_width:0,renderer_left:0,renderer_top:0},std_timeline:{timeline_height:150,
timeline_width:0}};var shownPopUp="init";function showPopUp(a,b,c,g){getId("std_popUp").classList.add("popUp_show");getId(a).classList.add("popUp_show");getId(a).children.item(0).textContent=b;getId(a).children.item(1).classList.contains("std_input_text")?getId(a).children.item(1).children.item(3).innerHTML=c:getId(a).children.item(1).innerHTML=c;getId(a).children.item(2).setAttribute("onclick","popUpAction("+g+"); hidePopUp();");shownPopUp=a}
function popUpAction(a){if(0===a)saveEngine.createNewLocalSave(getPopUpInput());else if(1===a)newShape("text",1,1,1,0,0,0,"#FF0000","#000000",getPopUpInput());else if(2===a)saveEngine.createNewLocalSave(getPopUpInput()),launchTutorial();else if(3===a)firebase.auth().createUserWithEmailAndPassword(saveEngine.cloudStorage.userName,Base64.decode(saveEngine.cloudStorage.userUID)).catch(function(a){});else if(4===a)firebase.auth().signOut();else if(100===a)location.reload();else return;3!==a&&4!==a&&100!==
a&&getId(getId(shownPopUp).children.item(1).children.item(0).value="")}function getPopUpInput(){return"init"!==shownPopUp&&shownPopUp.includes("input")?getId(shownPopUp).children.item(1).children.item(0).value:""}function hidePopUp(){getId(shownPopUp).classList.remove("popUp_show");getId("std_popUp").classList.remove("popUp_show")};onkeyup=function(a){};onkeydown=function(a){a=a||event;var b=[];b[a.keyCode]="keydown"==a.type;b[32]&&(mouseOnTimeline=!1,playAnimation(timelinePosition))};onchange=function(){saveEngine.save(!0,!1)};var init=!1,saveEngine,mobile,smallScreen,animationRunning=!1,loopAnimation=!1,animationTimer,selectedShape=-1,selectedLight=-1,settingsOpen=!1,prepTutorial=!1,capturer,scene=new THREE.Scene,camera,renderer,shapes=[],lights=[],scales=[],defaultTargets=[],keyFrames=[],borders=[];
window.onload=function(){if(mobile){var a=document.createElement("link");a.setAttribute("rel","stylesheet");a.setAttribute("type","text/css");a.setAttribute("href","style/mobile_Style.css");document.getElementsByTagName("head")[0].removeChild(document.getElementById("defaultStyle"));document.getElementsByTagName("head")[0].appendChild(a);document.getElementById("std_nav_bar").removeChild(document.getElementById("std_statusBox"));document.getElementById("std_nav_bar").removeChild(document.getElementById("nav_spacer_left"));
a=document.createElement("script");a.setAttribute("src","helperScripts/UI_helper_scripts/mobileStyle.js");document.getElementsByTagName("head")[0].removeChild(document.getElementById("newStyleJS"));document.getElementsByTagName("head")[0].appendChild(a);document.getElementById("ws_body").removeChild(document.getElementById("ws_body").children[2]);document.getElementById("ws_loadMenu").style.top="5%";document.getElementById("ws_loadMenu").style.left="calc(50% + 25px)";document.getElementById("std_timeline_popUp").children[5].style.width=
"655px";document.getElementById("std_timeline_popUp").children[5].style.marginLeft="calc(50% - 324.5px)";document.getElementById("std_timeline_popUp").children[5].children[0].style.maxWidth="345px";document.getElementById("std_timeline_popUp").children[5].children[0].style.marginLeft="calc(50% - 172.5px)"}smallScreen&&(document.getElementById("status_ver").style.display="none");saveEngine=new SaveEngine(!0,!0);stylesheetLoader(settings.userInterface.stylesheetPref);saveEngine.setLocalStorageSelectorElement("ws_loadMenu",
"Load Save",!1);saveEngine.setLocalStorageSelectorElement("localStorage_saveSelector","none",!0);saveEngine.setCloudStorageSelectorElement("signedIn_loadSelector","Load Cloud Save",!0);switch(settings.userInterface.stylesheetPref){case "normalMode":getId("settings_styleSheetSelector").selectedIndex=0;break;case "darkMode":getId("settings_styleSheetSelector").selectedIndex=1;break;case "amoledMode":getId("settings_styleSheetSelector").selectedIndex=2;break;case "memeMode":getId("settings_styleSheetSelector").selectedIndex=
3}getId("settings_mouseSensitivity").value=settings.camera.mouseSensitivity;getId("settings_zoomAmount").value=settings.camera.zoomAmount;getId("advCamera_centerX").value=settings.camera.centerPos[0];getId("advCamera_centerY").value=settings.camera.centerPos[1];getId("advCamera_centerZ").value=settings.camera.centerPos[2];getId("advCamera_focusX").value=settings.camera.focusPos[0];getId("advCamera_focusY").value=settings.camera.focusPos[1];getId("advCamera_focusZ").value=settings.camera.focusPos[2]};
var xPosition=10,yPosition=10,zPosition=10,xStart=0,yStart=0,xPosStart=xPosition,yPosStart=yPosition,xCCenter=0,yCCenter=0,zCCenter=0,xCLook=0,yCLook=0,zCLook=0,shapeCenter={x:0,y:0,z:0},shapeCenters=[],mouseDown=!1,inAnimationWindow=0,lockCamera=!0,circleCameraRotation=!1,zoom=5,zoomZ=5,MvX,MvY,Rz1,Ry1,Rz2,Ry2,zoom1,zoom1Z,zoom2,zoom2Z,zoomChange,zoomZChange,MvXv,MvYv,Rz1v,Ry1v,Rz2v,Ry2v,zoom1v,zoom1Zv,zoom2v,zoom2Zv,zoomChangev,zoomZChangev,showingLight,noLook=!1,cameraDebug=!1,tempCircleMoveShapes=
{MvX:0,MvY:0,Rz1:0,Ry1:0,Rz2:0,Ry2:0,zoom1:0,zoom1Z:0,zoom2:0,zoom2Z:0},shapesCmove=[],lastTickAnimated=0;
function start(){camera=new THREE.PerspectiveCamera(75,UIDiemsions.std_body.window_width/UIDiemsions.std_body.window_height,.1,1E3);mobile?(renderer=new THREE.WebGLRenderer({logarithmicDepthBuffer:!0}),renderer.setSize(UIDiemsions.std_body.renderer_width,UIDiemsions.std_body.renderer_height),renderer.shadowMap.enabled=!0):(renderer=new THREE.WebGLRenderer({logarithmicDepthBuffer:!0,antialias:!0}),renderer.setSize(UIDiemsions.std_body.renderer_width,UIDiemsions.std_body.renderer_height),renderer.shadowMap.enabled=
!0,renderer.shadowMapSoft=!0,renderer.shadowMap.type=THREE.PCFSoftShadowMap);document.getElementById("animationEngine_renderArea").appendChild(renderer.domElement);var a=document.getElementById("ws_loadMenu").options[document.getElementById("ws_loadMenu").selectedIndex].value;shapes=[];scales=[];keyFrames=[];borders=[];selectedLight=selectedShape=-1;toggleEditShapeOrLight(!1);saveEngine._localStorageEnable?saveEngine.localNewSave&&!prepTutorial?showPopUp("popUp_input_body","New Save","Enter Save Name",
0):saveEngine.localNewSave&&prepTutorial?(showPopUp("popUp_input_body","New Save","Enter Save Name",2),prepTutorial=!1):saveEngine.localNewSave||(scene=saveEngine.loadLocalSave(a),getId("element_Information").style.display="none",getId("currentEditing_type").style.display="none"):showPopUp("popUp_error_body","Warning","The local save engine has been disabled",-1);getId("localStorage_saveSelector").selectedIndex=saveEngine.localFileIndex;init=!0;saveEngine.forceLoadSelectUpdate();onWindowResize()}
;function showList(){var a=document.getElementById("shapesList_shapes").children[0],b=document.getElementById("shapesList_lights").children[0];a.innerHTML="";b.innerHTML="";if(mobile){for(var c=0;c<shapes.length;c++)a.innerHTML+="<li class='elementList_body' onclick='setSelectedShape("+c+")'>"+shapes[c].geometry.name+"<div style='display: block;margin-left: 5px;width: 50px; float: left;height: 50px;background-color: #"+shapes[c].material.color.getHexString()+";'</li>";for(a=0;a<lights.length;a++)b.innerHTML+=
"<li class='elementList_body' onclick='setSelectedLight("+a+")'>"+lights[a].name+"<div style='display: block;margin-left: 5px;width: 50px; float: left;height: 50px;background-color: #"+lights[a].color.getHexString()+";'</li>"}else{for(c=0;c<shapes.length;c++)a.innerHTML+="<li class='elementList_body' onclick='setSelectedShape("+c+")'>"+shapes[c].geometry.name+"<div style='display: block;margin-left: 5px;width: 20px; float: left;height: 20px;background-color: #"+shapes[c].material.color.getHexString()+
";'</li>";for(a=0;a<lights.length;a++)b.innerHTML+="<li class='elementList_body' onclick='setSelectedLight("+a+")'>"+lights[a].name+"<div style='display: block;margin-left: 5px;width: 20px; float: left;height: 20px;background-color: #"+lights[a].color.getHexString()+";'</li>"}}
function setSelectedShape(a){selectedShape=a;toggleEditShapeOrLight(!1);-1===a?(document.getElementById("element_Information").style.display="none",document.getElementById("currentEditing_type").style.display="none"):(document.getElementById("element_Information").style.display="initial",document.getElementById("currentEditing_type").style.display="initial",console.log(shapes[selectedShape].material.color.getHexString()),document.getElementById("element_color").children[0].value="#"+shapes[selectedShape].material.color.getHexString(),
document.getElementById("element_border_color").children[0].value="#"+borders[selectedShape].material.color.getHexString(),document.getElementById("position_x").value=shapes[selectedShape].position.x,document.getElementById("position_y").value=shapes[selectedShape].position.y,document.getElementById("position_z").value=shapes[selectedShape].position.z,document.getElementById("rotation_x").value=180*shapes[selectedShape].rotation.x/Math.PI,document.getElementById("rotation_y").value=180*shapes[selectedShape].rotation.y/
Math.PI,document.getElementById("rotation_z").value=180*shapes[selectedShape].rotation.z/Math.PI,document.getElementById("diemsions_x").value=scales[selectedShape][0],document.getElementById("diemsions_y").value=scales[selectedShape][1],document.getElementById("diemsions_z").value=scales[selectedShape][2],document.getElementById("borders").checked=borders[selectedShape].visible,document.getElementById("shape_castShadow").checked=shapes[selectedShape].castShadow,document.getElementById("shape_receiveShadow").checked=
shapes[selectedShape].receiveShadow,shapes[selectedShape].visible?getId("element_visibility").children[0].innerHTML="Hide Element":getId("element_visibility").children[0].innerHTML="Show Element",showMenu("menu_newShapes"))}
function setSelectedLight(a){selectedLight=a;-1===a?(document.getElementById("element_Information").style.display="none",document.getElementById("currentEditing_type").style.display="none"):(document.getElementById("element_Information").style.display="initial",document.getElementById("currentEditing_type").style.display="initial","Hemisphere light"===lights[selectedLight].name&&(document.getElementById("element_border_color").children[0].value="#"+lights[selectedLight].groundColor.getHexString()),
toggleEditShapeOrLight(!0),document.getElementById("element_color").children[0].value="#"+lights[selectedLight].color.getHexString(),document.getElementById("position_x").value=lights[selectedLight].position.x,document.getElementById("position_y").value=lights[selectedLight].position.y,document.getElementById("position_z").value=lights[selectedLight].position.z,document.getElementById("intensity_slider").value=100*lights[selectedLight].intensity,document.getElementById("intensity_value").innerHTML=
100*lights[selectedLight].intensity+"",document.getElementById("light_castShadow").checked=lights[selectedLight].castShadow,"Spot Light"===lights[selectedLight].name&&lights[selectedLight].target.isObject3D()&&(document.getElementById("target_x").value=lights[selectedLight].target.position.x,document.getElementById("target_y").value=lights[selectedLight].target.position.y,document.getElementById("target_z").value=lights[selectedLight].target.position.z),lights[selectedLight].visible?getId("element_visibility").children[0].innerHTML=
"Hide Element":getId("element_visibility").children[0].innerHTML="Show Element",showMenu("menu_newShapes"))}function hideAll(){}function shapeMenu(){document.getElementById("shapeMenu").style.display="inherit"}function borderVisibility(){document.getElementById("borders").checked?(borders[selectedShape].visible=!0,document.getElementById("element_border_color").style.display="inherit"):(borders[selectedShape].visible=!1,document.getElementById("element_border_color").style.display="none")}
function toggleEditShapeOrLight(a){(showingLight=a)?(getId("currentEditing_type").innerHTML="Edit Current Light",getId("currentEditing_dimensions").style.display="none",getId("currentEditing_intensity").style.display="inherit",getId("currentEditing_rotation").style.display="none",getId("currentEditing_borders").style.display="none",getId("currentEditing_shape_shadows").style.display="none",getId("default_target_position").style.display="none","Hemisphere light"===lights[selectedLight].name?(getId("element_border_color").style.display=
"inherit",getId("currentEditing_positions").style.display="inherit",getId("currentEditing_spotlight_parameters").style.display="none"):"Ambient light"===lights[selectedLight].name?(getId("currentEditing_positions").style.display="none",getId("element_border_color").style.display="none",getId("currentEditing_spotlight_parameters").style.display="none"):"Spot light"===lights[selectedLight].name?(getId("currentEditing_positions").style.display="inherit",getId("element_border_color").style.display="none",
getId("currentEditing_spotlight_parameters").style.display="inherit",setTargetList()):(getId("currentEditing_positions").style.display="inherit",getId("element_border_color").style.display="none",getId("currentEditing_spotlight_parameters").style.display="none")):(getId("currentEditing_type").innerHTML="Edit Current Shape",getId("currentEditing_dimensions").style.display="inherit",getId("currentEditing_intensity").style.display="none",getId("currentEditing_rotation").style.display="inherit",getId("currentEditing_positions").style.display=
"inherit",getId("currentEditing_borders").style.display="inherit",getId("currentEditing_spotlight_parameters").style.display="none",getId("currentEditing_shape_shadows").style.display="inherit",getId("default_target_position").style.display="none",0<borders.length?!0===document.getElementById("borders").checked?getId("element_border_color").style.display="inherit":getId("element_border_color").style.display="none":getId("element_border_color").style.display="inherit")};var SaveEngine=function(a,b){this._localStorageEnable=a;this._cloudStorageEnable=b;this.localStore=new LocalStore;this.cloudStorage=new CloudStorage;this.legacySupport=this.firstRun=this.localNewSave=!1;this.localFileName="";this.localFileID="init";this.localFileIndex=0;this.localStorageUpdateList=[[],[]];this.cloudStorageUpdateList=[[],[]];this.localSaveIdList=[];this.localSaveFriendlyNamesList=[];this.cloudSaveIdList=[];this.cloudSaveFriendlyNamesList=[];this.stagedLights=[];this.stagedShapes=[];
this.stagedKeyframes=[];this.stagedScales=[];this.stagedBorders=[];this.stagedDefaultTargets=[];this.stagedScene=[];this.stagedSettings=[];this.loadSettings();this.firstRun&&(this._generateSessionId(),this.localStore.saveToStorage(settings.sessionId,this.localSaveIdList),this.localStore.saveToStorage("settings",this.stagedSettings));this.loadSaveList();this._localStorageEnable&&(getId("settings_localStorage").style.display="inherit");this._cloudStorageEnable&&(getId("settings_cloudStorage").style.display=
"inherit")};SaveEngine.prototype._generateFileId=function(){this.localFileID=Base64.encode(this.localFileName+"-"+settings.saveNumber)};SaveEngine.prototype._generateSessionId=function(){settings.sessionId=Base64.encode(navigator.appCodeName+navigator.appName+navigator.platform)};SaveEngine.prototype.loadSettings=function(){this.localStore.exists("settings")?this.stagedSettings=this.localStore.getFromStorage("settings"):(this.firstRun=!0,settings.setToDefault(),this.stagedSettings=settings);settings.updateSettings(this.stagedSettings)};
SaveEngine.prototype.loadSaveList=function(){this.localStore.exists(settings.sessionId)&&(this.localSaveIdList=this.localStore.getFromStorage(settings.sessionId));for(var a=0;a<this.localSaveIdList.length;a++){var b=!1;this.localStore.exists(this.localSaveIdList[a])||(this.localSaveIdList.splice(a,1),a--,b=!0);b||this.legacySupport||this.localSaveFriendlyNamesList.push(this.localStore.getFromStorage(this.localSaveIdList[a]))}this.localStore.saveToStorage(settings.sessionId,this.localSaveIdList)};
SaveEngine.prototype.loadLocalSave=function(a){if(this._localStorageEnable&&this.localStore.exists(a)){this.localFileID=a;this.localFileName=this.localStore.getFromStorage(a);for(a=0;a<this.localSaveIdList.length;a++)this.localSaveIdList[a]===this.localFileID&&(this.localFileIndex=a);this.stagedScene=this.localStore.getFromStorage(this.getKeyName("scene"));this.stagedScene=conversion.convertJSONToScene(this.stagedScene);a=conversion.breakoutScene(this.stagedScene);this.stagedShapes=a[0];this.stagedScales=
a[1];this.stagedBorders=a[2];this.stagedLights=a[3];this.stagedDefaultTargets=a[5];this.stagedScene=a[4];this.stagedScene.background||(this.stagedScene.background=new THREE.Color("#000000"));keyFrames=this.stagedKeyframes=this.localStore.getFromStorage(this.getKeyName("keyframes"));shapes=this.stagedShapes;scales=this.stagedScales;lights=this.stagedLights;borders=this.stagedBorders;defaultTargets=this.stagedDefaultTargets;updateTimeline();return this.stagedScene}};
SaveEngine.prototype.downloadCloudSave=function(a){"default"!==a&&this._cloudStorageEnable&&saveEngine.cloudStorage.userSignedIn&&(this.cloudStorage.downloadSave(a),getId("signedIn_loadSelector").selectedIndex=0)};
SaveEngine.prototype.createNewLocalSave=function(a){if(this._localStorageEnable&&this.localNewSave){this.localFileName=a;this._generateFileId();this.localStore.saveToStorage(this.localFileID,this.localFileName);this.incrementSaveNumber();this.stagedScene=new THREE.Scene;this.stagedScene.background=new THREE.Color("#000000");this.localStore.saveToStorage(this.getKeyName("scene"),this.stagedScene);this.localStore.saveToStorage(this.getKeyName("keyframes"),this.stagedKeyframes);this.addNewSave(this.localFileID);
this.localNewSave=!1;for(a=0;a<this.localStorageUpdateList[0].length;a++)this.setLocalStorageSelectorElement(this.localStorageUpdateList[0][a],this.localStorageUpdateList[1][a],!1);if(saveEngine.cloudStorage.userSignedIn)for(a=0;a<this.cloudStorageUpdateList[0].length;a++)this.setCloudStorageSelectorElement(this.cloudStorageUpdateList[0][a],this.cloudStorageUpdateList[1][a],!1);return this.loadLocalSave(this.localFileID)}};
SaveEngine.prototype.save=function(a,b){this.stagedSettings=settings;this.stagedScene=scene;this.stagedKeyframes=keyFrames;a&&this._localStorageEnable&&(this.localStore.saveToStorage("settings",this.stagedSettings),this.localStore.saveToStorage(this.getKeyName("scene"),this.stagedScene),this.localStore.saveToStorage(this.getKeyName("keyframes"),this.stagedKeyframes));b&&this._cloudStorageEnable&&this.cloudStorage.userSignedIn&&this.cloudStorage.saveToCloud(this.localFileName,this.localFileID,this.stagedKeyframes,
this.stagedScene,this.stagedSettings)};
SaveEngine.prototype.deleteLocalSave=function(a){if(this._localStorageEnable){var b=this.localFileID;this.localFileID=a;var c=this.localSaveIdList.findIndex(function(b){return b===a});this.localSaveIdList.splice(c,1);this.localSaveFriendlyNamesList.splice(c,1);this.localStore.saveToStorage(settings.sessionId,this.localSaveIdList);this.localStore.deleteFromStorage(this.getKeyName(scene));this.localStore.deleteFromStorage(this.getKeyName(keyFrames));if(b===a)location.reload();else{this.localFileID=
b;for(b=0;b<this.localStorageUpdateList[0].length;b++)this.setLocalStorageSelectorElement(this.localStorageUpdateList[0][b],this.localStorageUpdateList[1][b],!1);if(saveEngine.cloudStorage.userSignedIn)for(b=0;b<this.cloudStorageUpdateList[0].length;b++)this.setCloudStorageSelectorElement(this.cloudStorageUpdateList[0][b],this.cloudStorageUpdateList[1][b],!1)}}};SaveEngine.prototype.deleteCloudSave=function(a){this._cloudStorageEnable&&this.cloudStorage.deleteCloudSave(a)};
SaveEngine.prototype.setLocalStorageSelectorElement=function(a,b,c){var g=document.getElementById(a);g.innerHTML="";"none"!==b&&(g.innerHTML+=" <option> "+b+"</option>");for(var f=0;f<this.localSaveIdList.length;f++){var h=this.localSaveIdList[f];var l=this.localSaveFriendlyNamesList[f];g.innerHTML+=" <option value="+h+"> "+l+"</option>"}c&&(this.localStorageUpdateList[0].push(a),this.localStorageUpdateList[1].push(b))};
SaveEngine.prototype.setCloudStorageSelectorElement=function(a,b,c){if(this._cloudStorageEnable){var g=document.getElementById(a);g.innerHTML="";"none"!==b&&(g.innerHTML+=" <option value='default'> "+b+"</option>");if(saveEngine.cloudStorage.userSignedIn)for(var f=0;f<this.cloudSaveIdList.length;f++){var h=this.cloudSaveIdList[f];var l=this.cloudSaveFriendlyNamesList[f];g.innerHTML+=" <option value="+h+"> "+l+"</option>"}c&&(this.cloudStorageUpdateList[0].push(a),this.cloudStorageUpdateList[1].push(b))}};
SaveEngine.prototype.forceLoadSelectUpdate=function(){for(var a=0;a<this.localStorageUpdateList[0].length;a++)this.setLocalStorageSelectorElement(this.localStorageUpdateList[0][a],this.localStorageUpdateList[1][a],!1);if(this.cloudStorage.userSignedIn)for(a=0;a<this.cloudStorageUpdateList[0].length;a++)this.setCloudStorageSelectorElement(this.cloudStorageUpdateList[0][a],this.cloudStorageUpdateList[1][a],!1)};
SaveEngine.prototype.getKeyName=function(a){"init"===this.localFileID&&this._generateFileId();return a+=":"+this.localFileID};SaveEngine.prototype.addNewSave=function(a){this.localSaveIdList.push(a);this.localSaveFriendlyNamesList.push(this.localStore.getFromStorage(a));this.localStore.saveToStorage(settings.sessionId,this.localSaveIdList)};
SaveEngine.prototype.incrementSaveNumber=function(){var a=parseInt(settings.saveNumber);a++;1E3<=a?settings.saveNumber=a.toString():100<=a?settings.saveNumber="0"+a.toString():10<=a?settings.saveNumber="00"+a.toString():1<=a&&(settings.saveNumber="000"+a.toString());this.localStore.saveToStorage("settings",settings)};
$jscomp.global.Object.defineProperties(SaveEngine.prototype,{setLocalStorageEnable:{configurable:!0,enumerable:!0,set:function(a){(this._localStorageEnable=a)?getId("settings_localStorage").style.display="inherit":getId("settings_localStorage").style.display="none"}},setCloudStorageEnable:{configurable:!0,enumerable:!0,set:function(a){(this._cloudStorageEnable=a)?getId("settings_cloudStorage").style.display="inherit":getId("settings_cloudStorage").style.display="none"}}});(function(a,b){"object"===typeof exports&&"undefined"!==typeof module?module.exports=b(a):"function"===typeof define&&define.amd?define(b):b(a)})("undefined"!==typeof self?self:"undefined"!==typeof window?window:"undefined"!==typeof global?global:this,function(a){a=a||{};var b=a.Base64;if("undefined"!==typeof module&&module.exports)try{var c=eval("require('buffer').Buffer")}catch(y){c=void 0}var g=function(a){for(var b={},c=0,d=a.length;c<d;c++)b[a.charAt(c)]=c;return b}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),
f=String.fromCharCode,h=function(a){if(2>a.length){var b=a.charCodeAt(0);return 128>b?a:2048>b?f(192|b>>>6)+f(128|b&63):f(224|b>>>12&15)+f(128|b>>>6&63)+f(128|b&63)}b=65536+1024*(a.charCodeAt(0)-55296)+(a.charCodeAt(1)-56320);return f(240|b>>>18&7)+f(128|b>>>12&63)+f(128|b>>>6&63)+f(128|b&63)},l=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,n=function(a){return a.replace(l,h)},k=function(a){var b=[0,2,1][a.length%3];a=a.charCodeAt(0)<<16|(1<a.length?a.charCodeAt(1):0)<<8|(2<a.length?a.charCodeAt(2):
0);return["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(a>>>18),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(a>>>12&63),2<=b?"=":"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(a>>>6&63),1<=b?"=":"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(a&63)].join("")},e=a.btoa?function(b){return a.btoa(b)}:function(a){return a.replace(/[\s\S]{1,3}/g,k)},q=c?c.from&&Uint8Array&&c.from!==Uint8Array.from?
function(a){return(a.constructor===c.constructor?a:c.from(a)).toString("base64")}:function(a){return(a.constructor===c.constructor?a:new c(a)).toString("base64")}:function(a){return e(n(a))},m=function(a,b){return b?q(String(a)).replace(/[+\/]/g,function(a){return"+"==a?"-":"_"}).replace(/=/g,""):q(String(a))},p=/[\u00c0-\u00df][\u0080-\u00bf]|[\u00e0-\u00ef][\u0080-\u00bf]{2}|[\u00f0-\u00f7][\u0080-\u00bf]{3}/g,d=function(a){switch(a.length){case 4:return a=((7&a.charCodeAt(0))<<18|(63&a.charCodeAt(1))<<
12|(63&a.charCodeAt(2))<<6|63&a.charCodeAt(3))-65536,f((a>>>10)+55296)+f((a&1023)+56320);case 3:return f((15&a.charCodeAt(0))<<12|(63&a.charCodeAt(1))<<6|63&a.charCodeAt(2));default:return f((31&a.charCodeAt(0))<<6|63&a.charCodeAt(1))}},r=function(a){return a.replace(p,d)},w=function(a){var b=a.length,c=b%4;a=(0<b?g[a.charAt(0)]<<18:0)|(1<b?g[a.charAt(1)]<<12:0)|(2<b?g[a.charAt(2)]<<6:0)|(3<b?g[a.charAt(3)]:0);a=[f(a>>>16),f(a>>>8&255),f(a&255)];a.length-=[0,0,2,1][c];return a.join("")},v=a.atob?
function(b){return a.atob(b)}:function(a){return a.replace(/\S{1,4}/g,w)},x=c?c.from&&Uint8Array&&c.from!==Uint8Array.from?function(a){return(a.constructor===c.constructor?a:c.from(a,"base64")).toString()}:function(a){return(a.constructor===c.constructor?a:new c(a,"base64")).toString()}:function(a){return r(v(a))},t=function(a){return x(String(a).replace(/[-_]/g,function(a){return"-"==a?"+":"/"}).replace(/[^A-Za-z0-9\+\/]/g,""))};a.Base64={VERSION:"2.5.1",atob:function(a){return v(String(a).replace(/[^A-Za-z0-9\+\/]/g,
""))},btoa:e,fromBase64:t,toBase64:m,utob:n,encode:m,encodeURI:function(a){return m(a,!0)},btou:r,decode:t,noConflict:function(){var c=a.Base64;a.Base64=b;return c},__buffer__:c};if("function"===typeof Object.defineProperty){var u=function(a){return{value:a,enumerable:!1,writable:!0,configurable:!0}};a.Base64.extendString=function(){Object.defineProperty(String.prototype,"fromBase64",u(function(){return t(this)}));Object.defineProperty(String.prototype,"toBase64",u(function(a){return m(this,a)}));
Object.defineProperty(String.prototype,"toBase64URI",u(function(){return m(this,!0)}))}}a.Meteor&&(Base64=a.Base64);"undefined"!==typeof module&&module.exports?module.exports.Base64=a.Base64:"function"===typeof define&&define.amd&&define([],function(){return a.Base64});return{Base64:a.Base64}});var firebaseConfig={apiKey:"AIzaSyDbwUcLJqhpSwhET7bL54mRUd28FfZ9x_A",authDomain:"monarchanimation-cloudstorage.firebaseapp.com",databaseURL:"https://monarchanimation-cloudstorage.firebaseio.com",projectId:"monarchanimation-cloudstorage",storageBucket:"monarchanimation-cloudstorage.appspot.com",messagingSenderId:"5911128418",appId:"1:5911128418:web:a62eabfd3b182b60"};firebase.initializeApp(firebaseConfig);
firebase.auth().onAuthStateChanged(function(a){try{a?(console.log("Signed In"),saveEngine.cloudStorage.userSignedIn=!0,saveEngine.cloudStorage.userName=a.email,saveEngine.cloudStorage.userUID=a.uid,saveEngine.cloudStorage.generateUserData(),saveEngine.cloudStorage.getUserData(),saveEngine.cloudSaveIdList=this.downloadedFileIDs,document.getElementById("account_sub_signedIn").style.display="inherit",document.getElementById("account_sub_signedOut").style.display="none"):(console.log("Signed Out"),saveEngine.cloudStorage.userSignedIn=
!1,document.getElementById("account_sub_signedOut").style.display="inherit",document.getElementById("account_sub_signedIn").style.display="none")}catch(b){console.log("error")}});var CloudStorage=function(){this.userSignedIn=!1;this.userUID=this.userName="";this.firestore={};this.saveDataRef=this.userDataRef="";this.newUser=!1;this.downloadedFileIDs=[];this.downloadedSettings={};this.firestore=firebase.firestore();this.downloadData={name:"default",keyframes:"default",scene:"default"}};
CloudStorage.prototype.generateUserData=function(){this.constructor.userSignedIn&&this.newUser&&(this.userDataRef=this.firestore.collection("userData").doc(saveEngine.cloudStorage.userUID),this.saveDataRef=this.firestore.collection("saveData").doc("data").collection(saveEngine.cloudStorage.userUID),this.userDataRef.set({fileIDs:JSON.stringify([]),settings:JSON.stringify(saveEngine.stagedSettings)}),this.newUser=!1)};
CloudStorage.prototype.getUserData=function(){this.userDataRef=this.firestore.collection("userData").doc(saveEngine.cloudStorage.userUID);this.saveDataRef=this.firestore.collection("saveData").doc("data").collection(saveEngine.cloudStorage.userUID);this.userDataRef.get().then(function(a){if(a.exists){saveEngine.cloudStorage.downloadedFileIDs=JSON.parse(a.data().fileIDs);saveEngine.cloudStorage.downloadedSettings=JSON.parse(a.data().settings);console.log(JSON.parse(a.data().fileIDs));for(a={$jscomp$loop$prop$i$22:0};a.$jscomp$loop$prop$i$22<
saveEngine.cloudStorage.downloadedFileIDs.length;a={$jscomp$loop$prop$i$22:a.$jscomp$loop$prop$i$22},a.$jscomp$loop$prop$i$22++)saveEngine.cloudStorage.saveDataRef.doc(saveEngine.cloudStorage.downloadedFileIDs[a.$jscomp$loop$prop$i$22]).get().then(function(a){return function(b){b.exists?saveEngine.cloudSaveFriendlyNamesList.push(b.data().name):(saveEngine.cloudStorage.downloadedFileIDs.splice(a.$jscomp$loop$prop$i$22,1),a.$jscomp$loop$prop$i$22--)}}(a));saveEngine.cloudSaveIdList=saveEngine.cloudStorage.downloadedFileIDs}})};
CloudStorage.prototype.createNewUser=function(a,b){showPopUp("popUp_confirm_body","Confirm Account Creation","Email: "+a,3);saveEngine.cloudStorage.userName=a;saveEngine.cloudStorage.userUID=Base64.encode(b);this.newUser=!0};CloudStorage.prototype.signIn=function(a,b){firebase.auth().signInWithEmailAndPassword(a,b).catch(function(a){console.log(a)})};CloudStorage.prototype.signOut=function(){showPopUp("popUp_confirm_body","Confirm","Do you want to sign out?",4)};
CloudStorage.prototype.saveToCloud=function(a,b,c,g,f){if(saveEngine.cloudStorage.userSignedIn){a={name:a,keyframes:JSON.stringify(c),scene:JSON.stringify(g)};c=!0;for(g=0;g<this.downloadedFileIDs.length;g++)this.downloadedFileIDs[g]===b&&(c=!1);c&&this.downloadedFileIDs.push(b);this.userDataRef.set({fileIDs:JSON.stringify(this.downloadedFileIDs),settings:JSON.stringify(f)},{merge:!0});this.saveDataRef.doc(b).set(a,{merge:!0})}else return-5};
CloudStorage.prototype.downloadSave=function(a){this.saveDataRef.doc(a).get().then(function(b){if(b.exists){saveEngine.cloudStorage.downloadData=b.data();saveEngine.stagedScene=conversion.convertJSONToScene(JSON.parse(b.data().scene));saveEngine.stagedKeyframes=JSON.parse(b.data().keyframes);saveEngine.localFileName=b.data().name;saveEngine.localFileID=a;saveEngine.localStore.saveToStorage(saveEngine.localFileID,saveEngine.localFileName);saveEngine.localStore.saveToStorage(saveEngine.getKeyName("scene"),
saveEngine.stagedScene);saveEngine.localStore.saveToStorage(saveEngine.getKeyName("keyframes"),saveEngine.stagedKeyframes);b=!1;for(var c=0;c<saveEngine.localSaveIdList.length;c++)saveEngine.localSaveIdList[c]===a&&(b=!0);b||saveEngine.addNewSave(saveEngine.localFileID);scene=saveEngine.loadLocalSave(a)}else console.log("save not found")})};
CloudStorage.prototype.deleteCloudSave=function(a){for(var b=0;b<this.downloadedFileIDs.length;b++)this.downloadedFileIDs[b]===a&&this.downloadedFileIDs.splice(b,1);this.saveDataRef.doc(a).delete();this.userDataRef.set({fileIDs:JSON.stringify(this.downloadedFileIDs)},{merge:!0});saveEngine.cloudSaveIdList=this.downloadedFileIDs};var lastLoadedShape,conversion=function(){};
conversion.isShape=function(a){try{return"BoxGeometry"===a.geometry.type||"ConeGeometry"===a.geometry.type||"CylinderGeometry"===a.geometry.type||"Geometry"===a.geometry.type||"DodecahedronGeometry"===a.geometry.type||"IcosahedronGeometry"===a.geometry.type||"OctahedronGeometry"===a.geometry.type||"TetrahedronGeometry"===a.geometry.type||"SphereGeometry"===a.geometry.type||"TorusGeometry"===a.geometry.type||"TextGeometry"===a.geometry.type?(lastLoadedShape=a,!0):!1}catch(b){return!1}};
conversion.isLight=function(a){try{return"PointLight"===a.type||"AmbientLight"===a.type||"DirectionalLight"===a.type||"SpotLight"===a.type||"HemisphereLight"===a.type?!0:!1}catch(b){return!1}};
conversion.addBorder=function(a){var b=new THREE.EdgesGeometry(lastLoadedShape.geometry);b=new THREE.LineSegments(b,new THREE.LineBasicMaterial({color:a.material.color}));b.visible=a.visible;b.position.x=lastLoadedShape.position.x;b.position.y=lastLoadedShape.position.y;b.position.z=lastLoadedShape.position.z;b.scale.x=lastLoadedShape.scale.x;b.scale.y=lastLoadedShape.scale.y;b.scale.z=lastLoadedShape.scale.z;b.rotation.x=lastLoadedShape.rotation.x;b.rotation.y=lastLoadedShape.rotation.y;b.rotation.z=
lastLoadedShape.rotation.z;lastLoadedShape=null;return b};conversion.isBoarder=function(a){try{return"LineSegments"===a.type}catch(b){return!1}};conversion.convertJSONToScene=function(a){if("Scene"===a.object.type)return(new THREE.ObjectLoader).parse(a)};conversion.toRenderableArr=function(a,b,c){};
conversion.breakoutScene=function(a){var b=[[],[],[],[],Object,[]];if(void 0!==a.children)for(var c=0;c<a.children.length;c++)if(this.isShape(a.children[c])){if(isNaN(a.children[c].rotation._x)||isNaN(a.children[c].rotation._y)||isNaN(a.children[c].rotation._z))a.children[c].rotation.x=0,a.children[c].rotation.y=0,a.children[c].rotation.z=0;b[0].push(a.children[c]);b[1].push([a.children[c].scale.x,a.children[c].scale.y,a.children[c].scale.z])}else this.isBoarder(a.children[c])?(a.children[c]=this.addBorder(a.children[c]),
b[2].push(a.children[c])):this.isLight(a.children[c])?b[3].push(a.children[c]):a.children[c].isObject3D&&b[5].push(a.children[c]);b[4]=a;console.log(b);return b};
conversion.toSavableArr=function(a,b){var c=[];if("lights"===b)for(b=0;b<a.length;b++)c.push({type:a[b].type,positionX:a[b].position.x,positionY:a[b].position.y,positionZ:a[b].position.z,r:a[b].color.r,g:a[b].color.g,b:a[b].color.b,intensity:a[b].intensity}),"Hemisphere light"===a[b].name&&(c[b]+={r2:a[b].groundColor.r,g2:a[b].groundColor.g,b2:a[b].groundColor.b});else if("shapes"===b)for(b=0;b<a[0].length;b++)c.push({type:a[0][b].geometry.type,positionX:a[0][b].position.x,positionY:a[0][b].position.y,
positionZ:a[0][b].position.z,r:a[0][b].material.color.r,g:a[0][b].material.color.g,b:a[0][b].material.color.b,borders:a[1][b].visible,borderR:a[1][b].material.color.r,borderG:a[1][b].material.color.g,borderB:a[1][b].material.color.b});else c=a;console.log(c);return c};var LocalStore=function(){};LocalStore.prototype.exists=function(a){return null!==localStorage.getItem(a)};LocalStore.prototype.getFromStorage=function(a){return JSON.parse(localStorage.getItem(a))};LocalStore.prototype.loadScene=function(a){var b=new THREE.ObjectLoader;a=this.getFromStorage(a);return a=b.parse(a)};LocalStore.prototype.deleteFromStorage=function(a){localStorage.removeItem(a)};
LocalStore.prototype.saveToStorage=function(a,b){localStorage.setItem(a,JSON.stringify(b));console.log("Saved: "+a)};function scenePosition(a,b){scene.position[a]=Number(b)}function sceneScale(a,b){scene.scale[a]=Number(b)}function sceneBackground(a){scene.background=new THREE.Color(a)}function sceneRotation(a,b){scene.rotation[a]=Number(b)*Math.PI/180}window.addEventListener("resize",onWindowResize,!1);
function onWindowResize(){init&&(renderer.setSize(UIDiemsions.std_body.renderer_width,UIDiemsions.std_body.renderer_height),camera.aspect=UIDiemsions.std_body.renderer_width/UIDiemsions.std_body.renderer_height,camera.updateProjectionMatrix(),updateTimeline())};var settings={version:"1.4.0 rev 0b",saveNumber:"0000",sessionId:"sessionId-"+this.saveNumber,camera:{mouseSensitivity:0,zoomAmount:0,centerPos:[0,0,0],focusPos:[0,0,0]},userInterface:{stylesheetPref:"",usingCustomStyle:!1,customJSPath:"",customCSSPath:""},setToDefault:function(){this.camera.mouseSensitivity=1;this.camera.zoomAmount=1.5;this.camera.centerPos=[0,0,0];this.camera.focusPos=[0,0,0];this.userInterface.stylesheetPref="darkMode";this.saveNumber="0000";this.sessionId="sessionId-"+this.saveNumber},
updateSettings:function(a){if("resetAll"===a)this.setToDefault();else{if(null===a.camera||void 0===a.camera)a.camera={mouseSensitivity:a.mouseSensitivity,zoomAmount:a.zoomAmount,centerPos:[0,0,0],focusPos:[0,0,0]};null==a.userInterface&&(a.userInterface={stylesheetPref:"darkMode",usingCustomStyle:!1,customJSPath:"",customCSSPath:""});null==(a.saveNumber||a.sessionId)&&(a.saveNumber="0000",a.sessionId="sessionId-"+a.saveNumber);this.camera=a.camera;this.saveNumber=a.saveNumber;this.sessionId=a.sessionId;
this.userInterface.stylesheetPref=a.userInterface.stylesheetPref;a.userInterface.usingCustomStyle&&(this.userInterface.customJSPath=a.userInterface.customJSPath,this.userInterface.customCSSPath=a.userInterface.customCSSPath,console.log("ERROR: Custom style failed to load. Defaulting to dark mode."),this.userInterface.stylesheetPref="darkMode")}}};var usingTutorial=!1,tutorialPopUp=document.getElementById("std_tutorial_popUp");function launchTutorial(){tutorialPopUp||(tutorialPopUp=document.getElementById("std_tutorial_popUp"));usingTutorial=!0;addfortutorial("start")}function moveArrow(a,b){document.getElementById("tutorial_arrow").style.left=a.toString()+"px";document.getElementById("tutorial_arrow").style.top=b.toString()+"px"}var tutorialnum=0;
function addfortutorial(a){tutorialnum++;switch(tutorialnum){case 1:"start"==a&&tutorialMovement(120,-100,"The assets menu gives you access to all of the elements like lighing and shapes click this button to access it.",0);break;case 2:"animation_element_menu"==a?tutorialMovement(200,30,"To create a shape, click Create Shape",0):tutorialnum--;break;case 3:"new_shape"==a?tutorialMovement(150,410,"Now click on the shape you want. Once you create it, scroll down to the Diementions options and change the x dimention",
0):tutorialnum--;break;case 4:"dimenX"==a?tutorialMovement(200,220,"Now press TAB and change the next value",0):tutorialnum--;break;case 5:"dimenY"==a?tutorialMovement(200,220,"Now create a light so that you can see the shape. Scroll all the way up in the menu and follow the arrow.",0):tutorialnum--;break;case 6:"light_menu"==a?tutorialMovement(50,-100,"This is the light editor. You can change the intensity and position of most lights. Some lights have specific settings. There is also a shapes editor. To get there, click on the assets list button.",
0):tutorialnum--;break;case 7:"shape_list"==a?tutorialMovement(270,10,"Here you can find a list of all assets in the scene, click on the shape to edit it.",0):tutorialnum--;break;case 8:"shape_menu"==a?tutorialMovement(120,430,"Now you can make an animation. To do so, add a keyframe by clicking on the keyframe button.",!1):tutorialnum--;break;case 9:"add_frame"==a?tutorialMovement(120,window.innerHeight-125,"Now change the X DIMENTION of the shape",0):tutorialnum--;break;case 10:"dimenX"==a?tutorialMovement(120,
430,"Now add Another Keyframe",0):tutorialnum--;break;case 11:"add_frame"==a?tutorialMovement(300,window.innerHeight-245,"Now you have an animation set up. Press the play button to play the animation",0):tutorialnum--;break;case 12:"play"==a?tutorialMovement(370,window.innerHeight-245,"You can also pause an animation by pressing the play button again. You can also loop the animation. Click the button to the right of the play button to loop the animation to do so.",0):tutorialnum--;break;case 13:"loop"==
a?tutorialMovement(190,window.innerHeight-245,"Now if you want to delete a keyframe, you can do so. Click Continue and follow the arrow to delete the last keyframe",0):tutorialnum--;break;case 14:"remove_frame"==a&&tutorialMovement(120,window.innerHeight-245,"You can also hide the shape. Go back to the shapes options menu at the left, scroll all the way down, and click on HIDE ELEMENT",0);break;case 15:"hide_shape"==a&&tutorialMovement(1180,-100,"You are now done with the tutorial. To view our advanced features, go to settings.",
0);break;case 16:"setting_menu"==a?tutorialMovement(1180,-100,"Here you will find advanced and saving options. A thorough list and explanation of all buttons can be seen at the bottom.",0):tutorialnum--}}
function tutorialMovement(a,b,c,g){usingTutorial&&(document.getElementById("tutorial_arrow").style.display="block",g?tutorialPopUp.children[2].children[0].setAttribute("onclick","exitTutorial();"):tutorialPopUp.children[2].children[0].setAttribute("onclick","hideTutorialPopup();"),moveArrow(a,b),showTutorialPopup(c))}
function showTutorialPopup(a){usingTutorial&&(tutorialPopUp||(tutorialPopUp=document.getElementById("std_tutorial_popUp")),tutorialPopUp.children[1].innerHTML=a,tutorialPopUp.style.display="block",tutorialPopUp.classList.add("tutorial_popUp_show"))}function exitTutorial(){usingTutorial=!1;moveArrow(0,0);document.getElementById("tutorial_arrow").style.display="none";hideTutorialPopup()}
function hideTutorialPopup(){tutorialPopUp||(tutorialPopUp=document.getElementById("std_tutorial_popUp"));tutorialPopUp.style.display="none";tutorialPopUp.classList.remove("tutorial_popUp_show");tutorialPopUp.children[2].children[0].setAttribute("onclick","")};
